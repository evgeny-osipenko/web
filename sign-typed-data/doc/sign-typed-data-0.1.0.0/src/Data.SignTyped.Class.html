<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# OPTIONS_GHC -Wno-redundant-constraints -Wno-identities #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.SignTyped.Class</span><span>
</span><span id="line-5"></span><span>    </span><span class="annot"><span class="hs-comment">{-* High-level entrypoints -}</span></span><span>
</span><span id="line-6"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#hashSignable"><span class="hs-identifier">hashSignable</span></a></span><span>
</span><span id="line-7"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#hashSignableWith"><span class="hs-identifier">hashSignableWith</span></a></span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span>    </span><span class="annot"><span class="hs-comment">{-* Typeclasses -}</span></span><span>
</span><span id="line-10"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValue"><span class="hs-identifier">SignableValue</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueDefault"><span class="hs-identifier">SignableValueDefault</span></a></span><span>
</span><span id="line-12"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#signableValueDefaultHandle"><span class="hs-identifier">signableValueDefaultHandle</span></a></span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><span class="hs-comment">{-* Generic implementation -}</span></span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#GenericSignable"><span class="hs-identifier">GenericSignable</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SigningModifier"><span class="hs-identifier">SigningModifier</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#genericSignableValueHandle"><span class="hs-identifier">genericSignableValueHandle</span></a></span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><span class="hs-comment">{-* Modifier wrappers -}</span></span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#AsBaseType"><span class="hs-identifier">AsBaseType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#AsSized"><span class="hs-identifier">AsSized</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><span class="hs-comment">{-* Simple value handles -}</span></span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#boolValueHandle"><span class="hs-identifier">boolValueHandle</span></a></span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#numberValueHandle"><span class="hs-identifier">numberValueHandle</span></a></span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#bytesValueHandle"><span class="hs-identifier">bytesValueHandle</span></a></span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#stringValueHandle"><span class="hs-identifier">stringValueHandle</span></a></span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#arrayValueHandle"><span class="hs-identifier">arrayValueHandle</span></a></span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><span class="hs-comment">{-* Struct handle -}</span></span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#structValueHandle"><span class="hs-identifier">structValueHandle</span></a></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableStructMemberHandle"><span class="hs-identifier">SignableStructMemberHandle</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><span class="hs-comment">{-* SignableValueHandle internals -}</span></span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueHandle"><span class="hs-identifier">SignableValueHandle</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">contramap</span></span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#contramapSignableEither"><span class="hs-identifier">contramapSignableEither</span></a></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#TypeContextBuilder"><span class="hs-identifier">TypeContextBuilder</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#executeTypeContextBuilder"><span class="hs-identifier">executeTypeContextBuilder</span></a></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><span class="hs-comment">{-* Value embedding monad -}</span></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#Embed"><span class="hs-identifier">Embed</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#runEmbed"><span class="hs-identifier">runEmbed</span></a></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#withEmbedLocation"><span class="hs-identifier">withEmbedLocation</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#withEmbedLocationArrayElement"><span class="hs-identifier">withEmbedLocationArrayElement</span></a></span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#withEmbedLocationStructMember"><span class="hs-identifier">withEmbedLocationStructMember</span></a></span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#askTypeContext"><span class="hs-identifier">askTypeContext</span></a></span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#getStructDef"><span class="hs-identifier">getStructDef</span></a></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><span class="hs-comment">{-* Generic implementation internals -}</span></span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#GSignableRep"><span class="hs-identifier">GSignableRep</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#ModifiedFieldName"><span class="hs-identifier">ModifiedFieldName</span></a></span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#ModifiedFieldType"><span class="hs-identifier">ModifiedFieldType</span></a></span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#ValidateModifiers"><span class="hs-identifier">ValidateModifiers</span></a></span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#AssertValidation"><span class="hs-identifier">AssertValidation</span></a></span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">where</span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Coerce</span></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor.Contravariant</span></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Int</span></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.SignTyped.Hashing.html"><span class="hs-identifier">Data.SignTyped.Hashing</span></a></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.SignTyped.Structure.html"><span class="hs-identifier">Data.SignTyped.Structure</span></a></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.SignTyped.Type.HList.html"><span class="hs-identifier">Data.SignTyped.Type.HList</span></a></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.SignTyped.Type.HMap.html"><span class="hs-identifier">Data.SignTyped.Type.HMap</span></a></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.SignTyped.Type.SName.html"><span class="hs-identifier">Data.SignTyped.Type.SName</span></a></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.SignTyped.Type.Some.html"><span class="hs-identifier">Data.SignTyped.Type.Some</span></a></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.SignTyped.Util.html"><span class="hs-identifier">Data.SignTyped.Util</span></a></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Type.Bool</span></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Type.Equality</span></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Word</span></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.TypeLits</span></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Text</span></span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Encoding</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Text.Encoding</span></span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TH</span></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="annot"><span class="hs-comment">{-| Perform EIP-712 @encodeData@ on the given value with its type's default handle. -}</span></span><span>
</span><span id="line-88"></span><span class="annot"><a href="Data.SignTyped.Class.html#hashSignable"><span class="hs-identifier hs-type">hashSignable</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679218187"><span class="annot"><a href="#local-6989586621679218187"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679218186"><span class="annot"><a href="#local-6989586621679218186"><span class="hs-identifier hs-type">baseType</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueDefault"><span class="hs-identifier hs-type">SignableValueDefault</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218186"><span class="hs-identifier hs-type">baseType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218187"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-91"></span><span>    </span><span class="annot"><a href="#local-6989586621679218187"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-92"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span>
</span><span id="line-93"></span><span id="hashSignable"><span class="annot"><span class="annottext">hashSignable :: forall a (baseType :: Symbol).
SignableValueDefault baseType a =&gt;
a -&gt; Either String ByteString
</span><a href="Data.SignTyped.Class.html#hashSignable"><span class="hs-identifier hs-var hs-var">hashSignable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-94"></span><span>    </span><span class="annot"><span class="annottext">SignableValueHandle a -&gt; a -&gt; Either String ByteString
forall a. SignableValueHandle a -&gt; a -&gt; Either String ByteString
</span><a href="Data.SignTyped.Class.html#hashSignableWith"><span class="hs-identifier hs-var">hashSignableWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (baseType :: Symbol) a.
SignableValue baseType a =&gt;
SignableValueHandle a
</span><a href="Data.SignTyped.Class.html#signableValueHandle"><span class="hs-identifier hs-var">signableValueHandle</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679218186"><span class="hs-identifier hs-type">baseType</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679218187"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="annot"><span class="hs-comment">{-| Perform EIP-712 @encodeData@ on the given value using the given handle. -}</span></span><span>
</span><span id="line-97"></span><span class="annot"><a href="Data.SignTyped.Class.html#hashSignableWith"><span class="hs-identifier hs-type">hashSignableWith</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679218196"><span class="annot"><a href="#local-6989586621679218196"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-99"></span><span>    </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueHandle"><span class="hs-identifier hs-type">SignableValueHandle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218196"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-100"></span><span>    </span><span class="annot"><a href="#local-6989586621679218196"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-101"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span>
</span><span id="line-102"></span><span id="hashSignableWith"><span class="annot"><span class="annottext">hashSignableWith :: forall a. SignableValueHandle a -&gt; a -&gt; Either String ByteString
</span><a href="Data.SignTyped.Class.html#hashSignableWith"><span class="hs-identifier hs-var hs-var">hashSignableWith</span></a></span></span><span> </span><span id="local-6989586621679218683"><span class="annot"><span class="annottext">SignableValueHandle a
</span><a href="#local-6989586621679218683"><span class="hs-identifier hs-var">valueHandle</span></a></span></span><span> </span><span id="local-6989586621679218684"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679218684"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-103"></span><span>    </span><span class="annot"><span class="annottext">Some TypeContext
-&gt; (forall {t :: TMap Symbol [EthRepr]}.
    TypeContext t -&gt; Either String ByteString)
-&gt; Either String ByteString
forall {k} (f :: k -&gt; *) r.
Some f -&gt; (forall (t :: k). f t -&gt; r) -&gt; r
</span><a href="Data.SignTyped.Type.Some.html#withSome"><span class="hs-identifier hs-var">withSome</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SignableValueHandle a -&gt; Some TypeContext
forall a. SignableValueHandle a -&gt; Some TypeContext
</span><a href="Data.SignTyped.Class.html#signableValueTypeContext"><span class="hs-identifier hs-var">signableValueTypeContext</span></a></span><span> </span><span class="annot"><span class="annottext">SignableValueHandle a
</span><a href="#local-6989586621679218683"><span class="hs-identifier hs-var">valueHandle</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((forall {t :: TMap Symbol [EthRepr]}.
  TypeContext t -&gt; Either String ByteString)
 -&gt; Either String ByteString)
-&gt; (forall {t :: TMap Symbol [EthRepr]}.
    TypeContext t -&gt; Either String ByteString)
-&gt; Either String ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679218687"><span class="annot"><span class="annottext">TypeContext t
</span><a href="#local-6989586621679218687"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-104"></span><span>    </span><span class="annot"><span class="annottext">Some EthType
-&gt; (forall {t :: EthRepr}. EthType t -&gt; Either String ByteString)
-&gt; Either String ByteString
forall {k} (f :: k -&gt; *) r.
Some f -&gt; (forall (t :: k). f t -&gt; r) -&gt; r
</span><a href="Data.SignTyped.Type.Some.html#withSome"><span class="hs-identifier hs-var">withSome</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SignableValueHandle a -&gt; Some EthType
forall a. SignableValueHandle a -&gt; Some EthType
</span><a href="Data.SignTyped.Class.html#signableValueEthType"><span class="hs-identifier hs-var">signableValueEthType</span></a></span><span> </span><span class="annot"><span class="annottext">SignableValueHandle a
</span><a href="#local-6989586621679218683"><span class="hs-identifier hs-var">valueHandle</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((forall {t :: EthRepr}. EthType t -&gt; Either String ByteString)
 -&gt; Either String ByteString)
-&gt; (forall {t :: EthRepr}. EthType t -&gt; Either String ByteString)
-&gt; Either String ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679218693"><span class="annot"><span class="annottext">EthType t
</span><a href="#local-6989586621679218693"><span class="hs-identifier hs-var">rootEthType</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-105"></span><span>    </span><span class="annot"><span class="annottext">TypeContext t -&gt; Embed t ByteString -&gt; Either String ByteString
forall (ctx :: TMap Symbol [EthRepr]) a.
TypeContext ctx -&gt; Embed ctx a -&gt; Either String a
</span><a href="Data.SignTyped.Class.html#runEmbed"><span class="hs-identifier hs-var">runEmbed</span></a></span><span> </span><span class="annot"><span class="annottext">TypeContext t
</span><a href="#local-6989586621679218687"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">(Embed t ByteString -&gt; Either String ByteString)
-&gt; Embed t ByteString -&gt; Either String ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-106"></span><span>        </span><span id="local-6989586621679218694"><span class="annot"><span class="annottext">EthValue t t
</span><a href="#local-6989586621679218694"><span class="hs-identifier hs-var">rootEthValue</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SignableValueHandle a
-&gt; forall (ctx :: TMap Symbol [EthRepr]) (rep :: EthRepr).
   EthType rep -&gt; a -&gt; Embed ctx (EthValue ctx rep)
forall a.
SignableValueHandle a
-&gt; forall (ctx :: TMap Symbol [EthRepr]) (rep :: EthRepr).
   EthType rep -&gt; a -&gt; Embed ctx (EthValue ctx rep)
</span><a href="Data.SignTyped.Class.html#signableValueEmbed"><span class="hs-identifier hs-var">signableValueEmbed</span></a></span><span> </span><span class="annot"><span class="annottext">SignableValueHandle a
</span><a href="#local-6989586621679218683"><span class="hs-identifier hs-var">valueHandle</span></a></span><span> </span><span class="annot"><span class="annottext">EthType t
</span><a href="#local-6989586621679218693"><span class="hs-identifier hs-var">rootEthType</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679218684"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-107"></span><span>        </span><span class="annot"><span class="annottext">ByteString -&gt; Embed t ByteString
forall a. a -&gt; Embed t a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Embed t ByteString)
-&gt; ByteString -&gt; Embed t ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TypeContext t -&gt; EthType t -&gt; EthValue t t -&gt; ByteString
forall (ctx :: TMap Symbol [EthRepr]) (rep :: EthRepr).
TypeContext ctx -&gt; EthType rep -&gt; EthValue ctx rep -&gt; ByteString
</span><a href="Data.SignTyped.Hashing.html#hashEthValue"><span class="hs-identifier hs-var">hashEthValue</span></a></span><span> </span><span class="annot"><span class="annottext">TypeContext t
</span><a href="#local-6989586621679218687"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">EthType t
</span><a href="#local-6989586621679218693"><span class="hs-identifier hs-var">rootEthType</span></a></span><span> </span><span class="annot"><span class="annottext">EthValue t t
</span><a href="#local-6989586621679218694"><span class="hs-identifier hs-var">rootEthValue</span></a></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="annot"><span class="hs-comment">{-| @SignableValue baseType a@ allows a Haskell value of type @a@ to be represented as a Solidity value
with the typename @baseType@.

    The relation between Solidity and Haskell types is many-to-many. For example, Solidity's @uint64@
can be produced from any of `Word`, `Int`, `Data.Natural.Natural` or `Integer`. On the other hand,
Haskell's `Integer` can be mapped to any of Solidity's numeric types.

    The actual implementation is delegated to a `SignableValueHandle` object, which allows us some additional
flexibility:

    * The `SignableValue` itself is treated as a /default/ implementation rather than the /canonical/ one.

    * To define an instance of `SignableValue`, one only needs to perform a single assignment, most often from
a handle-template function, instead of repeating the same parameters across multiple class method definitions. -}</span></span><span>
</span><span id="line-125"></span><span class="hs-keyword">class</span><span> </span><span id="SignableValue"><span class="annot"><a href="Data.SignTyped.Class.html#SignableValue"><span class="hs-identifier hs-var">SignableValue</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679218197"><span class="annot"><a href="#local-6989586621679218197"><span class="hs-identifier hs-type">baseType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679218198"><span class="annot"><a href="#local-6989586621679218198"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-126"></span><span>    </span><span id="signableValueHandle"><span class="annot"><a href="Data.SignTyped.Class.html#signableValueHandle"><span class="hs-identifier hs-type">signableValueHandle</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueHandle"><span class="hs-identifier hs-type">SignableValueHandle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218198"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-127"></span><span>    </span><span id="signableValueListHandle"><span class="annot"><a href="Data.SignTyped.Class.html#signableValueListHandle"><span class="hs-identifier hs-type">signableValueListHandle</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueHandle"><span class="hs-identifier hs-type">SignableValueHandle</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679218198"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-128"></span><span>    </span><span id="local-6989586621679218700"><span class="annot"><a href="Data.SignTyped.Class.html#signableValueListHandle"><span class="hs-identifier hs-var hs-var">signableValueListHandle</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SignableValueHandle a -&gt; Maybe Int -&gt; SignableValueHandle [a]
forall a.
SignableValueHandle a -&gt; Maybe Int -&gt; SignableValueHandle [a]
</span><a href="Data.SignTyped.Class.html#arrayValueHandle"><span class="hs-identifier hs-var">arrayValueHandle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (baseType :: Symbol) a.
SignableValue baseType a =&gt;
SignableValueHandle a
</span><a href="Data.SignTyped.Class.html#signableValueHandle"><span class="hs-identifier hs-var">signableValueHandle</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679218197"><span class="hs-identifier hs-type">baseType</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679218198"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span></span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span class="annot"><span class="hs-comment">{-| This typeclass sets one of the Solidity typenames as the default correspondence for the given Haskell type. -}</span></span><span>
</span><span id="line-133"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValue"><span class="hs-identifier hs-type">SignableValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218193"><span class="hs-identifier hs-type">baseType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218194"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="SignableValueDefault"><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueDefault"><span class="hs-identifier hs-var">SignableValueDefault</span></a></span></span><span> </span><span id="local-6989586621679218193"><span class="annot"><a href="#local-6989586621679218193"><span class="hs-identifier hs-type">baseType</span></a></span></span><span> </span><span id="local-6989586621679218194"><span class="annot"><a href="#local-6989586621679218194"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621679218194"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679218193"><span class="hs-identifier hs-type">baseType</span></a></span><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="annot"><span class="hs-comment">{-| A version of `signableValueHandle` that uses the stronger `SignableValueDefault` constraint. -}</span></span><span>
</span><span id="line-136"></span><span class="annot"><a href="Data.SignTyped.Class.html#signableValueDefaultHandle"><span class="hs-identifier hs-type">signableValueDefaultHandle</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679218228"><span class="annot"><a href="#local-6989586621679218228"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679218227"><span class="annot"><a href="#local-6989586621679218227"><span class="hs-identifier hs-type">baseType</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-138"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueDefault"><span class="hs-identifier hs-type">SignableValueDefault</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218227"><span class="hs-identifier hs-type">baseType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218228"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-139"></span><span>    </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueHandle"><span class="hs-identifier hs-type">SignableValueHandle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218228"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-140"></span><span id="signableValueDefaultHandle"><span class="annot"><span class="annottext">signableValueDefaultHandle :: forall a (baseType :: Symbol).
SignableValueDefault baseType a =&gt;
SignableValueHandle a
</span><a href="Data.SignTyped.Class.html#signableValueDefaultHandle"><span class="hs-identifier hs-var hs-var">signableValueDefaultHandle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (baseType :: Symbol) a.
SignableValue baseType a =&gt;
SignableValueHandle a
</span><a href="Data.SignTyped.Class.html#signableValueHandle"><span class="hs-identifier hs-var">signableValueHandle</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679218227"><span class="hs-identifier hs-type">baseType</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679218228"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="annot"><span class="hs-comment">{-| This newtype is intended to be used as a wrapper for DerivingVia to derive `SignableValue`,
for example:

    @
        data MyPerson = MyPerson
            { pname :: String
            , pwallet :: BS.ByteString
            }
            deriving (Show, Eq, Generic)
            deriving (SignableValue \&quot;Person\&quot;) via (
                GenericSignable
                    '[  'SigningFieldModifier &quot;pname&quot;
                            ('Just &quot;name&quot;)
                            ('Just (AsBaseType &quot;string&quot; String))
                    ,   'SigningFieldModifier &quot;pwallet&quot;
                            ('Just &quot;wallet&quot;)
                            ('Just (AsBaseType &quot;address&quot; BS.ByteString))
                    ]
                    MyPerson
            )
            deriving anytype (SignableValueDefault \&quot;Person\&quot;)
    @

    @mods@ is a @DataKinds@ parameter that is used to fine-tune the generated instance, similar to aeson's
`Data.Aeson.Options`, but on a type level instead of the value level. -}</span></span><span>
</span><span id="line-169"></span><span class="hs-keyword">newtype</span><span> </span><span id="GenericSignable"><span class="annot"><a href="Data.SignTyped.Class.html#GenericSignable"><span class="hs-identifier hs-var">GenericSignable</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679218232"><span class="annot"><a href="#local-6989586621679218232"><span class="hs-identifier hs-type">mods</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.SignTyped.Class.html#SigningModifier"><span class="hs-identifier hs-type">SigningModifier</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679218233"><span class="annot"><a href="#local-6989586621679218233"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="GenericSignable"><span class="annot"><a href="Data.SignTyped.Class.html#GenericSignable"><span class="hs-identifier hs-var">GenericSignable</span></a></span></span><span>
</span><span id="line-171"></span><span>        </span><span class="hs-special">{</span><span> </span><span id="unwrapGenericSignable"><span class="annot"><span class="annottext">forall (mods :: [SigningModifier]) a.
GenericSignable mods a
-&gt; AssertValidation (ValidateModifiers mods (Rep a)) a
</span><a href="Data.SignTyped.Class.html#unwrapGenericSignable"><span class="hs-identifier hs-var hs-var">unwrapGenericSignable</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#AssertValidation"><span class="hs-identifier hs-type">AssertValidation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Class.html#ValidateModifiers"><span class="hs-identifier hs-type">ValidateModifiers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218232"><span class="hs-identifier hs-type">mods</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Rep</span></span><span> </span><span class="annot"><a href="#local-6989586621679218233"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679218233"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-172"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-175"></span><span>    </span><span id="local-6989586621679218244"><span id="local-6989586621679218245"><span id="local-6989586621679218246"><span id="local-6989586621679218713"><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Generic</span></span><span> </span><span class="annot"><a href="#local-6989586621679218244"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-176"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#ValidateModifiers"><span class="hs-identifier hs-type">ValidateModifiers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218245"><span class="hs-identifier hs-type">mods</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Rep</span></span><span> </span><span class="annot"><a href="#local-6989586621679218244"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#GSignableRep"><span class="hs-identifier hs-type">GSignableRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218245"><span class="hs-identifier hs-type">mods</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218244"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Rep</span></span><span> </span><span class="annot"><a href="#local-6989586621679218244"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownSymbol</span></span><span> </span><span class="annot"><a href="#local-6989586621679218246"><span class="hs-identifier hs-type">baseType</span></a></span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-180"></span><span>    </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValue"><span class="hs-identifier hs-type">SignableValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218246"><span class="hs-identifier hs-type">baseType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Class.html#GenericSignable"><span class="hs-identifier hs-type">GenericSignable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218245"><span class="hs-identifier hs-type">mods</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218244"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-182"></span><span>    </span><span id="local-6989586621679218726"><span class="annot"><span class="annottext">signableValueHandle :: SignableValueHandle (GenericSignable mods s)
</span><a href="Data.SignTyped.Class.html#signableValueHandle"><span class="hs-identifier hs-var hs-var hs-var hs-var">signableValueHandle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SignableValueHandle s
-&gt; SignableValueHandle (GenericSignable mods s)
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">(SignableValueHandle s
 -&gt; SignableValueHandle (GenericSignable mods s))
-&gt; SignableValueHandle s
-&gt; SignableValueHandle (GenericSignable mods s)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (baseType :: Symbol) (mods :: [SigningModifier]) s.
(Generic s,
 AssertValidation
   (ValidateModifiers mods (Rep s)) (() :: Constraint),
 GSignableRep mods s (Rep s), KnownSymbol baseType) =&gt;
SignableValueHandle s
</span><a href="Data.SignTyped.Class.html#genericSignableValueHandle"><span class="hs-identifier hs-var">genericSignableValueHandle</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679218246"><span class="hs-identifier hs-type">baseType</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679218245"><span class="hs-identifier hs-type">mods</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679218244"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="annot"><span class="hs-comment">{-| A datatype for `GenericSignable` modifiers. It's intended to be used at type level with DataKinds.

    Each modifier in the list can be thought of as an assignment of the provided value to a configuration parameter.

    @SigningFieldModifier &quot;haskellFieldName&quot; mbEthName mbSignType@ configures the field, which is referred to
in Haskell by the selector @haskellFieldName@. @mbEthName@ and @mbSignType@ are optional new configuration values:
@'Just smth@ sets the configuration to the specified value, while @'Nothing@ leaves it unchanged.

    The second parameter, @mbEthName@, sets the name of the field in Solidity. By default, the Haskell selector's
name is used.

    The third paremeter, @mbSignType@, is a @DerivingVia@-style wrapper that configures a &quot;signing type&quot;. This type
must have a valid `SignableValueDefault` instance, and, obviously, be `Coercible` with the actual field's type. -}</span></span><span>
</span><span id="line-197"></span><span class="hs-keyword">data</span><span> </span><span id="SigningModifier"><span class="annot"><a href="Data.SignTyped.Class.html#SigningModifier"><span class="hs-identifier hs-var">SigningModifier</span></a></span></span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="SigningFieldModifier"><span class="annot"><a href="Data.SignTyped.Class.html#SigningFieldModifier"><span class="hs-identifier hs-var">SigningFieldModifier</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="annot"><span class="hs-comment">{-| A generic implementation of the signable handle. You can use this function instead of `GenericSignable` to
define your own handle or instance, for example:

    @
        data MyPerson = MyPerson
            { pname :: String
            , pwallet :: BS.ByteString
            }
            deriving (Show, Eq, Generic)

        myPersonSignableValueHandle :: SignableValueHandle MyPerson
        myPersonSignableValueHandle =
            genericSignableValueHandle
                \@\&quot;Person\&quot;
                \@'[ 'SigningFieldModifier &quot;pname&quot;
                        ('Just &quot;name&quot;)
                        ('Just (AsBaseType &quot;string&quot; String))
                ,   'SigningFieldModifier &quot;pwallet&quot;
                        ('Just &quot;wallet&quot;)
                        ('Just (AsBaseType &quot;address&quot; BS.ByteString))
                ]

        instance SignableValue \&quot;Person\&quot; MyPerson where
            signableValueHandle = myPersonSignableValueHandle

        instance SignableValueDefault \&quot;Person\&quot; MyPerson where {}
    @ -}</span></span><span>
</span><span id="line-227"></span><span class="annot"><a href="Data.SignTyped.Class.html#genericSignableValueHandle"><span class="hs-identifier hs-type">genericSignableValueHandle</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-228"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679218251"><span class="annot"><a href="#local-6989586621679218251"><span class="hs-identifier hs-type">baseType</span></a></span></span><span> </span><span id="local-6989586621679218250"><span class="annot"><a href="#local-6989586621679218250"><span class="hs-identifier hs-type">mods</span></a></span></span><span> </span><span id="local-6989586621679218249"><span class="annot"><a href="#local-6989586621679218249"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-229"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Generic</span></span><span> </span><span class="annot"><a href="#local-6989586621679218249"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-230"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#AssertValidation"><span class="hs-identifier hs-type">AssertValidation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Class.html#ValidateModifiers"><span class="hs-identifier hs-type">ValidateModifiers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218250"><span class="hs-identifier hs-type">mods</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Rep</span></span><span> </span><span class="annot"><a href="#local-6989586621679218249"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Constraint</span></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#GSignableRep"><span class="hs-identifier hs-type">GSignableRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218250"><span class="hs-identifier hs-type">mods</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218249"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Rep</span></span><span> </span><span class="annot"><a href="#local-6989586621679218249"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownSymbol</span></span><span> </span><span class="annot"><a href="#local-6989586621679218251"><span class="hs-identifier hs-type">baseType</span></a></span><span>
</span><span id="line-233"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-234"></span><span>    </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueHandle"><span class="hs-identifier hs-type">SignableValueHandle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218249"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-235"></span><span id="genericSignableValueHandle"><span class="annot"><span class="annottext">genericSignableValueHandle :: forall (baseType :: Symbol) (mods :: [SigningModifier]) s.
(Generic s,
 AssertValidation
   (ValidateModifiers mods (Rep s)) (() :: Constraint),
 GSignableRep mods s (Rep s), KnownSymbol baseType) =&gt;
SignableValueHandle s
</span><a href="Data.SignTyped.Class.html#genericSignableValueHandle"><span class="hs-identifier hs-var hs-var">genericSignableValueHandle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-236"></span><span>    </span><span class="annot"><span class="annottext">SName baseType
-&gt; [SignableStructMemberHandle s] -&gt; SignableValueHandle s
forall s (structName :: Symbol).
SName structName
-&gt; [SignableStructMemberHandle s] -&gt; SignableValueHandle s
</span><a href="Data.SignTyped.Class.html#structValueHandle"><span class="hs-identifier hs-var">structValueHandle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (sym :: Symbol). KnownName sym =&gt; SName sym
</span><a href="Data.SignTyped.Type.SName.html#SName"><span class="hs-identifier hs-var">SName</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679218251"><span class="hs-identifier hs-type">baseType</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (mods :: [SigningModifier]) s (g :: * -&gt; *).
GSignableRep mods s g =&gt;
(s -&gt; g ()) -&gt; [SignableStructMemberHandle s]
</span><a href="Data.SignTyped.Class.html#gSignableRepMemberHandles"><span class="hs-identifier hs-var">gSignableRepMemberHandles</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679218250"><span class="hs-identifier hs-type">mods</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679218249"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Rep</span></span><span> </span><span class="annot"><a href="#local-6989586621679218249"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">s -&gt; Rep s ()
forall x. s -&gt; Rep s x
forall a x. Generic a =&gt; a -&gt; Rep a x
</span><span class="hs-identifier hs-var">from</span></span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="annot"><span class="hs-comment">{-| This is a newtype wrapper that's indended to be used with `SigningFieldModifier`.

    It sets the Solidity typename to be used for this Haskell type. This allows you to use a `SignableValue`
instance that is different from default, or on types that don't even define a default, such as `Integer` and
`BS.ByteString`. -}</span></span><span>
</span><span id="line-245"></span><span class="hs-keyword">newtype</span><span> </span><span id="AsBaseType"><span class="annot"><a href="Data.SignTyped.Class.html#AsBaseType"><span class="hs-identifier hs-var">AsBaseType</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679218739"><span class="annot"><a href="#local-6989586621679218739"><span class="hs-identifier hs-type">baseType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679218740"><span class="annot"><a href="#local-6989586621679218740"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="AsBaseType"><span class="annot"><a href="Data.SignTyped.Class.html#AsBaseType"><span class="hs-identifier hs-var">AsBaseType</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679218740"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span id="local-6989586621679218744"><span id="local-6989586621679218748"><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679218271"><span id="local-6989586621679218272"><span id="local-6989586621679218273"><span class="annot"><a href="#local-6989586621679218271"><span class="hs-keyword hs-type hs-type hs-type">newtype</span></a></span></span></span></span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValue"><span class="hs-identifier hs-type">SignableValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218271"><span class="hs-identifier hs-type">baseType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218272"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValue"><span class="hs-identifier hs-type">SignableValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218271"><span class="hs-identifier hs-type">baseType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Class.html#AsBaseType"><span class="hs-identifier hs-type">AsBaseType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218273"><span class="hs-identifier hs-type">otherBaseType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218272"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679218276"><span id="local-6989586621679218277"><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValue"><span class="hs-identifier hs-type">SignableValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218276"><span class="hs-identifier hs-type">baseType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218277"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueDefault"><span class="hs-identifier hs-type">SignableValueDefault</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218276"><span class="hs-identifier hs-type">baseType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Class.html#AsBaseType"><span class="hs-identifier hs-type">AsBaseType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218276"><span class="hs-identifier hs-type">baseType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218277"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span class="annot"><span class="hs-comment">{-| This is a newtype wrapper that's indended to be used with `SigningFieldModifier`.

    Being a wrapper for an array, it allows you to set a fixed size to the array, as opposed to having the default
option to map the Haskell list to a variable-length array.

    For example, representing a Solidity structure @Rectangle {int256[2] minpos; int256[2] maxpos}@ could be done
like this:

    @
        data Rectangle = Rectangle
            { minpos :: [Integer]
            , maxpos :: [Integer]
            }
            deriving (Generic)
            deriving (SignableValue \&quot;Rectangle\&quot;) via (
                GenericSignable
                    '[  'SigningFieldModifier &quot;minpos&quot;
                            'Nothing
                            ('Just (AsSized 2 (AsBaseType &quot;int256&quot; Integer)))
                    ,   'SigningFieldModifier &quot;maxpos&quot;
                            'Nothing
                            ('Just (AsSized 2 (AsBaseType &quot;int256&quot; Integer)))
                    ]
                    Rectangle
            )
    @ -}</span></span><span>
</span><span id="line-279"></span><span class="hs-keyword">newtype</span><span> </span><span id="AsSized"><span class="annot"><a href="Data.SignTyped.Class.html#AsSized"><span class="hs-identifier hs-var">AsSized</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679218757"><span class="annot"><a href="#local-6989586621679218757"><span class="hs-identifier hs-type">arrSize</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679218758"><span class="annot"><a href="#local-6989586621679218758"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="AsSized"><span class="annot"><a href="Data.SignTyped.Class.html#AsSized"><span class="hs-identifier hs-var">AsSized</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679218758"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679218283"><span id="local-6989586621679218284"><span id="local-6989586621679218285"><span id="local-6989586621679218764"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679218283"><span class="hs-identifier hs-type">arrSize</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValue"><span class="hs-identifier hs-type">SignableValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218284"><span class="hs-identifier hs-type">baseType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218285"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValue"><span class="hs-identifier hs-type">SignableValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218284"><span class="hs-identifier hs-type">baseType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Class.html#AsSized"><span class="hs-identifier hs-type">AsSized</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218283"><span class="hs-identifier hs-type">arrSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218285"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-282"></span><span>    </span><span id="local-6989586621679218776"><span class="annot"><span class="annottext">signableValueHandle :: SignableValueHandle (AsSized arrSize a)
</span><a href="Data.SignTyped.Class.html#signableValueHandle"><span class="hs-identifier hs-var hs-var hs-var hs-var">signableValueHandle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-283"></span><span>        </span><span class="annot"><span class="annottext">SignableValueHandle [a] -&gt; SignableValueHandle (AsSized arrSize a)
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">(SignableValueHandle [a]
 -&gt; SignableValueHandle (AsSized arrSize a))
-&gt; SignableValueHandle [a]
-&gt; SignableValueHandle (AsSized arrSize a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-284"></span><span>        </span><span class="annot"><span class="annottext">SignableValueHandle a -&gt; Maybe Int -&gt; SignableValueHandle [a]
forall a.
SignableValueHandle a -&gt; Maybe Int -&gt; SignableValueHandle [a]
</span><a href="Data.SignTyped.Class.html#arrayValueHandle"><span class="hs-identifier hs-var">arrayValueHandle</span></a></span><span>
</span><span id="line-285"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (baseType :: Symbol) a.
SignableValue baseType a =&gt;
SignableValueHandle a
</span><a href="Data.SignTyped.Class.html#signableValueHandle"><span class="hs-identifier hs-var">signableValueHandle</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679218284"><span class="hs-identifier hs-type">baseType</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679218285"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Maybe Int
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Maybe Int) -&gt; Int -&gt; Maybe Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Int) -&gt; Integer -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (n :: Nat) (proxy :: Nat -&gt; *).
KnownNat n =&gt;
proxy n -&gt; Integer
</span><span class="hs-identifier hs-var">natVal</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679218283"><span class="hs-identifier hs-type">arrSize</span></a></span><span> </span><span class="annot"><span class="annottext">Any arrSize
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span class="hs-special">)</span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679218296"><span id="local-6989586621679218297"><span id="local-6989586621679218298"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679218296"><span class="hs-identifier hs-type">arrSize</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueDefault"><span class="hs-identifier hs-type">SignableValueDefault</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218297"><span class="hs-identifier hs-type">baseType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218298"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueDefault"><span class="hs-identifier hs-type">SignableValueDefault</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218297"><span class="hs-identifier hs-type">baseType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Class.html#AsSized"><span class="hs-identifier hs-type">AsSized</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218296"><span class="hs-identifier hs-type">arrSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218298"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span class="annot"><span class="hs-comment">{-| This handle encodes Haskell `Bool` into Solidity's @bool@:

        * `False` is encoded as @`BS.replicate` 32 0@.

        * `True` is encoded as @`BS.replicate` 31 0 &lt;&gt; '\x01'@. -}</span></span><span>
</span><span id="line-297"></span><span class="annot"><a href="Data.SignTyped.Class.html#boolValueHandle"><span class="hs-identifier hs-type">boolValueHandle</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-298"></span><span>    </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueHandle"><span class="hs-identifier hs-type">SignableValueHandle</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-299"></span><span id="boolValueHandle"><span class="annot"><span class="annottext">boolValueHandle :: SignableValueHandle Bool
</span><a href="Data.SignTyped.Class.html#boolValueHandle"><span class="hs-identifier hs-var hs-var">boolValueHandle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueHandle"><span class="hs-identifier hs-type">SignableValueHandle</span></a></span><span>
</span><span id="line-300"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">signableValueEthType :: Some EthType
</span><a href="Data.SignTyped.Class.html#signableValueEthType"><span class="hs-identifier hs-var">signableValueEthType</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-301"></span><span>        </span><span class="annot"><span class="annottext">Some EthType
</span><a href="#local-6989586621679218786"><span class="hs-identifier hs-var">ourEthType</span></a></span><span>
</span><span id="line-302"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">signableValueTypeContextBuilder :: Maybe TypeContextBuilder
</span><a href="Data.SignTyped.Class.html#signableValueTypeContextBuilder"><span class="hs-identifier hs-var">signableValueTypeContextBuilder</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-303"></span><span>        </span><span class="annot"><span class="annottext">Maybe TypeContextBuilder
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-304"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">signableValueTypeContext :: Some TypeContext
</span><a href="Data.SignTyped.Class.html#signableValueTypeContext"><span class="hs-identifier hs-var">signableValueTypeContext</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-305"></span><span>        </span><span class="annot"><span class="annottext">Some TypeContext
</span><a href="Data.SignTyped.Structure.html#emptyTypeContext"><span class="hs-identifier hs-var">emptyTypeContext</span></a></span><span>
</span><span id="line-306"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">signableValueEmbed :: forall (ctx :: TMap Symbol [EthRepr]) (rep :: EthRepr).
EthType rep -&gt; Bool -&gt; Embed ctx (EthValue ctx rep)
</span><a href="Data.SignTyped.Class.html#signableValueEmbed"><span class="hs-identifier hs-var">signableValueEmbed</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679218798"><span class="annot"><span class="annottext">EthType rep
</span><a href="#local-6989586621679218798"><span class="hs-identifier hs-var">givenEthType</span></a></span></span><span> </span><span id="local-6989586621679218799"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679218799"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-307"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">EthType rep
</span><a href="#local-6989586621679218798"><span class="hs-identifier hs-var">givenEthType</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-308"></span><span>            </span><span class="annot"><a href="Data.SignTyped.Structure.html#EthTypeAtomic"><span class="hs-identifier hs-type">EthTypeAtomic</span></a></span><span> </span><span class="annot"><span class="annottext">AtomicEthType t
</span><a href="Data.SignTyped.Structure.html#AtomicEthTypeBool"><span class="hs-identifier hs-var">AtomicEthTypeBool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-309"></span><span>                </span><span class="annot"><span class="annottext">EthValue ctx rep -&gt; Embed ctx (EthValue ctx rep)
forall a. a -&gt; Embed ctx a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(EthValue ctx rep -&gt; Embed ctx (EthValue ctx rep))
-&gt; EthValue ctx rep -&gt; Embed ctx (EthValue ctx rep)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; EthValue ctx ('EthReprAtomic Bool)
forall (ctx :: TMap Symbol [EthRepr]) t.
t -&gt; EthValue ctx ('EthReprAtomic t)
</span><a href="Data.SignTyped.Structure.html#EthValueAtomic"><span class="hs-identifier hs-var">EthValueAtomic</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679218799"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-310"></span><span>            </span><span class="annot"><span class="annottext">EthType rep
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-311"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; Embed ctx (EthValue ctx rep)
forall a. String -&gt; Embed ctx a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Embed ctx (EthValue ctx rep))
-&gt; String -&gt; Embed ctx (EthValue ctx rep)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid eth type, expected &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Some EthType -&gt; (forall (t :: EthRepr). EthType t -&gt; Text) -&gt; Text
forall {k} (f :: k -&gt; *) r.
Some f -&gt; (forall (t :: k). f t -&gt; r) -&gt; r
</span><a href="Data.SignTyped.Type.Some.html#withSome"><span class="hs-identifier hs-var">withSome</span></a></span><span> </span><span class="annot"><span class="annottext">Some EthType
</span><a href="#local-6989586621679218786"><span class="hs-identifier hs-var">ourEthType</span></a></span><span> </span><span class="annot"><span class="annottext">EthType t -&gt; Text
forall (t :: EthRepr). EthType t -&gt; Text
</span><a href="Data.SignTyped.Structure.html#ethTypeName"><span class="hs-identifier hs-var">ethTypeName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-313"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-314"></span><span>    </span><span id="local-6989586621679218786"><span class="annot"><span class="annottext">ourEthType :: Some EthType
</span><a href="#local-6989586621679218786"><span class="hs-identifier hs-var hs-var">ourEthType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-315"></span><span>        </span><span class="annot"><span class="annottext">EthType ('EthReprAtomic Bool) -&gt; Some EthType
forall {k} (f :: k -&gt; *) (t :: k). f t -&gt; Some f
</span><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-var">Some</span></a></span><span> </span><span class="annot"><span class="annottext">(EthType ('EthReprAtomic Bool) -&gt; Some EthType)
-&gt; EthType ('EthReprAtomic Bool) -&gt; Some EthType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AtomicEthType Bool -&gt; EthType ('EthReprAtomic Bool)
forall t. AtomicEthType t -&gt; EthType ('EthReprAtomic t)
</span><a href="Data.SignTyped.Structure.html#EthTypeAtomic"><span class="hs-identifier hs-var">EthTypeAtomic</span></a></span><span> </span><span class="annot"><span class="annottext">AtomicEthType Bool
</span><a href="Data.SignTyped.Structure.html#AtomicEthTypeBool"><span class="hs-identifier hs-var">AtomicEthTypeBool</span></a></span><span>
</span><span id="line-316"></span><span>
</span><span id="line-317"></span><span class="annot"><span class="hs-comment">{-| This handle encodes Haskell `Integer` into a Solidity's integer type: sign-extended to 256 bits
(32 bytes) and serialized in the big-endian order.

    The two parameters define signedness and bit size of the integer. -}</span></span><span>
</span><span id="line-321"></span><span class="annot"><a href="Data.SignTyped.Class.html#numberValueHandle"><span class="hs-identifier hs-type">numberValueHandle</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-322"></span><span>    </span><span class="annot"><a href="Data.SignTyped.Structure.html#AtomicIntegerSignedness"><span class="hs-identifier hs-type">AtomicIntegerSignedness</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-323"></span><span>    </span><span class="annot"><a href="Data.SignTyped.Structure.html#AtomicIntegerBitSize"><span class="hs-identifier hs-type">AtomicIntegerBitSize</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-324"></span><span>    </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueHandle"><span class="hs-identifier hs-type">SignableValueHandle</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-325"></span><span id="numberValueHandle"><span class="annot"><span class="annottext">numberValueHandle :: AtomicIntegerSignedness -&gt; Int -&gt; SignableValueHandle Integer
</span><a href="Data.SignTyped.Class.html#numberValueHandle"><span class="hs-identifier hs-var hs-var">numberValueHandle</span></a></span></span><span> </span><span id="local-6989586621679218810"><span class="annot"><span class="annottext">AtomicIntegerSignedness
</span><a href="#local-6989586621679218810"><span class="hs-identifier hs-var">signedness</span></a></span></span><span> </span><span id="local-6989586621679218811"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679218811"><span class="hs-identifier hs-var">bitSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueHandle"><span class="hs-identifier hs-type">SignableValueHandle</span></a></span><span>
</span><span id="line-326"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">signableValueEthType :: Some EthType
</span><a href="Data.SignTyped.Class.html#signableValueEthType"><span class="hs-identifier hs-var">signableValueEthType</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-327"></span><span>        </span><span class="annot"><span class="annottext">Some EthType
</span><a href="#local-6989586621679218812"><span class="hs-identifier hs-var">ourEthType</span></a></span><span>
</span><span id="line-328"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">signableValueTypeContextBuilder :: Maybe TypeContextBuilder
</span><a href="Data.SignTyped.Class.html#signableValueTypeContextBuilder"><span class="hs-identifier hs-var">signableValueTypeContextBuilder</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-329"></span><span>        </span><span class="annot"><span class="annottext">Maybe TypeContextBuilder
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-330"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">signableValueTypeContext :: Some TypeContext
</span><a href="Data.SignTyped.Class.html#signableValueTypeContext"><span class="hs-identifier hs-var">signableValueTypeContext</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-331"></span><span>        </span><span class="annot"><span class="annottext">Some TypeContext
</span><a href="Data.SignTyped.Structure.html#emptyTypeContext"><span class="hs-identifier hs-var">emptyTypeContext</span></a></span><span>
</span><span id="line-332"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">signableValueEmbed :: forall (ctx :: TMap Symbol [EthRepr]) (rep :: EthRepr).
EthType rep -&gt; Integer -&gt; Embed ctx (EthValue ctx rep)
</span><a href="Data.SignTyped.Class.html#signableValueEmbed"><span class="hs-identifier hs-var">signableValueEmbed</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679218818"><span class="annot"><span class="annottext">EthType rep
</span><a href="#local-6989586621679218818"><span class="hs-identifier hs-var">givenEthType</span></a></span></span><span> </span><span id="local-6989586621679218819"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679218819"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-333"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">EthType rep
</span><a href="#local-6989586621679218818"><span class="hs-identifier hs-var">givenEthType</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-334"></span><span>            </span><span class="annot"><a href="Data.SignTyped.Structure.html#EthTypeAtomic"><span class="hs-identifier hs-type">EthTypeAtomic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Structure.html#AtomicEthTypeInteger"><span class="hs-identifier hs-type">AtomicEthTypeInteger</span></a></span><span> </span><span id="local-6989586621679218825"><span class="annot"><span class="annottext">AtomicIntegerSignedness
</span><a href="#local-6989586621679218825"><span class="hs-identifier hs-var">givenSignedness</span></a></span></span><span> </span><span id="local-6989586621679218826"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679218826"><span class="hs-identifier hs-var">givenBitSize</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-335"></span><span>                </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">AtomicIntegerSignedness -&gt; Int -&gt; Integer -&gt; Bool
</span><a href="Data.SignTyped.Structure.html#isValidInteger"><span class="hs-identifier hs-var">isValidInteger</span></a></span><span> </span><span class="annot"><span class="annottext">AtomicIntegerSignedness
</span><a href="#local-6989586621679218825"><span class="hs-identifier hs-var">givenSignedness</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679218826"><span class="hs-identifier hs-var">givenBitSize</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679218819"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-336"></span><span>                    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">EthValue ctx rep -&gt; Embed ctx (EthValue ctx rep)
forall a. a -&gt; Embed ctx a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(EthValue ctx rep -&gt; Embed ctx (EthValue ctx rep))
-&gt; EthValue ctx rep -&gt; Embed ctx (EthValue ctx rep)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; EthValue ctx ('EthReprAtomic Integer)
forall (ctx :: TMap Symbol [EthRepr]) t.
t -&gt; EthValue ctx ('EthReprAtomic t)
</span><a href="Data.SignTyped.Structure.html#EthValueAtomic"><span class="hs-identifier hs-var">EthValueAtomic</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679218819"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-337"></span><span>                    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String -&gt; Embed ctx (EthValue ctx rep)
forall a. String -&gt; Embed ctx a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Value is out of range&quot;</span></span><span>
</span><span id="line-338"></span><span>            </span><span class="annot"><span class="annottext">EthType rep
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-339"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; Embed ctx (EthValue ctx rep)
forall a. String -&gt; Embed ctx a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Embed ctx (EthValue ctx rep))
-&gt; String -&gt; Embed ctx (EthValue ctx rep)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid eth type, expected &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Some EthType -&gt; (forall (t :: EthRepr). EthType t -&gt; Text) -&gt; Text
forall {k} (f :: k -&gt; *) r.
Some f -&gt; (forall (t :: k). f t -&gt; r) -&gt; r
</span><a href="Data.SignTyped.Type.Some.html#withSome"><span class="hs-identifier hs-var">withSome</span></a></span><span> </span><span class="annot"><span class="annottext">Some EthType
</span><a href="#local-6989586621679218812"><span class="hs-identifier hs-var">ourEthType</span></a></span><span> </span><span class="annot"><span class="annottext">EthType t -&gt; Text
forall (t :: EthRepr). EthType t -&gt; Text
</span><a href="Data.SignTyped.Structure.html#ethTypeName"><span class="hs-identifier hs-var">ethTypeName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-340"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-341"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-342"></span><span>    </span><span id="local-6989586621679218812"><span class="annot"><span class="annottext">ourEthType :: Some EthType
</span><a href="#local-6989586621679218812"><span class="hs-identifier hs-var hs-var">ourEthType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-343"></span><span>        </span><span class="annot"><span class="annottext">EthType ('EthReprAtomic Integer) -&gt; Some EthType
forall {k} (f :: k -&gt; *) (t :: k). f t -&gt; Some f
</span><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-var">Some</span></a></span><span> </span><span class="annot"><span class="annottext">(EthType ('EthReprAtomic Integer) -&gt; Some EthType)
-&gt; EthType ('EthReprAtomic Integer) -&gt; Some EthType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AtomicEthType Integer -&gt; EthType ('EthReprAtomic Integer)
forall t. AtomicEthType t -&gt; EthType ('EthReprAtomic t)
</span><a href="Data.SignTyped.Structure.html#EthTypeAtomic"><span class="hs-identifier hs-var">EthTypeAtomic</span></a></span><span> </span><span class="annot"><span class="annottext">(AtomicEthType Integer -&gt; EthType ('EthReprAtomic Integer))
-&gt; AtomicEthType Integer -&gt; EthType ('EthReprAtomic Integer)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AtomicIntegerSignedness -&gt; Int -&gt; AtomicEthType Integer
</span><a href="Data.SignTyped.Structure.html#AtomicEthTypeInteger"><span class="hs-identifier hs-var">AtomicEthTypeInteger</span></a></span><span> </span><span class="annot"><span class="annottext">AtomicIntegerSignedness
</span><a href="#local-6989586621679218810"><span class="hs-identifier hs-var">signedness</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679218811"><span class="hs-identifier hs-var">bitSize</span></a></span><span>
</span><span id="line-344"></span><span>
</span><span id="line-345"></span><span class="annot"><span class="hs-comment">{-| This handle encodes Haskell `BS.ByteString` into Solidity's @address@, @bytesN@ or @bytes@.

    The single parameter chooses a subtype:

        * `AtomicBytesSubtypeAddress` allows bytestrings of length 20, and encodes it as an @address@: left-padded with
    zero bytes until the length of 32.

        * @`AtomicBytesSubtypeShortBytes` N@ allows bytestrings with length of exactly @N@, and encodes it as
    a @bytesN@: right-padded with zero bytes until the length of 32. The handle will only make a valid encoding for
    @1 &lt;= N &lt;= 32@.

        * `AtomicBytesSubtypeLongBytes` allows bytestrings of any length and any contents, and encodes it as @bytes@:
    by taking the @keccak256@ of the bytes. -}</span></span><span>
</span><span id="line-358"></span><span class="annot"><a href="Data.SignTyped.Class.html#bytesValueHandle"><span class="hs-identifier hs-type">bytesValueHandle</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-359"></span><span>    </span><span class="annot"><a href="Data.SignTyped.Structure.html#AtomicBytesSubtype"><span class="hs-identifier hs-type">AtomicBytesSubtype</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-comment">{-^ The subtype of the bytestring. -}</span></span><span>
</span><span id="line-360"></span><span>    </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueHandle"><span class="hs-identifier hs-type">SignableValueHandle</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span>
</span><span id="line-361"></span><span id="bytesValueHandle"><span class="annot"><span class="annottext">bytesValueHandle :: AtomicBytesSubtype -&gt; SignableValueHandle ByteString
</span><a href="Data.SignTyped.Class.html#bytesValueHandle"><span class="hs-identifier hs-var hs-var">bytesValueHandle</span></a></span></span><span> </span><span id="local-6989586621679218831"><span class="annot"><span class="annottext">AtomicBytesSubtype
</span><a href="#local-6989586621679218831"><span class="hs-identifier hs-var">subtype</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueHandle"><span class="hs-identifier hs-type">SignableValueHandle</span></a></span><span>
</span><span id="line-362"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">signableValueEthType :: Some EthType
</span><a href="Data.SignTyped.Class.html#signableValueEthType"><span class="hs-identifier hs-var">signableValueEthType</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-363"></span><span>        </span><span class="annot"><span class="annottext">Some EthType
</span><a href="#local-6989586621679218832"><span class="hs-identifier hs-var">ourEthType</span></a></span><span>
</span><span id="line-364"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">signableValueTypeContextBuilder :: Maybe TypeContextBuilder
</span><a href="Data.SignTyped.Class.html#signableValueTypeContextBuilder"><span class="hs-identifier hs-var">signableValueTypeContextBuilder</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-365"></span><span>        </span><span class="annot"><span class="annottext">Maybe TypeContextBuilder
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-366"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">signableValueTypeContext :: Some TypeContext
</span><a href="Data.SignTyped.Class.html#signableValueTypeContext"><span class="hs-identifier hs-var">signableValueTypeContext</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-367"></span><span>        </span><span class="annot"><span class="annottext">Some TypeContext
</span><a href="Data.SignTyped.Structure.html#emptyTypeContext"><span class="hs-identifier hs-var">emptyTypeContext</span></a></span><span>
</span><span id="line-368"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">signableValueEmbed :: forall (ctx :: TMap Symbol [EthRepr]) (rep :: EthRepr).
EthType rep -&gt; ByteString -&gt; Embed ctx (EthValue ctx rep)
</span><a href="Data.SignTyped.Class.html#signableValueEmbed"><span class="hs-identifier hs-var">signableValueEmbed</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679218838"><span class="annot"><span class="annottext">EthType rep
</span><a href="#local-6989586621679218838"><span class="hs-identifier hs-var">givenEthType</span></a></span></span><span> </span><span id="local-6989586621679218839"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679218839"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-369"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">EthType rep
</span><a href="#local-6989586621679218838"><span class="hs-identifier hs-var">givenEthType</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-370"></span><span>            </span><span class="annot"><a href="Data.SignTyped.Structure.html#EthTypeAtomic"><span class="hs-identifier hs-type">EthTypeAtomic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Structure.html#AtomicEthTypeBytes"><span class="hs-identifier hs-type">AtomicEthTypeBytes</span></a></span><span> </span><span id="local-6989586621679218852"><span class="annot"><span class="annottext">AtomicBytesSubtype
</span><a href="#local-6989586621679218852"><span class="hs-identifier hs-var">givenSubtype</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-371"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">AtomicBytesSubtype
</span><a href="#local-6989586621679218852"><span class="hs-identifier hs-var">givenSubtype</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-372"></span><span>                    </span><span class="annot"><span class="annottext">AtomicBytesSubtype
</span><a href="Data.SignTyped.Structure.html#AtomicBytesSubtypeAddress"><span class="hs-identifier hs-var">AtomicBytesSubtypeAddress</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-373"></span><span>                        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><span class="hs-identifier hs-var">BS.length</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679218839"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">20</span></span><span>
</span><span id="line-374"></span><span>                            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">EthValue ctx rep -&gt; Embed ctx (EthValue ctx rep)
forall a. a -&gt; Embed ctx a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(EthValue ctx rep -&gt; Embed ctx (EthValue ctx rep))
-&gt; EthValue ctx rep -&gt; Embed ctx (EthValue ctx rep)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; EthValue ctx ('EthReprAtomic ByteString)
forall (ctx :: TMap Symbol [EthRepr]) t.
t -&gt; EthValue ctx ('EthReprAtomic t)
</span><a href="Data.SignTyped.Structure.html#EthValueAtomic"><span class="hs-identifier hs-var">EthValueAtomic</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679218839"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-375"></span><span>                            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String -&gt; Embed ctx (EthValue ctx rep)
forall a. String -&gt; Embed ctx a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid address&quot;</span></span><span>
</span><span id="line-376"></span><span>                    </span><span class="annot"><a href="Data.SignTyped.Structure.html#AtomicBytesSubtypeShortBytes"><span class="hs-identifier hs-type">AtomicBytesSubtypeShortBytes</span></a></span><span> </span><span id="local-6989586621679218854"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679218854"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-377"></span><span>                        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><span class="hs-identifier hs-var">BS.length</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679218839"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679218854"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-378"></span><span>                            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">EthValue ctx rep -&gt; Embed ctx (EthValue ctx rep)
forall a. a -&gt; Embed ctx a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(EthValue ctx rep -&gt; Embed ctx (EthValue ctx rep))
-&gt; EthValue ctx rep -&gt; Embed ctx (EthValue ctx rep)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; EthValue ctx ('EthReprAtomic ByteString)
forall (ctx :: TMap Symbol [EthRepr]) t.
t -&gt; EthValue ctx ('EthReprAtomic t)
</span><a href="Data.SignTyped.Structure.html#EthValueAtomic"><span class="hs-identifier hs-var">EthValueAtomic</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679218839"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-379"></span><span>                            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String -&gt; Embed ctx (EthValue ctx rep)
forall a. String -&gt; Embed ctx a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid byte count&quot;</span></span><span>
</span><span id="line-380"></span><span>                    </span><span class="annot"><span class="annottext">AtomicBytesSubtype
</span><a href="Data.SignTyped.Structure.html#AtomicBytesSubtypeLongBytes"><span class="hs-identifier hs-var">AtomicBytesSubtypeLongBytes</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-381"></span><span>                        </span><span class="annot"><span class="annottext">EthValue ctx rep -&gt; Embed ctx (EthValue ctx rep)
forall a. a -&gt; Embed ctx a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(EthValue ctx rep -&gt; Embed ctx (EthValue ctx rep))
-&gt; EthValue ctx rep -&gt; Embed ctx (EthValue ctx rep)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; EthValue ctx ('EthReprAtomic ByteString)
forall (ctx :: TMap Symbol [EthRepr]) t.
t -&gt; EthValue ctx ('EthReprAtomic t)
</span><a href="Data.SignTyped.Structure.html#EthValueAtomic"><span class="hs-identifier hs-var">EthValueAtomic</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679218839"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-382"></span><span>            </span><span class="annot"><span class="annottext">EthType rep
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-383"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; Embed ctx (EthValue ctx rep)
forall a. String -&gt; Embed ctx a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Embed ctx (EthValue ctx rep))
-&gt; String -&gt; Embed ctx (EthValue ctx rep)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid eth type, expected &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Some EthType -&gt; (forall (t :: EthRepr). EthType t -&gt; Text) -&gt; Text
forall {k} (f :: k -&gt; *) r.
Some f -&gt; (forall (t :: k). f t -&gt; r) -&gt; r
</span><a href="Data.SignTyped.Type.Some.html#withSome"><span class="hs-identifier hs-var">withSome</span></a></span><span> </span><span class="annot"><span class="annottext">Some EthType
</span><a href="#local-6989586621679218832"><span class="hs-identifier hs-var">ourEthType</span></a></span><span> </span><span class="annot"><span class="annottext">EthType t -&gt; Text
forall (t :: EthRepr). EthType t -&gt; Text
</span><a href="Data.SignTyped.Structure.html#ethTypeName"><span class="hs-identifier hs-var">ethTypeName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-384"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-385"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-386"></span><span>    </span><span id="local-6989586621679218832"><span class="annot"><span class="annottext">ourEthType :: Some EthType
</span><a href="#local-6989586621679218832"><span class="hs-identifier hs-var hs-var">ourEthType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-387"></span><span>        </span><span class="annot"><span class="annottext">EthType ('EthReprAtomic ByteString) -&gt; Some EthType
forall {k} (f :: k -&gt; *) (t :: k). f t -&gt; Some f
</span><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-var">Some</span></a></span><span> </span><span class="annot"><span class="annottext">(EthType ('EthReprAtomic ByteString) -&gt; Some EthType)
-&gt; EthType ('EthReprAtomic ByteString) -&gt; Some EthType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AtomicEthType ByteString -&gt; EthType ('EthReprAtomic ByteString)
forall t. AtomicEthType t -&gt; EthType ('EthReprAtomic t)
</span><a href="Data.SignTyped.Structure.html#EthTypeAtomic"><span class="hs-identifier hs-var">EthTypeAtomic</span></a></span><span> </span><span class="annot"><span class="annottext">(AtomicEthType ByteString -&gt; EthType ('EthReprAtomic ByteString))
-&gt; AtomicEthType ByteString -&gt; EthType ('EthReprAtomic ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AtomicBytesSubtype -&gt; AtomicEthType ByteString
</span><a href="Data.SignTyped.Structure.html#AtomicEthTypeBytes"><span class="hs-identifier hs-var">AtomicEthTypeBytes</span></a></span><span> </span><span class="annot"><span class="annottext">AtomicBytesSubtype
</span><a href="#local-6989586621679218831"><span class="hs-identifier hs-var">subtype</span></a></span><span>
</span><span id="line-388"></span><span>
</span><span id="line-389"></span><span class="annot"><span class="hs-comment">{-| This handle encodes Haskell `Text.Text` into Solidity's @string@: by taking the @keccak256@ of the UTF-8 encoding
of the string. -}</span></span><span>
</span><span id="line-391"></span><span class="annot"><a href="Data.SignTyped.Class.html#stringValueHandle"><span class="hs-identifier hs-type">stringValueHandle</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-392"></span><span>    </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueHandle"><span class="hs-identifier hs-type">SignableValueHandle</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text.Text</span></span><span>
</span><span id="line-393"></span><span id="stringValueHandle"><span class="annot"><span class="annottext">stringValueHandle :: SignableValueHandle Text
</span><a href="Data.SignTyped.Class.html#stringValueHandle"><span class="hs-identifier hs-var hs-var">stringValueHandle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueHandle"><span class="hs-identifier hs-type">SignableValueHandle</span></a></span><span>
</span><span id="line-394"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">signableValueEthType :: Some EthType
</span><a href="Data.SignTyped.Class.html#signableValueEthType"><span class="hs-identifier hs-var">signableValueEthType</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-395"></span><span>        </span><span class="annot"><span class="annottext">Some EthType
</span><a href="#local-6989586621679218855"><span class="hs-identifier hs-var">ourEthType</span></a></span><span>
</span><span id="line-396"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">signableValueTypeContextBuilder :: Maybe TypeContextBuilder
</span><a href="Data.SignTyped.Class.html#signableValueTypeContextBuilder"><span class="hs-identifier hs-var">signableValueTypeContextBuilder</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-397"></span><span>        </span><span class="annot"><span class="annottext">Maybe TypeContextBuilder
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-398"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">signableValueTypeContext :: Some TypeContext
</span><a href="Data.SignTyped.Class.html#signableValueTypeContext"><span class="hs-identifier hs-var">signableValueTypeContext</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-399"></span><span>        </span><span class="annot"><span class="annottext">Some TypeContext
</span><a href="Data.SignTyped.Structure.html#emptyTypeContext"><span class="hs-identifier hs-var">emptyTypeContext</span></a></span><span>
</span><span id="line-400"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">signableValueEmbed :: forall (ctx :: TMap Symbol [EthRepr]) (rep :: EthRepr).
EthType rep -&gt; Text -&gt; Embed ctx (EthValue ctx rep)
</span><a href="Data.SignTyped.Class.html#signableValueEmbed"><span class="hs-identifier hs-var">signableValueEmbed</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679218861"><span class="annot"><span class="annottext">EthType rep
</span><a href="#local-6989586621679218861"><span class="hs-identifier hs-var">givenEthType</span></a></span></span><span> </span><span id="local-6989586621679218862"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679218862"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-401"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">EthType rep
</span><a href="#local-6989586621679218861"><span class="hs-identifier hs-var">givenEthType</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-402"></span><span>            </span><span class="annot"><a href="Data.SignTyped.Structure.html#EthTypeAtomic"><span class="hs-identifier hs-type">EthTypeAtomic</span></a></span><span> </span><span class="annot"><span class="annottext">AtomicEthType t
</span><a href="Data.SignTyped.Structure.html#AtomicEthTypeString"><span class="hs-identifier hs-var">AtomicEthTypeString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-403"></span><span>                </span><span class="annot"><span class="annottext">EthValue ctx rep -&gt; Embed ctx (EthValue ctx rep)
forall a. a -&gt; Embed ctx a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(EthValue ctx rep -&gt; Embed ctx (EthValue ctx rep))
-&gt; EthValue ctx rep -&gt; Embed ctx (EthValue ctx rep)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; EthValue ctx ('EthReprAtomic Text)
forall (ctx :: TMap Symbol [EthRepr]) t.
t -&gt; EthValue ctx ('EthReprAtomic t)
</span><a href="Data.SignTyped.Structure.html#EthValueAtomic"><span class="hs-identifier hs-var">EthValueAtomic</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679218862"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-404"></span><span>            </span><span class="annot"><span class="annottext">EthType rep
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-405"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; Embed ctx (EthValue ctx rep)
forall a. String -&gt; Embed ctx a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Embed ctx (EthValue ctx rep))
-&gt; String -&gt; Embed ctx (EthValue ctx rep)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid eth type, expected &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Some EthType -&gt; (forall (t :: EthRepr). EthType t -&gt; Text) -&gt; Text
forall {k} (f :: k -&gt; *) r.
Some f -&gt; (forall (t :: k). f t -&gt; r) -&gt; r
</span><a href="Data.SignTyped.Type.Some.html#withSome"><span class="hs-identifier hs-var">withSome</span></a></span><span> </span><span class="annot"><span class="annottext">Some EthType
</span><a href="#local-6989586621679218855"><span class="hs-identifier hs-var">ourEthType</span></a></span><span> </span><span class="annot"><span class="annottext">EthType t -&gt; Text
forall (t :: EthRepr). EthType t -&gt; Text
</span><a href="Data.SignTyped.Structure.html#ethTypeName"><span class="hs-identifier hs-var">ethTypeName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-407"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-408"></span><span>    </span><span id="local-6989586621679218855"><span class="annot"><span class="annottext">ourEthType :: Some EthType
</span><a href="#local-6989586621679218855"><span class="hs-identifier hs-var hs-var">ourEthType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-409"></span><span>        </span><span class="annot"><span class="annottext">EthType ('EthReprAtomic Text) -&gt; Some EthType
forall {k} (f :: k -&gt; *) (t :: k). f t -&gt; Some f
</span><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-var">Some</span></a></span><span> </span><span class="annot"><span class="annottext">(EthType ('EthReprAtomic Text) -&gt; Some EthType)
-&gt; EthType ('EthReprAtomic Text) -&gt; Some EthType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AtomicEthType Text -&gt; EthType ('EthReprAtomic Text)
forall t. AtomicEthType t -&gt; EthType ('EthReprAtomic t)
</span><a href="Data.SignTyped.Structure.html#EthTypeAtomic"><span class="hs-identifier hs-var">EthTypeAtomic</span></a></span><span> </span><span class="annot"><span class="annottext">AtomicEthType Text
</span><a href="Data.SignTyped.Structure.html#AtomicEthTypeString"><span class="hs-identifier hs-var">AtomicEthTypeString</span></a></span><span>
</span><span id="line-410"></span><span>
</span><span id="line-411"></span><span class="annot"><span class="hs-comment">{-| This handle encodes the array type.

    The first parameter is the handle for the underlying type, it will be used to encode each element of the array.
The second parameter is the size of the array: a `Just`-number for a fixed-size array (e.g. @address[32]@) or
`Nothing` for a variable-length array (e.g. @string[]@).

    The encoding in both cases is the `keccak256` of the concatenation of the content's encodings.

    If the array is fixed-sized, then the actual value's length will be validated upon encoding. -}</span></span><span>
</span><span id="line-420"></span><span id="local-6989586621679218225"><span class="annot"><a href="Data.SignTyped.Class.html#arrayValueHandle"><span class="hs-identifier hs-type">arrayValueHandle</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-421"></span><span>    </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueHandle"><span class="hs-identifier hs-type">SignableValueHandle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218225"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-comment">{-^ Underlying type's handle. -}</span></span><span>
</span><span id="line-422"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-comment">{-^ Array size. -}</span></span><span>
</span><span id="line-423"></span><span>    </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueHandle"><span class="hs-identifier hs-type">SignableValueHandle</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679218225"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-424"></span><span id="arrayValueHandle"><span class="annot"><span class="annottext">arrayValueHandle :: forall a.
SignableValueHandle a -&gt; Maybe Int -&gt; SignableValueHandle [a]
</span><a href="Data.SignTyped.Class.html#arrayValueHandle"><span class="hs-identifier hs-var hs-var">arrayValueHandle</span></a></span></span><span> </span><span id="local-6989586621679218868"><span class="annot"><span class="annottext">SignableValueHandle a
</span><a href="#local-6989586621679218868"><span class="hs-identifier hs-var">elemHandle</span></a></span></span><span> </span><span id="local-6989586621679218869"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679218869"><span class="hs-identifier hs-var">mbSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueHandle"><span class="hs-identifier hs-type">SignableValueHandle</span></a></span><span>
</span><span id="line-425"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">signableValueEthType :: Some EthType
</span><a href="Data.SignTyped.Class.html#signableValueEthType"><span class="hs-identifier hs-var">signableValueEthType</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-426"></span><span>        </span><span class="annot"><span class="annottext">Some EthType
</span><a href="#local-6989586621679218870"><span class="hs-identifier hs-var">ourEthType</span></a></span><span>
</span><span id="line-427"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">signableValueTypeContextBuilder :: Maybe TypeContextBuilder
</span><a href="Data.SignTyped.Class.html#signableValueTypeContextBuilder"><span class="hs-identifier hs-var">signableValueTypeContextBuilder</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-428"></span><span>        </span><span class="annot"><span class="annottext">SignableValueHandle a -&gt; Maybe TypeContextBuilder
forall a. SignableValueHandle a -&gt; Maybe TypeContextBuilder
</span><a href="Data.SignTyped.Class.html#signableValueTypeContextBuilder"><span class="hs-identifier hs-var">signableValueTypeContextBuilder</span></a></span><span> </span><span class="annot"><span class="annottext">SignableValueHandle a
</span><a href="#local-6989586621679218868"><span class="hs-identifier hs-var">elemHandle</span></a></span><span>
</span><span id="line-429"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">signableValueTypeContext :: Some TypeContext
</span><a href="Data.SignTyped.Class.html#signableValueTypeContext"><span class="hs-identifier hs-var">signableValueTypeContext</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-430"></span><span>        </span><span class="annot"><span class="annottext">SignableValueHandle a -&gt; Some TypeContext
forall a. SignableValueHandle a -&gt; Some TypeContext
</span><a href="Data.SignTyped.Class.html#signableValueTypeContext"><span class="hs-identifier hs-var">signableValueTypeContext</span></a></span><span> </span><span class="annot"><span class="annottext">SignableValueHandle a
</span><a href="#local-6989586621679218868"><span class="hs-identifier hs-var">elemHandle</span></a></span><span>
</span><span id="line-431"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">signableValueEmbed :: forall (ctx :: TMap Symbol [EthRepr]) (rep :: EthRepr).
EthType rep -&gt; [a] -&gt; Embed ctx (EthValue ctx rep)
</span><a href="Data.SignTyped.Class.html#signableValueEmbed"><span class="hs-identifier hs-var">signableValueEmbed</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679218876"><span class="annot"><span class="annottext">EthType rep
</span><a href="#local-6989586621679218876"><span class="hs-identifier hs-var">givenEthType</span></a></span></span><span> </span><span id="local-6989586621679218877"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679218877"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-432"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">EthType rep
</span><a href="#local-6989586621679218876"><span class="hs-identifier hs-var">givenEthType</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-433"></span><span>            </span><span class="annot"><a href="Data.SignTyped.Structure.html#EthTypeArray"><span class="hs-identifier hs-type">EthTypeArray</span></a></span><span> </span><span id="local-6989586621679218894"><span class="annot"><span class="annottext">EthType rep1
</span><a href="#local-6989586621679218894"><span class="hs-identifier hs-var">givenElemType</span></a></span></span><span> </span><span id="local-6989586621679218895"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679218895"><span class="hs-identifier hs-var">givenMbSize</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-434"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679218895"><span class="hs-identifier hs-var">givenMbSize</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-435"></span><span>                    </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; Embed ctx ()
forall a. a -&gt; Embed ctx a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-436"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679218896"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679218896"><span class="hs-identifier hs-var">givenSize</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-437"></span><span>                        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679218877"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679218896"><span class="hs-identifier hs-var">givenSize</span></a></span><span>
</span><span id="line-438"></span><span>                            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">() -&gt; Embed ctx ()
forall a. a -&gt; Embed ctx a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-439"></span><span>                            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String -&gt; Embed ctx ()
forall a. String -&gt; Embed ctx a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid array size&quot;</span></span><span>
</span><span id="line-440"></span><span>                </span><span id="local-6989586621679218898"><span class="annot"><span class="annottext">[EthValue ctx rep1]
</span><a href="#local-6989586621679218898"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Int, a)]
-&gt; ((Int, a) -&gt; Embed ctx (EthValue ctx rep1))
-&gt; Embed ctx [EthValue ctx rep1]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><span class="hs-identifier hs-var">forM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; [a] -&gt; [(Int, a)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679218877"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((Int, a) -&gt; Embed ctx (EthValue ctx rep1))
 -&gt; Embed ctx [EthValue ctx rep1])
-&gt; ((Int, a) -&gt; Embed ctx (EthValue ctx rep1))
-&gt; Embed ctx [EthValue ctx rep1]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679218900"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679218900"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679218901"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679218901"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-441"></span><span>                    </span><span class="annot"><span class="annottext">Int
-&gt; Embed ctx (EthValue ctx rep1) -&gt; Embed ctx (EthValue ctx rep1)
forall (ctx :: TMap Symbol [EthRepr]) a.
Int -&gt; Embed ctx a -&gt; Embed ctx a
</span><a href="Data.SignTyped.Class.html#withEmbedLocationArrayElement"><span class="hs-identifier hs-var">withEmbedLocationArrayElement</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679218900"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">(Embed ctx (EthValue ctx rep1) -&gt; Embed ctx (EthValue ctx rep1))
-&gt; Embed ctx (EthValue ctx rep1) -&gt; Embed ctx (EthValue ctx rep1)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-442"></span><span>                        </span><span class="annot"><span class="annottext">SignableValueHandle a
-&gt; forall (ctx :: TMap Symbol [EthRepr]) (rep :: EthRepr).
   EthType rep -&gt; a -&gt; Embed ctx (EthValue ctx rep)
forall a.
SignableValueHandle a
-&gt; forall (ctx :: TMap Symbol [EthRepr]) (rep :: EthRepr).
   EthType rep -&gt; a -&gt; Embed ctx (EthValue ctx rep)
</span><a href="Data.SignTyped.Class.html#signableValueEmbed"><span class="hs-identifier hs-var">signableValueEmbed</span></a></span><span> </span><span class="annot"><span class="annottext">SignableValueHandle a
</span><a href="#local-6989586621679218868"><span class="hs-identifier hs-var">elemHandle</span></a></span><span> </span><span class="annot"><span class="annottext">EthType rep1
</span><a href="#local-6989586621679218894"><span class="hs-identifier hs-var">givenElemType</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679218901"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-443"></span><span>                </span><span class="annot"><span class="annottext">EthValue ctx rep -&gt; Embed ctx (EthValue ctx rep)
forall a. a -&gt; Embed ctx a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(EthValue ctx rep -&gt; Embed ctx (EthValue ctx rep))
-&gt; EthValue ctx rep -&gt; Embed ctx (EthValue ctx rep)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[EthValue ctx rep1] -&gt; EthValue ctx ('EthReprArray rep1)
forall (ctx :: TMap Symbol [EthRepr]) (rep :: EthRepr).
[EthValue ctx rep] -&gt; EthValue ctx ('EthReprArray rep)
</span><a href="Data.SignTyped.Structure.html#EthValueArray"><span class="hs-identifier hs-var">EthValueArray</span></a></span><span> </span><span class="annot"><span class="annottext">[EthValue ctx rep1]
</span><a href="#local-6989586621679218898"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-444"></span><span>            </span><span class="annot"><span class="annottext">EthType rep
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-445"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; Embed ctx (EthValue ctx rep)
forall a. String -&gt; Embed ctx a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Embed ctx (EthValue ctx rep))
-&gt; String -&gt; Embed ctx (EthValue ctx rep)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid eth type, expected &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Some EthType -&gt; (forall (t :: EthRepr). EthType t -&gt; Text) -&gt; Text
forall {k} (f :: k -&gt; *) r.
Some f -&gt; (forall (t :: k). f t -&gt; r) -&gt; r
</span><a href="Data.SignTyped.Type.Some.html#withSome"><span class="hs-identifier hs-var">withSome</span></a></span><span> </span><span class="annot"><span class="annottext">Some EthType
</span><a href="#local-6989586621679218870"><span class="hs-identifier hs-var">ourEthType</span></a></span><span> </span><span class="annot"><span class="annottext">EthType t -&gt; Text
forall (t :: EthRepr). EthType t -&gt; Text
</span><a href="Data.SignTyped.Structure.html#ethTypeName"><span class="hs-identifier hs-var">ethTypeName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-446"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-447"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-448"></span><span>    </span><span id="local-6989586621679218870"><span class="annot"><span class="annottext">ourEthType :: Some EthType
</span><a href="#local-6989586621679218870"><span class="hs-identifier hs-var hs-var">ourEthType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-449"></span><span>        </span><span class="annot"><span class="annottext">Some EthType
-&gt; (forall (t :: EthRepr). EthType t -&gt; Some EthType)
-&gt; Some EthType
forall {k} (f :: k -&gt; *) r.
Some f -&gt; (forall (t :: k). f t -&gt; r) -&gt; r
</span><a href="Data.SignTyped.Type.Some.html#withSome"><span class="hs-identifier hs-var">withSome</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SignableValueHandle a -&gt; Some EthType
forall a. SignableValueHandle a -&gt; Some EthType
</span><a href="Data.SignTyped.Class.html#signableValueEthType"><span class="hs-identifier hs-var">signableValueEthType</span></a></span><span> </span><span class="annot"><span class="annottext">SignableValueHandle a
</span><a href="#local-6989586621679218868"><span class="hs-identifier hs-var">elemHandle</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((forall (t :: EthRepr). EthType t -&gt; Some EthType)
 -&gt; Some EthType)
-&gt; (forall (t :: EthRepr). EthType t -&gt; Some EthType)
-&gt; Some EthType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679218903"><span class="annot"><span class="annottext">EthType t
</span><a href="#local-6989586621679218903"><span class="hs-identifier hs-var">elemType</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-450"></span><span>            </span><span class="annot"><span class="annottext">EthType ('EthReprArray t) -&gt; Some EthType
forall {k} (f :: k -&gt; *) (t :: k). f t -&gt; Some f
</span><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-var">Some</span></a></span><span> </span><span class="annot"><span class="annottext">(EthType ('EthReprArray t) -&gt; Some EthType)
-&gt; EthType ('EthReprArray t) -&gt; Some EthType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">EthType t -&gt; Maybe Int -&gt; EthType ('EthReprArray t)
forall (rep1 :: EthRepr).
EthType rep1 -&gt; Maybe Int -&gt; EthType ('EthReprArray rep1)
</span><a href="Data.SignTyped.Structure.html#EthTypeArray"><span class="hs-identifier hs-var">EthTypeArray</span></a></span><span> </span><span class="annot"><span class="annottext">EthType t
</span><a href="#local-6989586621679218903"><span class="hs-identifier hs-var">elemType</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679218869"><span class="hs-identifier hs-var">mbSize</span></a></span><span>
</span><span id="line-451"></span><span>
</span><span id="line-452"></span><span>
</span><span id="line-453"></span><span>
</span><span id="line-454"></span><span class="annot"><span class="hs-comment">{-| This handle encodes a struct type.

    The encoding of a struct is @keccak256@ of the concatenation of the struct's typehash and each of its value's
encoding in their definition order.

    An example usage of this function:

    @
        data MyPerson = MyPerson
            { pname :: String
            , pwallet :: BS.ByteString
            }
            deriving (Show, Eq, Generic)

        myPersonSignableValueHandle :: SignableValueHandle MyPerson
        myPersonSignableValueHandle =
            structValueHandle
                (SName \@\&quot;Person\&quot;)
                [   SignableStructMemberHandle &quot;name&quot; pname (signableValueHandle \@&quot;string&quot;)
                ,   SignableStructMemberHandle &quot;wallet&quot; pwallet (signableValueHandle \@&quot;address&quot;)
                ]
    @ -}</span></span><span>
</span><span id="line-476"></span><span class="annot"><a href="Data.SignTyped.Class.html#structValueHandle"><span class="hs-identifier hs-type">structValueHandle</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-477"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679218260"><span class="annot"><a href="#local-6989586621679218260"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679218259"><span class="annot"><a href="#local-6989586621679218259"><span class="hs-identifier hs-type">structName</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-478"></span><span>    </span><span class="annot"><a href="Data.SignTyped.Type.SName.html#SName"><span class="hs-identifier hs-type">SName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218259"><span class="hs-identifier hs-type">structName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-479"></span><span>        </span><span class="annot"><span class="hs-comment">{-^ The name of the struct. Use @-XTypeApplications@ to declare constants here, e.g. @SName \@\&quot;Person\&quot;@. -}</span></span><span>
</span><span id="line-480"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Data.SignTyped.Class.html#SignableStructMemberHandle"><span class="hs-identifier hs-type">SignableStructMemberHandle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218260"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-comment">{-^ The list of the struct's member handles. -}</span></span><span>
</span><span id="line-481"></span><span>    </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueHandle"><span class="hs-identifier hs-type">SignableValueHandle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218260"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-482"></span><span id="structValueHandle"><span class="annot"><span class="annottext">structValueHandle :: forall s (structName :: Symbol).
SName structName
-&gt; [SignableStructMemberHandle s] -&gt; SignableValueHandle s
</span><a href="Data.SignTyped.Class.html#structValueHandle"><span class="hs-identifier hs-var hs-var">structValueHandle</span></a></span></span><span> </span><span id="local-6989586621679218906"><span class="annot"><span class="annottext">SName structName
</span><a href="#local-6989586621679218906"><span class="hs-identifier hs-var">structSName</span></a></span></span><span> </span><span id="local-6989586621679218907"><span class="annot"><span class="annottext">[SignableStructMemberHandle s]
</span><a href="#local-6989586621679218907"><span class="hs-identifier hs-var">structMembers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueHandle"><span class="hs-identifier hs-type">SignableValueHandle</span></a></span><span>
</span><span id="line-483"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">signableValueEthType :: Some EthType
</span><a href="Data.SignTyped.Class.html#signableValueEthType"><span class="hs-identifier hs-var">signableValueEthType</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-484"></span><span>        </span><span class="annot"><span class="annottext">EthType ('EthReprStruct structName) -&gt; Some EthType
forall {k} (f :: k -&gt; *) (t :: k). f t -&gt; Some f
</span><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-var">Some</span></a></span><span> </span><span class="annot"><span class="annottext">(EthType ('EthReprStruct structName) -&gt; Some EthType)
-&gt; EthType ('EthReprStruct structName) -&gt; Some EthType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SName structName -&gt; EthType ('EthReprStruct structName)
forall (typename :: Symbol).
SName typename -&gt; EthType ('EthReprStruct typename)
</span><a href="Data.SignTyped.Structure.html#EthTypeStruct"><span class="hs-identifier hs-var">EthTypeStruct</span></a></span><span> </span><span class="annot"><span class="annottext">SName structName
</span><a href="#local-6989586621679218906"><span class="hs-identifier hs-var">structSName</span></a></span><span>
</span><span id="line-485"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">signableValueTypeContextBuilder :: Maybe TypeContextBuilder
</span><a href="Data.SignTyped.Class.html#signableValueTypeContextBuilder"><span class="hs-identifier hs-var">signableValueTypeContextBuilder</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-486"></span><span>        </span><span class="annot"><span class="annottext">TypeContextBuilder -&gt; Maybe TypeContextBuilder
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TypeContextBuilder
</span><a href="#local-6989586621679218909"><span class="hs-identifier hs-var">ourTypeContextBuilder</span></a></span><span>
</span><span id="line-487"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">signableValueTypeContext :: Some TypeContext
</span><a href="Data.SignTyped.Class.html#signableValueTypeContext"><span class="hs-identifier hs-var">signableValueTypeContext</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-488"></span><span>        </span><span class="annot"><span class="annottext">TypeContextBuilder -&gt; Some TypeContext
</span><a href="Data.SignTyped.Class.html#executeTypeContextBuilder"><span class="hs-identifier hs-var">executeTypeContextBuilder</span></a></span><span> </span><span class="annot"><span class="annottext">TypeContextBuilder
</span><a href="#local-6989586621679218909"><span class="hs-identifier hs-var">ourTypeContextBuilder</span></a></span><span>
</span><span id="line-489"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">signableValueEmbed :: forall (ctx :: TMap Symbol [EthRepr]) (rep :: EthRepr).
EthType rep -&gt; s -&gt; Embed ctx (EthValue ctx rep)
</span><a href="Data.SignTyped.Class.html#signableValueEmbed"><span class="hs-identifier hs-var">signableValueEmbed</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679218915"><span class="annot"><span class="annottext">EthType rep
</span><a href="#local-6989586621679218915"><span class="hs-identifier hs-var">givenEthType</span></a></span></span><span> </span><span id="local-6989586621679218916"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679218916"><span class="hs-identifier hs-var">structInstance</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-490"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">EthType rep
</span><a href="#local-6989586621679218915"><span class="hs-identifier hs-var">givenEthType</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-491"></span><span>            </span><span class="annot"><a href="Data.SignTyped.Structure.html#EthTypeStruct"><span class="hs-identifier hs-type">EthTypeStruct</span></a></span><span> </span><span id="local-6989586621679218922"><span class="annot"><span class="annottext">SName typename
</span><a href="#local-6989586621679218922"><span class="hs-identifier hs-var">givenStructSName</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-492"></span><span>                </span><span id="local-6989586621679218923"><span class="annot"><span class="annottext">HList MemberDef (Lookup typename ctx)
</span><a href="#local-6989586621679218923"><span class="hs-identifier hs-var">givenStructDef</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SName typename -&gt; Embed ctx (HList MemberDef (Lookup typename ctx))
forall (typename :: Symbol) (ctx :: TMap Symbol [EthRepr]).
SName typename -&gt; Embed ctx (StructDef (Lookup typename ctx))
</span><a href="Data.SignTyped.Class.html#getStructDef"><span class="hs-identifier hs-var">getStructDef</span></a></span><span> </span><span class="annot"><span class="annottext">SName typename
</span><a href="#local-6989586621679218922"><span class="hs-identifier hs-var">givenStructSName</span></a></span><span>
</span><span id="line-493"></span><span>                </span><span id="local-6989586621679218924"><span class="annot"><span class="annottext">HList (EthValue ctx) (Lookup typename ctx)
</span><a href="#local-6989586621679218924"><span class="hs-identifier hs-var">embeddedMembers</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-494"></span><span>                    </span><span class="annot"><span class="annottext">(forall (t :: EthRepr). MemberDef t -&gt; Embed ctx (EthValue ctx t))
-&gt; HList MemberDef (Lookup typename ctx)
-&gt; Embed ctx (HList (EthValue ctx) (Lookup typename ctx))
forall {k} (m :: * -&gt; *) (f :: k -&gt; *) (g :: k -&gt; *) (ts :: [k]).
Applicative m =&gt;
(forall (t :: k). f t -&gt; m (g t)) -&gt; HList f ts -&gt; m (HList g ts)
</span><a href="Data.SignTyped.Type.HList.html#htraverse"><span class="hs-identifier hs-var">htraverse</span></a></span><span>
</span><span id="line-495"></span><span>                        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Structure.html#MemberDef"><span class="hs-identifier hs-type">MemberDef</span></a></span><span> </span><span id="local-6989586621679218929"><span class="annot"><span class="annottext">EthType t
</span><a href="#local-6989586621679218929"><span class="hs-identifier hs-var">givenMemberEthType</span></a></span></span><span> </span><span id="local-6989586621679218930"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679218930"><span class="hs-identifier hs-var">givenMemberName</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-496"></span><span>                            </span><span class="annot"><span class="annottext">Text -&gt; Embed ctx (EthValue ctx t) -&gt; Embed ctx (EthValue ctx t)
forall (ctx :: TMap Symbol [EthRepr]) a.
Text -&gt; Embed ctx a -&gt; Embed ctx a
</span><a href="Data.SignTyped.Class.html#withEmbedLocationStructMember"><span class="hs-identifier hs-var">withEmbedLocationStructMember</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679218930"><span class="hs-identifier hs-var">givenMemberName</span></a></span><span> </span><span class="annot"><span class="annottext">(Embed ctx (EthValue ctx t) -&gt; Embed ctx (EthValue ctx t))
-&gt; Embed ctx (EthValue ctx t) -&gt; Embed ctx (EthValue ctx t)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-497"></span><span>                                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; Map Text (StructMemberEmbedder s)
-&gt; Maybe (StructMemberEmbedder s)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679218930"><span class="hs-identifier hs-var">givenMemberName</span></a></span><span> </span><span class="annot"><span class="annottext">Map Text (StructMemberEmbedder s)
</span><a href="#local-6989586621679218932"><span class="hs-identifier hs-var">ourMemberEmbedderMap</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-498"></span><span>                                    </span><span class="annot"><span class="annottext">Maybe (StructMemberEmbedder s)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-499"></span><span>                                        </span><span class="annot"><span class="annottext">String -&gt; Embed ctx (EthValue ctx t)
forall a. String -&gt; Embed ctx a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unknown struct field&quot;</span></span><span>
</span><span id="line-500"></span><span>                                    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679218933"><span class="annot"><span class="annottext">StructMemberEmbedder s
</span><a href="#local-6989586621679218933"><span class="hs-identifier hs-var">embedder</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-501"></span><span>                                        </span><span class="annot"><span class="annottext">StructMemberEmbedder s
-&gt; forall (ctx :: TMap Symbol [EthRepr]) (rep :: EthRepr).
   EthType rep -&gt; s -&gt; Embed ctx (EthValue ctx rep)
forall s.
StructMemberEmbedder s
-&gt; forall (ctx :: TMap Symbol [EthRepr]) (rep :: EthRepr).
   EthType rep -&gt; s -&gt; Embed ctx (EthValue ctx rep)
</span><a href="Data.SignTyped.Class.html#runStructMemberEmbedder"><span class="hs-identifier hs-var">runStructMemberEmbedder</span></a></span><span> </span><span class="annot"><span class="annottext">StructMemberEmbedder s
</span><a href="#local-6989586621679218933"><span class="hs-identifier hs-var">embedder</span></a></span><span> </span><span class="annot"><span class="annottext">EthType t
</span><a href="#local-6989586621679218929"><span class="hs-identifier hs-var">givenMemberEthType</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679218916"><span class="hs-identifier hs-var">structInstance</span></a></span><span>
</span><span id="line-502"></span><span>                        </span><span class="hs-special">)</span><span>
</span><span id="line-503"></span><span>                        </span><span class="annot"><span class="annottext">HList MemberDef (Lookup typename ctx)
</span><a href="#local-6989586621679218923"><span class="hs-identifier hs-var">givenStructDef</span></a></span><span>
</span><span id="line-504"></span><span>                </span><span class="annot"><span class="annottext">EthValue ctx rep -&gt; Embed ctx (EthValue ctx rep)
forall a. a -&gt; Embed ctx a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(EthValue ctx rep -&gt; Embed ctx (EthValue ctx rep))
-&gt; EthValue ctx rep -&gt; Embed ctx (EthValue ctx rep)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HList (EthValue ctx) (Lookup typename ctx)
-&gt; EthValue ctx ('EthReprStruct typename)
forall (ctx :: TMap Symbol [EthRepr]) (typename :: Symbol).
HList (EthValue ctx) (Lookup typename ctx)
-&gt; EthValue ctx ('EthReprStruct typename)
</span><a href="Data.SignTyped.Structure.html#EthValueStruct"><span class="hs-identifier hs-var">EthValueStruct</span></a></span><span> </span><span class="annot"><span class="annottext">HList (EthValue ctx) (Lookup typename ctx)
</span><a href="#local-6989586621679218924"><span class="hs-identifier hs-var">embeddedMembers</span></a></span><span>
</span><span id="line-505"></span><span>            </span><span class="annot"><span class="annottext">EthType rep
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-506"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; Embed ctx (EthValue ctx rep)
forall a. String -&gt; Embed ctx a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Embed ctx (EthValue ctx rep))
-&gt; String -&gt; Embed ctx (EthValue ctx rep)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid eth type, expected &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SName structName -&gt; Text
forall (sym :: Symbol). SName sym -&gt; Text
</span><a href="Data.SignTyped.Type.SName.html#fromSName"><span class="hs-identifier hs-var">fromSName</span></a></span><span> </span><span class="annot"><span class="annottext">SName structName
</span><a href="#local-6989586621679218906"><span class="hs-identifier hs-var">structSName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-507"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-508"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-509"></span><span>    </span><span id="local-6989586621679218937"><span class="annot"><span class="annottext">ourStructDefinition :: Some (HList MemberDef)
</span><a href="#local-6989586621679218937"><span class="hs-identifier hs-var hs-var">ourStructDefinition</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-510"></span><span>        </span><span class="annot"><span class="annottext">[Some MemberDef] -&gt; Some (HList MemberDef)
forall {k} (f :: k -&gt; *). [Some f] -&gt; Some (HList f)
</span><a href="Data.SignTyped.Type.HList.html#hsequenceSome"><span class="hs-identifier hs-var">hsequenceSome</span></a></span><span> </span><span class="annot"><span class="annottext">([Some MemberDef] -&gt; Some (HList MemberDef))
-&gt; [Some MemberDef] -&gt; Some (HList MemberDef)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-511"></span><span>        </span><span class="annot"><span class="annottext">(SignableStructMemberHandle s -&gt; Some MemberDef)
-&gt; [SignableStructMemberHandle s] -&gt; [Some MemberDef]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span>
</span><span id="line-512"></span><span>            </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Class.html#SignableStructMemberHandle"><span class="hs-identifier hs-type">SignableStructMemberHandle</span></a></span><span> </span><span id="local-6989586621679218940"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679218940"><span class="hs-identifier hs-var">memberName</span></a></span></span><span> </span><span class="annot"><span class="annottext">s -&gt; a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679218941"><span class="annot"><span class="annottext">SignableValueHandle a
</span><a href="#local-6989586621679218941"><span class="hs-identifier hs-var">memberValueHandle</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-513"></span><span>                </span><span class="annot"><span class="annottext">Some EthType
-&gt; (forall {t :: EthRepr}. EthType t -&gt; Some MemberDef)
-&gt; Some MemberDef
forall {k} (f :: k -&gt; *) r.
Some f -&gt; (forall (t :: k). f t -&gt; r) -&gt; r
</span><a href="Data.SignTyped.Type.Some.html#withSome"><span class="hs-identifier hs-var">withSome</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SignableValueHandle a -&gt; Some EthType
forall a. SignableValueHandle a -&gt; Some EthType
</span><a href="Data.SignTyped.Class.html#signableValueEthType"><span class="hs-identifier hs-var">signableValueEthType</span></a></span><span> </span><span class="annot"><span class="annottext">SignableValueHandle a
</span><a href="#local-6989586621679218941"><span class="hs-identifier hs-var">memberValueHandle</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((forall {t :: EthRepr}. EthType t -&gt; Some MemberDef)
 -&gt; Some MemberDef)
-&gt; (forall {t :: EthRepr}. EthType t -&gt; Some MemberDef)
-&gt; Some MemberDef
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679218942"><span class="annot"><span class="annottext">EthType t
</span><a href="#local-6989586621679218942"><span class="hs-identifier hs-var">memberEthType</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-514"></span><span>                    </span><span class="annot"><span class="annottext">MemberDef t -&gt; Some MemberDef
forall {k} (f :: k -&gt; *) (t :: k). f t -&gt; Some f
</span><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-var">Some</span></a></span><span> </span><span class="annot"><span class="annottext">(MemberDef t -&gt; Some MemberDef) -&gt; MemberDef t -&gt; Some MemberDef
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">EthType t -&gt; Text -&gt; MemberDef t
forall (rep :: EthRepr). EthType rep -&gt; Text -&gt; MemberDef rep
</span><a href="Data.SignTyped.Structure.html#MemberDef"><span class="hs-identifier hs-var">MemberDef</span></a></span><span> </span><span class="annot"><span class="annottext">EthType t
</span><a href="#local-6989586621679218942"><span class="hs-identifier hs-var">memberEthType</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679218940"><span class="hs-identifier hs-var">memberName</span></a></span><span>
</span><span id="line-515"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-516"></span><span>            </span><span class="annot"><span class="annottext">[SignableStructMemberHandle s]
</span><a href="#local-6989586621679218907"><span class="hs-identifier hs-var">structMembers</span></a></span><span>
</span><span id="line-517"></span><span>    </span><span id="local-6989586621679218909"><span class="annot"><span class="annottext">ourTypeContextBuilder :: TypeContextBuilder
</span><a href="#local-6989586621679218909"><span class="hs-identifier hs-var hs-var">ourTypeContextBuilder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-518"></span><span>        </span><span class="annot"><span class="annottext">Some SName
-&gt; Some (HList MemberDef)
-&gt; [TypeContextBuilder]
-&gt; TypeContextBuilder
</span><a href="Data.SignTyped.Class.html#TypeContextBuilder"><span class="hs-identifier hs-var">TypeContextBuilder</span></a></span><span>
</span><span id="line-519"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SName structName -&gt; Some SName
forall {k} (f :: k -&gt; *) (t :: k). f t -&gt; Some f
</span><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-var">Some</span></a></span><span> </span><span class="annot"><span class="annottext">SName structName
</span><a href="#local-6989586621679218906"><span class="hs-identifier hs-var">structSName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-520"></span><span>            </span><span class="annot"><span class="annottext">Some (HList MemberDef)
</span><a href="#local-6989586621679218937"><span class="hs-identifier hs-var">ourStructDefinition</span></a></span><span>
</span><span id="line-521"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(SignableStructMemberHandle s -&gt; Maybe TypeContextBuilder)
-&gt; [SignableStructMemberHandle s] -&gt; [TypeContextBuilder]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span>
</span><span id="line-522"></span><span>                </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Class.html#SignableStructMemberHandle"><span class="hs-identifier hs-type">SignableStructMemberHandle</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">s -&gt; a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679218945"><span class="annot"><span class="annottext">SignableValueHandle a
</span><a href="#local-6989586621679218945"><span class="hs-identifier hs-var">memberValueHandle</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-523"></span><span>                    </span><span class="annot"><span class="annottext">SignableValueHandle a -&gt; Maybe TypeContextBuilder
forall a. SignableValueHandle a -&gt; Maybe TypeContextBuilder
</span><a href="Data.SignTyped.Class.html#signableValueTypeContextBuilder"><span class="hs-identifier hs-var">signableValueTypeContextBuilder</span></a></span><span> </span><span class="annot"><span class="annottext">SignableValueHandle a
</span><a href="#local-6989586621679218945"><span class="hs-identifier hs-var">memberValueHandle</span></a></span><span>
</span><span id="line-524"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-525"></span><span>                </span><span class="annot"><span class="annottext">[SignableStructMemberHandle s]
</span><a href="#local-6989586621679218907"><span class="hs-identifier hs-var">structMembers</span></a></span><span>
</span><span id="line-526"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-527"></span><span>    </span><span class="annot"><a href="#local-6989586621679218932"><span class="hs-identifier hs-type">ourMemberEmbedderMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Class.html#StructMemberEmbedder"><span class="hs-identifier hs-type">StructMemberEmbedder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218260"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-528"></span><span>    </span><span id="local-6989586621679218932"><span class="annot"><span class="annottext">ourMemberEmbedderMap :: Map Text (StructMemberEmbedder s)
</span><a href="#local-6989586621679218932"><span class="hs-identifier hs-var hs-var">ourMemberEmbedderMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-529"></span><span>        </span><span class="annot"><span class="annottext">(Text
 -&gt; StructMemberEmbedder s
 -&gt; StructMemberEmbedder s
 -&gt; StructMemberEmbedder s)
-&gt; [(Text, StructMemberEmbedder s)]
-&gt; Map Text (StructMemberEmbedder s)
forall k a. Ord k =&gt; (k -&gt; a -&gt; a -&gt; a) -&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromListWithKey</span></span><span> </span><span class="annot"><span class="annottext">Text
-&gt; StructMemberEmbedder s
-&gt; StructMemberEmbedder s
-&gt; StructMemberEmbedder s
forall a. Text -&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621679218947"><span class="hs-identifier hs-var">errOnDuplicate</span></a></span><span> </span><span class="annot"><span class="annottext">([(Text, StructMemberEmbedder s)]
 -&gt; Map Text (StructMemberEmbedder s))
-&gt; [(Text, StructMemberEmbedder s)]
-&gt; Map Text (StructMemberEmbedder s)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-530"></span><span>        </span><span class="annot"><span class="annottext">(SignableStructMemberHandle s -&gt; (Text, StructMemberEmbedder s))
-&gt; [SignableStructMemberHandle s]
-&gt; [(Text, StructMemberEmbedder s)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">SignableStructMemberHandle s -&gt; (Text, StructMemberEmbedder s)
</span><a href="#local-6989586621679218948"><span class="hs-identifier hs-var">makeMemberEmbedder</span></a></span><span> </span><span class="annot"><span class="annottext">([SignableStructMemberHandle s]
 -&gt; [(Text, StructMemberEmbedder s)])
-&gt; [SignableStructMemberHandle s]
-&gt; [(Text, StructMemberEmbedder s)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-531"></span><span>        </span><span class="annot"><span class="annottext">[SignableStructMemberHandle s]
</span><a href="#local-6989586621679218907"><span class="hs-identifier hs-var">structMembers</span></a></span><span>
</span><span id="line-532"></span><span>    </span><span id="local-6989586621679218400"><span class="annot"><a href="#local-6989586621679218947"><span class="hs-identifier hs-type">errOnDuplicate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679218400"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679218400"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679218400"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-533"></span><span>    </span><span id="local-6989586621679218947"><span class="annot"><span class="annottext">errOnDuplicate :: forall a. Text -&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621679218947"><span class="hs-identifier hs-var hs-var">errOnDuplicate</span></a></span></span><span> </span><span id="local-6989586621679218955"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679218955"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-534"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; a
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; a) -&gt; String -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Duplicate struct member &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679218955"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-535"></span><span>    </span><span class="annot"><a href="#local-6989586621679218948"><span class="hs-identifier hs-type">makeMemberEmbedder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableStructMemberHandle"><span class="hs-identifier hs-type">SignableStructMemberHandle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218260"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text.Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#StructMemberEmbedder"><span class="hs-identifier hs-type">StructMemberEmbedder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218260"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-536"></span><span>    </span><span id="local-6989586621679218948"><span class="annot"><span class="annottext">makeMemberEmbedder :: SignableStructMemberHandle s -&gt; (Text, StructMemberEmbedder s)
</span><a href="#local-6989586621679218948"><span class="hs-identifier hs-var hs-var">makeMemberEmbedder</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Class.html#SignableStructMemberHandle"><span class="hs-identifier hs-type">SignableStructMemberHandle</span></a></span><span> </span><span id="local-6989586621679218957"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679218957"><span class="hs-identifier hs-var">memberName</span></a></span></span><span> </span><span id="local-6989586621679218958"><span class="annot"><span class="annottext">s -&gt; a
</span><a href="#local-6989586621679218958"><span class="hs-identifier hs-var">memberAccessor</span></a></span></span><span> </span><span id="local-6989586621679218959"><span class="annot"><span class="annottext">SignableValueHandle a
</span><a href="#local-6989586621679218959"><span class="hs-identifier hs-var">memberValueHandle</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-537"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679218960"><span class="annot"><span class="annottext">memberEmbedder :: StructMemberEmbedder s
</span><a href="#local-6989586621679218960"><span class="hs-identifier hs-var hs-var">memberEmbedder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-538"></span><span>                </span><span class="annot"><span class="annottext">(forall (ctx :: TMap Symbol [EthRepr]) (rep :: EthRepr).
 EthType rep -&gt; s -&gt; Embed ctx (EthValue ctx rep))
-&gt; StructMemberEmbedder s
forall s.
(forall (ctx :: TMap Symbol [EthRepr]) (rep :: EthRepr).
 EthType rep -&gt; s -&gt; Embed ctx (EthValue ctx rep))
-&gt; StructMemberEmbedder s
</span><a href="Data.SignTyped.Class.html#StructMemberEmbedder"><span class="hs-identifier hs-var">StructMemberEmbedder</span></a></span><span> </span><span class="annot"><span class="annottext">((forall (ctx :: TMap Symbol [EthRepr]) (rep :: EthRepr).
  EthType rep -&gt; s -&gt; Embed ctx (EthValue ctx rep))
 -&gt; StructMemberEmbedder s)
-&gt; (forall (ctx :: TMap Symbol [EthRepr]) (rep :: EthRepr).
    EthType rep -&gt; s -&gt; Embed ctx (EthValue ctx rep))
-&gt; StructMemberEmbedder s
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679218962"><span class="annot"><span class="annottext">EthType rep
</span><a href="#local-6989586621679218962"><span class="hs-identifier hs-var">givenEthType</span></a></span></span><span> </span><span id="local-6989586621679218963"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679218963"><span class="hs-identifier hs-var">structInstance</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-539"></span><span>                    </span><span class="annot"><span class="annottext">SignableValueHandle a
-&gt; forall (ctx :: TMap Symbol [EthRepr]) (rep :: EthRepr).
   EthType rep -&gt; a -&gt; Embed ctx (EthValue ctx rep)
forall a.
SignableValueHandle a
-&gt; forall (ctx :: TMap Symbol [EthRepr]) (rep :: EthRepr).
   EthType rep -&gt; a -&gt; Embed ctx (EthValue ctx rep)
</span><a href="Data.SignTyped.Class.html#signableValueEmbed"><span class="hs-identifier hs-var">signableValueEmbed</span></a></span><span>
</span><span id="line-540"></span><span>                        </span><span class="annot"><span class="annottext">SignableValueHandle a
</span><a href="#local-6989586621679218959"><span class="hs-identifier hs-var">memberValueHandle</span></a></span><span>
</span><span id="line-541"></span><span>                        </span><span class="annot"><span class="annottext">EthType rep
</span><a href="#local-6989586621679218962"><span class="hs-identifier hs-var">givenEthType</span></a></span><span>
</span><span id="line-542"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s -&gt; a
</span><a href="#local-6989586621679218958"><span class="hs-identifier hs-var">memberAccessor</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679218963"><span class="hs-identifier hs-var">structInstance</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-543"></span><span>        </span><span class="hs-keyword">in</span><span>
</span><span id="line-544"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679218957"><span class="hs-identifier hs-var">memberName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StructMemberEmbedder s
</span><a href="#local-6989586621679218960"><span class="hs-identifier hs-var">memberEmbedder</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-545"></span><span>
</span><span id="line-546"></span><span class="annot"><span class="hs-comment">{-| A handle for a specific field of a struct, to be used in `structValueHandle`. -}</span></span><span>
</span><span id="line-547"></span><span class="hs-keyword">data</span><span> </span><span id="SignableStructMemberHandle"><span class="annot"><a href="Data.SignTyped.Class.html#SignableStructMemberHandle"><span class="hs-identifier hs-var">SignableStructMemberHandle</span></a></span></span><span> </span><span id="local-6989586621679218612"><span class="annot"><a href="#local-6989586621679218612"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-548"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679218964"><span class="annot"><a href="#local-6989586621679218964"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-549"></span><span>    </span><span id="SignableStructMemberHandle"><span class="annot"><a href="Data.SignTyped.Class.html#SignableStructMemberHandle"><span class="hs-identifier hs-var">SignableStructMemberHandle</span></a></span></span><span>
</span><span id="line-550"></span><span>        </span><span class="annot"><span class="hs-comment">{-| The name of the field in Solidity. -}</span></span><span>
</span><span id="line-551"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Text.Text</span></span><span>
</span><span id="line-552"></span><span>        </span><span class="annot"><span class="hs-comment">{-| The accessor function (selector) of the field. -}</span></span><span>
</span><span id="line-553"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679218612"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679218964"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-554"></span><span>        </span><span class="annot"><span class="hs-comment">{-| The encoding handle for the Haskell type of the field. -}</span></span><span>
</span><span id="line-555"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueHandle"><span class="hs-identifier hs-type">SignableValueHandle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218964"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-556"></span><span>
</span><span id="line-557"></span><span class="hs-keyword">newtype</span><span> </span><span id="StructMemberEmbedder"><span class="annot"><a href="Data.SignTyped.Class.html#StructMemberEmbedder"><span class="hs-identifier hs-var">StructMemberEmbedder</span></a></span></span><span> </span><span id="local-6989586621679218381"><span class="annot"><a href="#local-6989586621679218381"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="StructMemberEmbedder"><span class="annot"><a href="Data.SignTyped.Class.html#StructMemberEmbedder"><span class="hs-identifier hs-var">StructMemberEmbedder</span></a></span></span><span>
</span><span id="line-558"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="runStructMemberEmbedder"><span class="annot"><span class="annottext">forall s.
StructMemberEmbedder s
-&gt; forall (ctx :: TMap Symbol [EthRepr]) (rep :: EthRepr).
   EthType rep -&gt; s -&gt; Embed ctx (EthValue ctx rep)
</span><a href="Data.SignTyped.Class.html#runStructMemberEmbedder"><span class="hs-identifier hs-var hs-var">runStructMemberEmbedder</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-559"></span><span>        </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679218383"><span class="annot"><a href="#local-6989586621679218383"><span class="hs-identifier hs-type">ctx</span></a></span></span><span> </span><span id="local-6989586621679218382"><span class="annot"><a href="#local-6989586621679218382"><span class="hs-identifier hs-type">rep</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-560"></span><span>        </span><span class="annot"><a href="Data.SignTyped.Structure.html#EthType"><span class="hs-identifier hs-type">EthType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218382"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-561"></span><span>        </span><span class="annot"><a href="#local-6989586621679218381"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-562"></span><span>        </span><span class="annot"><a href="Data.SignTyped.Class.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218383"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Structure.html#EthValue"><span class="hs-identifier hs-type">EthValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218383"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218382"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-563"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-564"></span><span>
</span><span id="line-565"></span><span>
</span><span id="line-566"></span><span>
</span><span id="line-567"></span><span class="annot"><span class="hs-comment">{-| The handle that defines how a given Haskell value shall be encoded into a Solidity-compatible representation.

    Normally, you should use one of the pre-defined handle factories, and possibly `contramap` or
`contramapSignableEither` them onto your type.

    `EthType` is a declaration of the Solidity type. Atomic types are declared completely, while struct types are
declared only by a reference into a &quot;type context&quot;. This allows multiple struct types to recursively refer to each
other, a feature that's explicitly supported by EIP-712.

    The encoding is done in two phases:

        * Firstly, we collect all struct definitions that are used in the root value to create the `TypeContext`.

        * Then, we actually traverse the given object, while resolving the struct-referencing `EthType`s with
    the constructed `TypeContext`.

    When building the type context, recursive struct definitions can lead to a value recursion in Haskell. For this
reason, the primary source for a single handle is a value of `TypeContextBuilder`, which is a single struct definition
followed by a list of its dependencies. When traversing the `TypeContextBuilder`s, we can detect this kind of recursion
by an explicit check and thus avoid getting stuck in an infinite loop when constructing the singular
`TypeContext` object.

    The Solidity value representation uses quite a bit of type magic to ensure consistency, but it's still not enough
to prove that a struct within a `TypeContext` will exactly match the `TypeContextBuilder` that it came from.
For this reason, `signableValueEmbed` takes a separate `EthType`, which may be different from the one given in
`signableValueEthType`, and is allowed to report a mismatch between the Haskell type and the Solidity representation
though the `MonadFail` instance of the `Embed` monad. -}</span></span><span>
</span><span id="line-594"></span><span class="hs-keyword">data</span><span> </span><span id="SignableValueHandle"><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueHandle"><span class="hs-identifier hs-var">SignableValueHandle</span></a></span></span><span> </span><span id="local-6989586621679218205"><span class="annot"><a href="#local-6989586621679218205"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-595"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="SignableValueHandle"><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueHandle"><span class="hs-identifier hs-var">SignableValueHandle</span></a></span></span><span>
</span><span id="line-596"></span><span>        </span><span class="annot"><span class="hs-comment">{-| The Solidity type that the values of this Haskell type /should/ be mapped to. -}</span></span><span>
</span><span id="line-597"></span><span>        </span><span class="hs-special">{</span><span> </span><span id="signableValueEthType"><span class="annot"><span class="annottext">forall a. SignableValueHandle a -&gt; Some EthType
</span><a href="Data.SignTyped.Class.html#signableValueEthType"><span class="hs-identifier hs-var hs-var">signableValueEthType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-598"></span><span>            </span><span class="annot"><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="annot"><a href="Data.SignTyped.Structure.html#EthType"><span class="hs-identifier hs-type">EthType</span></a></span><span>
</span><span id="line-599"></span><span>        </span><span class="annot"><span class="hs-comment">{-| A &quot;builder&quot; for the type context. If this handle corresponds to a struct, this will be `Just` the
        definition of this struct and a list of its members' dependencies. Otherwise, this will be `Nothing`. -}</span></span><span>
</span><span id="line-601"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="signableValueTypeContextBuilder"><span class="annot"><span class="annottext">forall a. SignableValueHandle a -&gt; Maybe TypeContextBuilder
</span><a href="Data.SignTyped.Class.html#signableValueTypeContextBuilder"><span class="hs-identifier hs-var hs-var">signableValueTypeContextBuilder</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-602"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#TypeContextBuilder"><span class="hs-identifier hs-type">TypeContextBuilder</span></a></span><span>
</span><span id="line-603"></span><span>        </span><span class="annot"><span class="hs-comment">{-| The cached result of calling `executeTypeContextBuilder` on this handle's builder. -}</span></span><span>
</span><span id="line-604"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="signableValueTypeContext"><span class="annot"><span class="annottext">forall a. SignableValueHandle a -&gt; Some TypeContext
</span><a href="Data.SignTyped.Class.html#signableValueTypeContext"><span class="hs-identifier hs-var hs-var">signableValueTypeContext</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-605"></span><span>            </span><span class="annot"><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="annot"><a href="Data.SignTyped.Structure.html#TypeContext"><span class="hs-identifier hs-type">TypeContext</span></a></span><span>
</span><span id="line-606"></span><span>        </span><span class="annot"><span class="hs-comment">{-| The encoder function. It's given a `TypeContext` as part of the `Embed` monad, an `EthType` and a Haskell
        value, and should either encode the given value according to the given `EthType`, or report a failure
        through the monad. -}</span></span><span>
</span><span id="line-609"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="signableValueEmbed"><span class="annot"><span class="annottext">forall a.
SignableValueHandle a
-&gt; forall (ctx :: TMap Symbol [EthRepr]) (rep :: EthRepr).
   EthType rep -&gt; a -&gt; Embed ctx (EthValue ctx rep)
</span><a href="Data.SignTyped.Class.html#signableValueEmbed"><span class="hs-identifier hs-var hs-var">signableValueEmbed</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-610"></span><span>            </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679218220"><span class="annot"><a href="#local-6989586621679218220"><span class="hs-identifier hs-type">ctx</span></a></span></span><span> </span><span id="local-6989586621679218219"><span class="annot"><a href="#local-6989586621679218219"><span class="hs-identifier hs-type">rep</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Data.SignTyped.Structure.html#EthType"><span class="hs-identifier hs-type">EthType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218219"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679218205"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218220"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Structure.html#EthValue"><span class="hs-identifier hs-type">EthValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218220"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218219"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-611"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-612"></span><span>
</span><span id="line-613"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679218969"><span class="annot"><span class="hs-identifier hs-type">Contravariant</span></span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueHandle"><span class="hs-identifier hs-type">SignableValueHandle</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-614"></span><span>    </span><span id="local-6989586621679218973"><span class="annot"><span class="annottext">contramap :: forall a' a.
(a' -&gt; a) -&gt; SignableValueHandle a -&gt; SignableValueHandle a'
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">contramap</span></span></span><span> </span><span id="local-6989586621679218974"><span class="annot"><span class="annottext">a' -&gt; a
</span><a href="#local-6989586621679218974"><span class="hs-identifier hs-var">into</span></a></span></span><span> </span><span id="local-6989586621679218975"><span class="annot"><span class="annottext">SignableValueHandle a
</span><a href="#local-6989586621679218975"><span class="hs-identifier hs-var">handle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-615"></span><span>        </span><span class="annot"><span class="annottext">SignableValueHandle a
</span><a href="#local-6989586621679218975"><span class="hs-identifier hs-var">handle</span></a></span><span>
</span><span id="line-616"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">signableValueEmbed :: forall (ctx :: TMap Symbol [EthRepr]) (rep :: EthRepr).
EthType rep -&gt; a' -&gt; Embed ctx (EthValue ctx rep)
</span><a href="Data.SignTyped.Class.html#signableValueEmbed"><span class="hs-identifier hs-var">signableValueEmbed</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679218976"><span class="annot"><span class="annottext">EthType rep
</span><a href="#local-6989586621679218976"><span class="hs-identifier hs-var">givenEthType</span></a></span></span><span> </span><span id="local-6989586621679218977"><span class="annot"><span class="annottext">a'
</span><a href="#local-6989586621679218977"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-617"></span><span>                </span><span class="annot"><span class="annottext">SignableValueHandle a
-&gt; forall (ctx :: TMap Symbol [EthRepr]) (rep :: EthRepr).
   EthType rep -&gt; a -&gt; Embed ctx (EthValue ctx rep)
forall a.
SignableValueHandle a
-&gt; forall (ctx :: TMap Symbol [EthRepr]) (rep :: EthRepr).
   EthType rep -&gt; a -&gt; Embed ctx (EthValue ctx rep)
</span><a href="Data.SignTyped.Class.html#signableValueEmbed"><span class="hs-identifier hs-var">signableValueEmbed</span></a></span><span> </span><span class="annot"><span class="annottext">SignableValueHandle a
</span><a href="#local-6989586621679218975"><span class="hs-identifier hs-var">handle</span></a></span><span> </span><span class="annot"><span class="annottext">EthType rep
</span><a href="#local-6989586621679218976"><span class="hs-identifier hs-var">givenEthType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a' -&gt; a
</span><a href="#local-6989586621679218974"><span class="hs-identifier hs-var">into</span></a></span><span> </span><span class="annot"><span class="annottext">a'
</span><a href="#local-6989586621679218977"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-618"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-619"></span><span>
</span><span id="line-620"></span><span class="annot"><span class="hs-comment">{-| A generalization of @`contramap` \@SignableValueHandle@ that allows you to perform run-time checks and
fail gracefully by returning a `Left`. An error produced in this way will be annotated with a JSONPath-like location
in the object where it happened.

    If the conversion is total, you can use `contramap` instead. -}</span></span><span>
</span><span id="line-625"></span><span id="local-6989586621679218426"><span id="local-6989586621679218427"><span class="annot"><a href="Data.SignTyped.Class.html#contramapSignableEither"><span class="hs-identifier hs-type">contramapSignableEither</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-626"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679218426"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679218427"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-627"></span><span>    </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueHandle"><span class="hs-identifier hs-type">SignableValueHandle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218427"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-628"></span><span>    </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueHandle"><span class="hs-identifier hs-type">SignableValueHandle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218426"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-629"></span><span id="contramapSignableEither"><span class="annot"><span class="annottext">contramapSignableEither :: forall a b.
(a -&gt; Either String b)
-&gt; SignableValueHandle b -&gt; SignableValueHandle a
</span><a href="Data.SignTyped.Class.html#contramapSignableEither"><span class="hs-identifier hs-var hs-var">contramapSignableEither</span></a></span></span><span> </span><span id="local-6989586621679218978"><span class="annot"><span class="annottext">a -&gt; Either String b
</span><a href="#local-6989586621679218978"><span class="hs-identifier hs-var">intoEither</span></a></span></span><span> </span><span id="local-6989586621679218979"><span class="annot"><span class="annottext">SignableValueHandle b
</span><a href="#local-6989586621679218979"><span class="hs-identifier hs-var">handle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-630"></span><span>    </span><span class="annot"><span class="annottext">SignableValueHandle b
</span><a href="#local-6989586621679218979"><span class="hs-identifier hs-var">handle</span></a></span><span>
</span><span id="line-631"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">signableValueEmbed :: forall (ctx :: TMap Symbol [EthRepr]) (rep :: EthRepr).
EthType rep -&gt; a -&gt; Embed ctx (EthValue ctx rep)
</span><a href="Data.SignTyped.Class.html#signableValueEmbed"><span class="hs-identifier hs-var">signableValueEmbed</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679218981"><span class="annot"><span class="annottext">EthType rep
</span><a href="#local-6989586621679218981"><span class="hs-identifier hs-var">givenEthType</span></a></span></span><span> </span><span id="local-6989586621679218982"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679218982"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-632"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a -&gt; Either String b
</span><a href="#local-6989586621679218978"><span class="hs-identifier hs-var">intoEither</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679218982"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-633"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679218983"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679218983"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Embed ctx (EthValue ctx rep)
forall a. String -&gt; Embed ctx a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679218983"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-634"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679218984"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679218984"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SignableValueHandle b
-&gt; forall (ctx :: TMap Symbol [EthRepr]) (rep :: EthRepr).
   EthType rep -&gt; b -&gt; Embed ctx (EthValue ctx rep)
forall a.
SignableValueHandle a
-&gt; forall (ctx :: TMap Symbol [EthRepr]) (rep :: EthRepr).
   EthType rep -&gt; a -&gt; Embed ctx (EthValue ctx rep)
</span><a href="Data.SignTyped.Class.html#signableValueEmbed"><span class="hs-identifier hs-var">signableValueEmbed</span></a></span><span> </span><span class="annot"><span class="annottext">SignableValueHandle b
</span><a href="#local-6989586621679218979"><span class="hs-identifier hs-var">handle</span></a></span><span> </span><span class="annot"><span class="annottext">EthType rep
</span><a href="#local-6989586621679218981"><span class="hs-identifier hs-var">givenEthType</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679218984"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-635"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-636"></span><span>
</span><span id="line-637"></span><span class="annot"><span class="hs-comment">{-| A builder of a `TypeContext`. This structure is specifically designed to allow value recursion, so that
a definition like this would be legal:

    @
        data FoobarTree = FoobarTree
            { stData :: Foobar
            , stChildren :: [FoobarTree]
            }

        foobarTreeTCB :: TypeContextBuilder
        foobarTreeTCB =
            TypeContextBuilder
                (Some $ SName \@\&quot;FoobarTree\&quot;)
                (Some $
                    MemberDef
                        (EthTypeStruct (SName \@\&quot;Foobar\&quot;))
                        &quot;data&quot;
                  :/
                    MemberDef
                        (EthTypeArray (EthTypeStruct (SName \@\&quot;FoobarTree\&quot;)) Nothing)
                        &quot;children&quot;
                  :/
                    HEnd
                )
                [ foobarTCB
                , foobarTreeTCB -- value recursion
                ]
    @ -}</span></span><span>
</span><span id="line-665"></span><span class="hs-keyword">data</span><span> </span><span id="TypeContextBuilder"><span class="annot"><a href="Data.SignTyped.Class.html#TypeContextBuilder"><span class="hs-identifier hs-var">TypeContextBuilder</span></a></span></span><span>
</span><span id="line-666"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="TypeContextBuilder"><span class="annot"><a href="Data.SignTyped.Class.html#TypeContextBuilder"><span class="hs-identifier hs-var">TypeContextBuilder</span></a></span></span><span>
</span><span id="line-667"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="annot"><a href="Data.SignTyped.Type.SName.html#SName"><span class="hs-identifier hs-type">SName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-comment">{-^ This struct's Solidity name. -}</span></span><span>
</span><span id="line-668"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="annot"><a href="Data.SignTyped.Structure.html#StructDef"><span class="hs-identifier hs-type">StructDef</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-comment">{-^ This struct's Solidity definition. -}</span></span><span>
</span><span id="line-669"></span><span>        </span><span class="hs-special">[</span><span class="annot"><a href="Data.SignTyped.Class.html#TypeContextBuilder"><span class="hs-identifier hs-type">TypeContextBuilder</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-comment">{-^ This struct's members' dependencies. -}</span></span><span>
</span><span id="line-670"></span><span>
</span><span id="line-671"></span><span class="annot"><span class="hs-comment">{-| Fold a `TypeContextBuilder` into a `TypeContext`. -}</span></span><span>
</span><span id="line-672"></span><span class="annot"><a href="Data.SignTyped.Class.html#executeTypeContextBuilder"><span class="hs-identifier hs-type">executeTypeContextBuilder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#TypeContextBuilder"><span class="hs-identifier hs-type">TypeContextBuilder</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="annot"><a href="Data.SignTyped.Structure.html#TypeContext"><span class="hs-identifier hs-type">TypeContext</span></a></span><span>
</span><span id="line-673"></span><span id="executeTypeContextBuilder"><span class="annot"><span class="annottext">executeTypeContextBuilder :: TypeContextBuilder -&gt; Some TypeContext
</span><a href="Data.SignTyped.Class.html#executeTypeContextBuilder"><span class="hs-identifier hs-var hs-var">executeTypeContextBuilder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Some TypeContext -&gt; TypeContextBuilder -&gt; Some TypeContext
</span><a href="#local-6989586621679218985"><span class="hs-identifier hs-var">visit</span></a></span><span> </span><span class="annot"><span class="annottext">Some TypeContext
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-674"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-675"></span><span>    </span><span class="annot"><a href="#local-6989586621679218985"><span class="hs-identifier hs-type">visit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="annot"><a href="Data.SignTyped.Structure.html#TypeContext"><span class="hs-identifier hs-type">TypeContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#TypeContextBuilder"><span class="hs-identifier hs-type">TypeContextBuilder</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="annot"><a href="Data.SignTyped.Structure.html#TypeContext"><span class="hs-identifier hs-type">TypeContext</span></a></span><span>
</span><span id="line-676"></span><span>    </span><span id="local-6989586621679218985"><span class="annot"><span class="annottext">visit :: Some TypeContext -&gt; TypeContextBuilder -&gt; Some TypeContext
</span><a href="#local-6989586621679218985"><span class="hs-identifier hs-var hs-var">visit</span></a></span></span><span> </span><span id="local-6989586621679218986"><span class="annot"><span class="annottext">Some TypeContext
</span><a href="#local-6989586621679218986"><span class="hs-identifier hs-var">accum</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Class.html#TypeContextBuilder"><span class="hs-identifier hs-type">TypeContextBuilder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span id="local-6989586621679218987"><span class="annot"><span class="annottext">SName t
</span><a href="#local-6989586621679218987"><span class="hs-identifier hs-var">sname</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span id="local-6989586621679218991"><span class="annot"><span class="annottext">StructDef t
</span><a href="#local-6989586621679218991"><span class="hs-identifier hs-var">sdef</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679218992"><span class="annot"><span class="annottext">[TypeContextBuilder]
</span><a href="#local-6989586621679218992"><span class="hs-identifier hs-var">deps</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-677"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Some TypeContext -&gt; SName t -&gt; StructDef t -&gt; Bool
forall (typename :: Symbol) (reps :: [EthRepr]).
Some TypeContext -&gt; SName typename -&gt; StructDef reps -&gt; Bool
</span><a href="#local-6989586621679218993"><span class="hs-identifier hs-var">isDefinitionPresent</span></a></span><span> </span><span class="annot"><span class="annottext">Some TypeContext
</span><a href="#local-6989586621679218986"><span class="hs-identifier hs-var">accum</span></a></span><span> </span><span class="annot"><span class="annottext">SName t
</span><a href="#local-6989586621679218987"><span class="hs-identifier hs-var">sname</span></a></span><span> </span><span class="annot"><span class="annottext">StructDef t
</span><a href="#local-6989586621679218991"><span class="hs-identifier hs-var">sdef</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-678"></span><span>            </span><span class="annot"><span class="annottext">Some TypeContext
</span><a href="#local-6989586621679218986"><span class="hs-identifier hs-var">accum</span></a></span><span>
</span><span id="line-679"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-680"></span><span>            </span><span class="annot"><span class="annottext">(Some TypeContext -&gt; TypeContextBuilder -&gt; Some TypeContext)
-&gt; Some TypeContext -&gt; [TypeContextBuilder] -&gt; Some TypeContext
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span>
</span><span id="line-681"></span><span>                </span><span class="annot"><span class="annottext">Some TypeContext -&gt; TypeContextBuilder -&gt; Some TypeContext
</span><a href="#local-6989586621679218985"><span class="hs-identifier hs-var">visit</span></a></span><span>
</span><span id="line-682"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Some TypeContext
</span><a href="#local-6989586621679218986"><span class="hs-identifier hs-var">accum</span></a></span><span> </span><span class="annot"><span class="annottext">Some TypeContext -&gt; Some TypeContext -&gt; Some TypeContext
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">SName t -&gt; StructDef t -&gt; Some TypeContext
forall (typename :: Symbol) (reps :: [EthRepr]).
SName typename -&gt; StructDef reps -&gt; Some TypeContext
</span><a href="Data.SignTyped.Structure.html#singletonTypeContext"><span class="hs-identifier hs-var">singletonTypeContext</span></a></span><span> </span><span class="annot"><span class="annottext">SName t
</span><a href="#local-6989586621679218987"><span class="hs-identifier hs-var">sname</span></a></span><span> </span><span class="annot"><span class="annottext">StructDef t
</span><a href="#local-6989586621679218991"><span class="hs-identifier hs-var">sdef</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-683"></span><span>                </span><span class="annot"><span class="annottext">[TypeContextBuilder]
</span><a href="#local-6989586621679218992"><span class="hs-identifier hs-var">deps</span></a></span><span>
</span><span id="line-684"></span><span>    </span><span id="local-6989586621679218435"><span id="local-6989586621679218436"><span class="annot"><a href="#local-6989586621679218993"><span class="hs-identifier hs-type">isDefinitionPresent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="annot"><a href="Data.SignTyped.Structure.html#TypeContext"><span class="hs-identifier hs-type">TypeContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SignTyped.Type.SName.html#SName"><span class="hs-identifier hs-type">SName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218435"><span class="hs-identifier hs-type">typename</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SignTyped.Structure.html#StructDef"><span class="hs-identifier hs-type">StructDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218436"><span class="hs-identifier hs-type">reps</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-685"></span><span>    </span><span id="local-6989586621679218993"><span class="annot"><span class="annottext">isDefinitionPresent :: forall (typename :: Symbol) (reps :: [EthRepr]).
Some TypeContext -&gt; SName typename -&gt; StructDef reps -&gt; Bool
</span><a href="#local-6989586621679218993"><span class="hs-identifier hs-var hs-var">isDefinitionPresent</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span id="local-6989586621679219002"><span class="annot"><span class="annottext">TypeContext t
</span><a href="#local-6989586621679219002"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679219003"><span class="annot"><span class="annottext">SName typename
</span><a href="#local-6989586621679219003"><span class="hs-identifier hs-var">sname</span></a></span></span><span> </span><span id="local-6989586621679219004"><span class="annot"><span class="annottext">StructDef reps
</span><a href="#local-6989586621679219004"><span class="hs-identifier hs-var">sdef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-686"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SName typename
-&gt; HMap SName (HList MemberDef) t
-&gt; Maybe (StructDef (Lookup typename t))
forall {kk} {kv} (kf :: kk -&gt; *) (kt :: kk) (vf :: kv -&gt; *)
       (s :: TMap kk kv).
SingletonConstructor kf =&gt;
kf kt -&gt; HMap kf vf s -&gt; Maybe (vf (Lookup kt s))
</span><a href="Data.SignTyped.Type.HMap.html#lookupHMap"><span class="hs-identifier hs-var">lookupHMap</span></a></span><span> </span><span class="annot"><span class="annottext">SName typename
</span><a href="#local-6989586621679219003"><span class="hs-identifier hs-var">sname</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeContext t -&gt; HMap SName (HList MemberDef) t
forall (ctx :: TMap Symbol [EthRepr]).
TypeContext ctx -&gt; HMap SName (HList MemberDef) ctx
</span><a href="Data.SignTyped.Structure.html#typeContextMap"><span class="hs-identifier hs-var">typeContextMap</span></a></span><span> </span><span class="annot"><span class="annottext">TypeContext t
</span><a href="#local-6989586621679219002"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-687"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679219007"><span class="annot"><span class="annottext">StructDef (Lookup typename t)
</span><a href="#local-6989586621679219007"><span class="hs-identifier hs-var">oldSDef</span></a></span></span><span>
</span><span id="line-688"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Lookup typename t :~: reps
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StructDef (Lookup typename t)
-&gt; StructDef reps -&gt; Maybe (Lookup typename t :~: reps)
forall (a :: [EthRepr]) (b :: [EthRepr]).
StructDef a -&gt; StructDef b -&gt; Maybe (a :~: b)
forall {k} (f :: k -&gt; *) (a :: k) (b :: k).
TestEquality f =&gt;
f a -&gt; f b -&gt; Maybe (a :~: b)
</span><span class="hs-identifier hs-var">testEquality</span></span><span> </span><span class="annot"><span class="annottext">StructDef (Lookup typename t)
</span><a href="#local-6989586621679219007"><span class="hs-identifier hs-var">oldSDef</span></a></span><span> </span><span class="annot"><span class="annottext">StructDef reps
</span><a href="#local-6989586621679219004"><span class="hs-identifier hs-var">sdef</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-689"></span><span>                    </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-690"></span><span>            </span><span class="annot"><span class="annottext">Maybe (StructDef (Lookup typename t))
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-691"></span><span>
</span><span id="line-692"></span><span>
</span><span id="line-693"></span><span>
</span><span id="line-694"></span><span class="annot"><span class="hs-comment">{-| A monad that is used for the main phase of the value encoding. Its structure can be represented by this stack:

    @
        Embed ctx

      is-semantically-equivalent-to

        ReaderT (TypeContext ctx) -- The type context that all of the struct-referring `EthType`s point to
      .
        ReaderT String -- The current position in the value, for error messages
      .
        ExceptT String -- Type mismatch errors
    @ -}</span></span><span>
</span><span id="line-707"></span><span class="hs-keyword">newtype</span><span> </span><span id="Embed"><span class="annot"><a href="Data.SignTyped.Class.html#Embed"><span class="hs-identifier hs-var">Embed</span></a></span></span><span> </span><span id="local-6989586621679218461"><span class="annot"><a href="#local-6989586621679218461"><span class="hs-identifier hs-type">ctx</span></a></span></span><span> </span><span id="local-6989586621679218462"><span class="annot"><a href="#local-6989586621679218462"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Embed"><span class="annot"><a href="Data.SignTyped.Class.html#Embed"><span class="hs-identifier hs-var">Embed</span></a></span></span><span>
</span><span id="line-708"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="withEmbed"><span class="annot"><span class="annottext">forall (ctx :: TMap Symbol [EthRepr]) a.
Embed ctx a
-&gt; forall r.
   TypeContext ctx
   -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; (a -&gt; r) -&gt; r
</span><a href="Data.SignTyped.Class.html#withEmbed"><span class="hs-identifier hs-var hs-var">withEmbed</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-709"></span><span>        </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679218463"><span class="annot"><a href="#local-6989586621679218463"><span class="hs-identifier hs-type">r</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-710"></span><span>        </span><span class="annot"><a href="Data.SignTyped.Structure.html#TypeContext"><span class="hs-identifier hs-type">TypeContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218461"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-711"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">ShowS</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-712"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679218463"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-713"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679218462"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679218463"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-714"></span><span>        </span><span class="annot"><a href="#local-6989586621679218463"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-715"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-716"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679219012"><span id="local-6989586621679219014"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; Embed ctx a -&gt; Embed ctx b)
-&gt; (forall a b. a -&gt; Embed ctx b -&gt; Embed ctx a)
-&gt; Functor (Embed ctx)
forall a b. a -&gt; Embed ctx b -&gt; Embed ctx a
forall a b. (a -&gt; b) -&gt; Embed ctx a -&gt; Embed ctx b
forall (ctx :: TMap Symbol [EthRepr]) a b.
a -&gt; Embed ctx b -&gt; Embed ctx a
forall (ctx :: TMap Symbol [EthRepr]) a b.
(a -&gt; b) -&gt; Embed ctx a -&gt; Embed ctx b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall (ctx :: TMap Symbol [EthRepr]) a b.
(a -&gt; b) -&gt; Embed ctx a -&gt; Embed ctx b
fmap :: forall a b. (a -&gt; b) -&gt; Embed ctx a -&gt; Embed ctx b
$c&lt;$ :: forall (ctx :: TMap Symbol [EthRepr]) a b.
a -&gt; Embed ctx b -&gt; Embed ctx a
&lt;$ :: forall a b. a -&gt; Embed ctx b -&gt; Embed ctx a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-717"></span><span>
</span><span id="line-718"></span><span class="annot"><span class="hs-comment">{-| The driver of the `Embed` actions. -}</span></span><span>
</span><span id="line-719"></span><span id="local-6989586621679218216"><span id="local-6989586621679218217"><span class="annot"><a href="Data.SignTyped.Class.html#runEmbed"><span class="hs-identifier hs-type">runEmbed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SignTyped.Structure.html#TypeContext"><span class="hs-identifier hs-type">TypeContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218216"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218216"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218217"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679218217"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-720"></span><span id="runEmbed"><span class="annot"><span class="annottext">runEmbed :: forall (ctx :: TMap Symbol [EthRepr]) a.
TypeContext ctx -&gt; Embed ctx a -&gt; Either String a
</span><a href="Data.SignTyped.Class.html#runEmbed"><span class="hs-identifier hs-var hs-var">runEmbed</span></a></span></span><span> </span><span id="local-6989586621679219017"><span class="annot"><span class="annottext">TypeContext ctx
</span><a href="#local-6989586621679219017"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621679219018"><span class="annot"><span class="annottext">Embed ctx a
</span><a href="#local-6989586621679219018"><span class="hs-identifier hs-var">enc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Embed ctx a
-&gt; forall r.
   TypeContext ctx
   -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; (a -&gt; r) -&gt; r
forall (ctx :: TMap Symbol [EthRepr]) a.
Embed ctx a
-&gt; forall r.
   TypeContext ctx
   -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; (a -&gt; r) -&gt; r
</span><a href="Data.SignTyped.Class.html#withEmbed"><span class="hs-identifier hs-var">withEmbed</span></a></span><span> </span><span class="annot"><span class="annottext">Embed ctx a
</span><a href="#local-6989586621679219018"><span class="hs-identifier hs-var">enc</span></a></span><span> </span><span class="annot"><span class="annottext">TypeContext ctx
</span><a href="#local-6989586621679219017"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;$&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Either String a
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span>
</span><span id="line-721"></span><span>
</span><span id="line-722"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679218215"><span id="local-6989586621679219026"><span id="local-6989586621679219029"><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Class.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218215"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-723"></span><span>    </span><span id="local-6989586621679219032"><span class="annot"><span class="annottext">pure :: forall a. a -&gt; Embed ctx a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">pure</span></span></span><span> </span><span id="local-6989586621679219033"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679219033"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall r.
 TypeContext ctx
 -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; (a -&gt; r) -&gt; r)
-&gt; Embed ctx a
forall (ctx :: TMap Symbol [EthRepr]) a.
(forall r.
 TypeContext ctx
 -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; (a -&gt; r) -&gt; r)
-&gt; Embed ctx a
</span><a href="Data.SignTyped.Class.html#Embed"><span class="hs-identifier hs-var">Embed</span></a></span><span> </span><span class="annot"><span class="annottext">((forall r.
  TypeContext ctx
  -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; (a -&gt; r) -&gt; r)
 -&gt; Embed ctx a)
-&gt; (forall r.
    TypeContext ctx
    -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; (a -&gt; r) -&gt; r)
-&gt; Embed ctx a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">TypeContext ctx
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; r
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679219034"><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679219034"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679219034"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679219033"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-724"></span><span>    </span><span id="local-6989586621679219035"><span class="annot"><span class="annottext">Embed ctx (a -&gt; b)
</span><a href="#local-6989586621679219035"><span class="hs-identifier hs-var">mf</span></a></span></span><span> </span><span id="local-6989586621679219036"><span class="annot"><span class="annottext">&lt;*&gt; :: forall a b. Embed ctx (a -&gt; b) -&gt; Embed ctx a -&gt; Embed ctx b
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;*&gt;</span></span></span><span> </span><span id="local-6989586621679219037"><span class="annot"><span class="annottext">Embed ctx a
</span><a href="#local-6989586621679219037"><span class="hs-identifier hs-var">mx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall r.
 TypeContext ctx
 -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; (b -&gt; r) -&gt; r)
-&gt; Embed ctx b
forall (ctx :: TMap Symbol [EthRepr]) a.
(forall r.
 TypeContext ctx
 -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; (a -&gt; r) -&gt; r)
-&gt; Embed ctx a
</span><a href="Data.SignTyped.Class.html#Embed"><span class="hs-identifier hs-var">Embed</span></a></span><span> </span><span class="annot"><span class="annottext">((forall r.
  TypeContext ctx
  -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; (b -&gt; r) -&gt; r)
 -&gt; Embed ctx b)
-&gt; (forall r.
    TypeContext ctx
    -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; (b -&gt; r) -&gt; r)
-&gt; Embed ctx b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679219038"><span class="annot"><span class="annottext">TypeContext ctx
</span><a href="#local-6989586621679219038"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621679219039"><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679219039"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span id="local-6989586621679219040"><span class="annot"><span class="annottext">String -&gt; r
</span><a href="#local-6989586621679219040"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679219041"><span class="annot"><span class="annottext">b -&gt; r
</span><a href="#local-6989586621679219041"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-725"></span><span>        </span><span class="annot"><span class="annottext">Embed ctx (a -&gt; b)
-&gt; forall r.
   TypeContext ctx
   -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; ((a -&gt; b) -&gt; r) -&gt; r
forall (ctx :: TMap Symbol [EthRepr]) a.
Embed ctx a
-&gt; forall r.
   TypeContext ctx
   -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; (a -&gt; r) -&gt; r
</span><a href="Data.SignTyped.Class.html#withEmbed"><span class="hs-identifier hs-var">withEmbed</span></a></span><span> </span><span class="annot"><span class="annottext">Embed ctx (a -&gt; b)
</span><a href="#local-6989586621679219035"><span class="hs-identifier hs-var">mf</span></a></span><span> </span><span class="annot"><span class="annottext">TypeContext ctx
</span><a href="#local-6989586621679219038"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679219039"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; r
</span><a href="#local-6989586621679219040"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(((a -&gt; b) -&gt; r) -&gt; r) -&gt; ((a -&gt; b) -&gt; r) -&gt; r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679219042"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679219042"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-726"></span><span>            </span><span class="annot"><span class="annottext">Embed ctx a
-&gt; forall r.
   TypeContext ctx
   -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; (a -&gt; r) -&gt; r
forall (ctx :: TMap Symbol [EthRepr]) a.
Embed ctx a
-&gt; forall r.
   TypeContext ctx
   -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; (a -&gt; r) -&gt; r
</span><a href="Data.SignTyped.Class.html#withEmbed"><span class="hs-identifier hs-var">withEmbed</span></a></span><span> </span><span class="annot"><span class="annottext">Embed ctx a
</span><a href="#local-6989586621679219037"><span class="hs-identifier hs-var">mx</span></a></span><span> </span><span class="annot"><span class="annottext">TypeContext ctx
</span><a href="#local-6989586621679219038"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679219039"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; r
</span><a href="#local-6989586621679219040"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; r) -&gt; r) -&gt; (a -&gt; r) -&gt; r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679219043"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679219043"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-727"></span><span>                </span><span class="annot"><span class="annottext">b -&gt; r
</span><a href="#local-6989586621679219041"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679219042"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679219043"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-728"></span><span>    </span><span id="local-6989586621679219044"><span class="annot"><span class="annottext">liftA2 :: forall a b c.
(a -&gt; b -&gt; c) -&gt; Embed ctx a -&gt; Embed ctx b -&gt; Embed ctx c
</span><a href="#local-6989586621679219044"><span class="hs-identifier hs-var hs-var hs-var hs-var">liftA2</span></a></span></span><span> </span><span id="local-6989586621679219046"><span class="annot"><span class="annottext">a -&gt; b -&gt; c
</span><a href="#local-6989586621679219046"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679219047"><span class="annot"><span class="annottext">Embed ctx a
</span><a href="#local-6989586621679219047"><span class="hs-identifier hs-var">mx</span></a></span></span><span> </span><span id="local-6989586621679219048"><span class="annot"><span class="annottext">Embed ctx b
</span><a href="#local-6989586621679219048"><span class="hs-identifier hs-var">my</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall r.
 TypeContext ctx
 -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; (c -&gt; r) -&gt; r)
-&gt; Embed ctx c
forall (ctx :: TMap Symbol [EthRepr]) a.
(forall r.
 TypeContext ctx
 -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; (a -&gt; r) -&gt; r)
-&gt; Embed ctx a
</span><a href="Data.SignTyped.Class.html#Embed"><span class="hs-identifier hs-var">Embed</span></a></span><span> </span><span class="annot"><span class="annottext">((forall r.
  TypeContext ctx
  -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; (c -&gt; r) -&gt; r)
 -&gt; Embed ctx c)
-&gt; (forall r.
    TypeContext ctx
    -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; (c -&gt; r) -&gt; r)
-&gt; Embed ctx c
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679219049"><span class="annot"><span class="annottext">TypeContext ctx
</span><a href="#local-6989586621679219049"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621679219050"><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679219050"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span id="local-6989586621679219051"><span class="annot"><span class="annottext">String -&gt; r
</span><a href="#local-6989586621679219051"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679219052"><span class="annot"><span class="annottext">c -&gt; r
</span><a href="#local-6989586621679219052"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-729"></span><span>        </span><span class="annot"><span class="annottext">Embed ctx a
-&gt; forall r.
   TypeContext ctx
   -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; (a -&gt; r) -&gt; r
forall (ctx :: TMap Symbol [EthRepr]) a.
Embed ctx a
-&gt; forall r.
   TypeContext ctx
   -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; (a -&gt; r) -&gt; r
</span><a href="Data.SignTyped.Class.html#withEmbed"><span class="hs-identifier hs-var">withEmbed</span></a></span><span> </span><span class="annot"><span class="annottext">Embed ctx a
</span><a href="#local-6989586621679219047"><span class="hs-identifier hs-var">mx</span></a></span><span> </span><span class="annot"><span class="annottext">TypeContext ctx
</span><a href="#local-6989586621679219049"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679219050"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; r
</span><a href="#local-6989586621679219051"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; r) -&gt; r) -&gt; (a -&gt; r) -&gt; r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679219053"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679219053"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-730"></span><span>            </span><span class="annot"><span class="annottext">Embed ctx b
-&gt; forall r.
   TypeContext ctx
   -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; (b -&gt; r) -&gt; r
forall (ctx :: TMap Symbol [EthRepr]) a.
Embed ctx a
-&gt; forall r.
   TypeContext ctx
   -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; (a -&gt; r) -&gt; r
</span><a href="Data.SignTyped.Class.html#withEmbed"><span class="hs-identifier hs-var">withEmbed</span></a></span><span> </span><span class="annot"><span class="annottext">Embed ctx b
</span><a href="#local-6989586621679219048"><span class="hs-identifier hs-var">my</span></a></span><span> </span><span class="annot"><span class="annottext">TypeContext ctx
</span><a href="#local-6989586621679219049"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679219050"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; r
</span><a href="#local-6989586621679219051"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">((b -&gt; r) -&gt; r) -&gt; (b -&gt; r) -&gt; r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679219054"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679219054"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-731"></span><span>                </span><span class="annot"><span class="annottext">c -&gt; r
</span><a href="#local-6989586621679219052"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b -&gt; c
</span><a href="#local-6989586621679219046"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679219053"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679219054"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-732"></span><span>
</span><span id="line-733"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679218214"><span id="local-6989586621679219059"><span id="local-6989586621679219062"><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Class.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218214"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-734"></span><span>    </span><span id="local-6989586621679219065"><span class="annot"><span class="annottext">Embed ctx a
</span><a href="#local-6989586621679219065"><span class="hs-identifier hs-var">mx</span></a></span></span><span> </span><span id="local-6989586621679219066"><span class="annot"><span class="annottext">&gt;&gt;= :: forall a b. Embed ctx a -&gt; (a -&gt; Embed ctx b) -&gt; Embed ctx b
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&gt;&gt;=</span></span></span><span> </span><span id="local-6989586621679219067"><span class="annot"><span class="annottext">a -&gt; Embed ctx b
</span><a href="#local-6989586621679219067"><span class="hs-identifier hs-var">sel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall r.
 TypeContext ctx
 -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; (b -&gt; r) -&gt; r)
-&gt; Embed ctx b
forall (ctx :: TMap Symbol [EthRepr]) a.
(forall r.
 TypeContext ctx
 -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; (a -&gt; r) -&gt; r)
-&gt; Embed ctx a
</span><a href="Data.SignTyped.Class.html#Embed"><span class="hs-identifier hs-var">Embed</span></a></span><span> </span><span class="annot"><span class="annottext">((forall r.
  TypeContext ctx
  -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; (b -&gt; r) -&gt; r)
 -&gt; Embed ctx b)
-&gt; (forall r.
    TypeContext ctx
    -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; (b -&gt; r) -&gt; r)
-&gt; Embed ctx b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679219068"><span class="annot"><span class="annottext">TypeContext ctx
</span><a href="#local-6989586621679219068"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621679219069"><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679219069"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span id="local-6989586621679219070"><span class="annot"><span class="annottext">String -&gt; r
</span><a href="#local-6989586621679219070"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679219071"><span class="annot"><span class="annottext">b -&gt; r
</span><a href="#local-6989586621679219071"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-735"></span><span>        </span><span class="annot"><span class="annottext">Embed ctx a
-&gt; forall r.
   TypeContext ctx
   -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; (a -&gt; r) -&gt; r
forall (ctx :: TMap Symbol [EthRepr]) a.
Embed ctx a
-&gt; forall r.
   TypeContext ctx
   -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; (a -&gt; r) -&gt; r
</span><a href="Data.SignTyped.Class.html#withEmbed"><span class="hs-identifier hs-var">withEmbed</span></a></span><span> </span><span class="annot"><span class="annottext">Embed ctx a
</span><a href="#local-6989586621679219065"><span class="hs-identifier hs-var">mx</span></a></span><span> </span><span class="annot"><span class="annottext">TypeContext ctx
</span><a href="#local-6989586621679219068"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679219069"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; r
</span><a href="#local-6989586621679219070"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; r) -&gt; r) -&gt; (a -&gt; r) -&gt; r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679219072"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679219072"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-736"></span><span>            </span><span class="annot"><span class="annottext">Embed ctx b
-&gt; forall r.
   TypeContext ctx
   -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; (b -&gt; r) -&gt; r
forall (ctx :: TMap Symbol [EthRepr]) a.
Embed ctx a
-&gt; forall r.
   TypeContext ctx
   -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; (a -&gt; r) -&gt; r
</span><a href="Data.SignTyped.Class.html#withEmbed"><span class="hs-identifier hs-var">withEmbed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Embed ctx b
</span><a href="#local-6989586621679219067"><span class="hs-identifier hs-var">sel</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679219072"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TypeContext ctx
</span><a href="#local-6989586621679219068"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679219069"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; r
</span><a href="#local-6989586621679219070"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; r
</span><a href="#local-6989586621679219071"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-737"></span><span>
</span><span id="line-738"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679218305"><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Class.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218305"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-739"></span><span>    </span><span id="local-6989586621679219077"><span class="annot"><span class="annottext">fail :: forall a. String -&gt; Embed ctx a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fail</span></span></span><span> </span><span id="local-6989586621679219078"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679219078"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall r.
 TypeContext ctx
 -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; (a -&gt; r) -&gt; r)
-&gt; Embed ctx a
forall (ctx :: TMap Symbol [EthRepr]) a.
(forall r.
 TypeContext ctx
 -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; (a -&gt; r) -&gt; r)
-&gt; Embed ctx a
</span><a href="Data.SignTyped.Class.html#Embed"><span class="hs-identifier hs-var">Embed</span></a></span><span> </span><span class="annot"><span class="annottext">((forall r.
  TypeContext ctx
  -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; (a -&gt; r) -&gt; r)
 -&gt; Embed ctx a)
-&gt; (forall r.
    TypeContext ctx
    -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; (a -&gt; r) -&gt; r)
-&gt; Embed ctx a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">TypeContext ctx
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679219081"><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679219081"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span id="local-6989586621679219082"><span class="annot"><span class="annottext">String -&gt; r
</span><a href="#local-6989586621679219082"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="annot"><span class="annottext">a -&gt; r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-740"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; r
</span><a href="#local-6989586621679219082"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679219081"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679219078"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-741"></span><span>
</span><span id="line-742"></span><span class="annot"><span class="hs-comment">{-| @local@-like function that appends the given string to the current location. -}</span></span><span>
</span><span id="line-743"></span><span id="local-6989586621679218511"><span id="local-6989586621679218512"><span class="annot"><a href="Data.SignTyped.Class.html#withEmbedLocation"><span class="hs-identifier hs-type">withEmbedLocation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218511"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218512"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218511"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218512"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-744"></span><span id="withEmbedLocation"><span class="annot"><span class="annottext">withEmbedLocation :: forall (ctx :: TMap Symbol [EthRepr]) a.
String -&gt; Embed ctx a -&gt; Embed ctx a
</span><a href="Data.SignTyped.Class.html#withEmbedLocation"><span class="hs-identifier hs-var hs-var">withEmbedLocation</span></a></span></span><span> </span><span id="local-6989586621679219083"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679219083"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621679219084"><span class="annot"><span class="annottext">Embed ctx a
</span><a href="#local-6989586621679219084"><span class="hs-identifier hs-var">enc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-745"></span><span>    </span><span class="annot"><span class="annottext">(forall r.
 TypeContext ctx
 -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; (a -&gt; r) -&gt; r)
-&gt; Embed ctx a
forall (ctx :: TMap Symbol [EthRepr]) a.
(forall r.
 TypeContext ctx
 -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; (a -&gt; r) -&gt; r)
-&gt; Embed ctx a
</span><a href="Data.SignTyped.Class.html#Embed"><span class="hs-identifier hs-var">Embed</span></a></span><span> </span><span class="annot"><span class="annottext">((forall r.
  TypeContext ctx
  -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; (a -&gt; r) -&gt; r)
 -&gt; Embed ctx a)
-&gt; (forall r.
    TypeContext ctx
    -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; (a -&gt; r) -&gt; r)
-&gt; Embed ctx a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679219085"><span class="annot"><span class="annottext">TypeContext ctx
</span><a href="#local-6989586621679219085"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621679219086"><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679219086"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span id="local-6989586621679219087"><span class="annot"><span class="annottext">String -&gt; r
</span><a href="#local-6989586621679219087"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679219088"><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679219088"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-746"></span><span>        </span><span class="annot"><span class="annottext">Embed ctx a
-&gt; forall r.
   TypeContext ctx
   -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; (a -&gt; r) -&gt; r
forall (ctx :: TMap Symbol [EthRepr]) a.
Embed ctx a
-&gt; forall r.
   TypeContext ctx
   -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; (a -&gt; r) -&gt; r
</span><a href="Data.SignTyped.Class.html#withEmbed"><span class="hs-identifier hs-var">withEmbed</span></a></span><span> </span><span class="annot"><span class="annottext">Embed ctx a
</span><a href="#local-6989586621679219084"><span class="hs-identifier hs-var">enc</span></a></span><span> </span><span class="annot"><span class="annottext">TypeContext ctx
</span><a href="#local-6989586621679219085"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679219086"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; (String -&gt; String) -&gt; String -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679219083"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; r
</span><a href="#local-6989586621679219087"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679219088"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-747"></span><span>
</span><span id="line-748"></span><span class="annot"><span class="hs-comment">{-| `withEmbedLocation` specialization that appends an array index. -}</span></span><span>
</span><span id="line-749"></span><span id="local-6989586621679218348"><span id="local-6989586621679218349"><span class="annot"><a href="Data.SignTyped.Class.html#withEmbedLocationArrayElement"><span class="hs-identifier hs-type">withEmbedLocationArrayElement</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218348"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218349"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218348"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218349"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-750"></span><span id="withEmbedLocationArrayElement"><span class="annot"><span class="annottext">withEmbedLocationArrayElement :: forall (ctx :: TMap Symbol [EthRepr]) a.
Int -&gt; Embed ctx a -&gt; Embed ctx a
</span><a href="Data.SignTyped.Class.html#withEmbedLocationArrayElement"><span class="hs-identifier hs-var hs-var">withEmbedLocationArrayElement</span></a></span></span><span> </span><span id="local-6989586621679219097"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679219097"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-751"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Embed ctx a -&gt; Embed ctx a
forall (ctx :: TMap Symbol [EthRepr]) a.
String -&gt; Embed ctx a -&gt; Embed ctx a
</span><a href="Data.SignTyped.Class.html#withEmbedLocation"><span class="hs-identifier hs-var">withEmbedLocation</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Embed ctx a -&gt; Embed ctx a)
-&gt; String -&gt; Embed ctx a -&gt; Embed ctx a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679219097"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;]&quot;</span></span><span>
</span><span id="line-752"></span><span>
</span><span id="line-753"></span><span class="annot"><span class="hs-comment">{-| `withEmbedLocation` specialization that appends a member access. -}</span></span><span>
</span><span id="line-754"></span><span id="local-6989586621679218375"><span id="local-6989586621679218376"><span class="annot"><a href="Data.SignTyped.Class.html#withEmbedLocationStructMember"><span class="hs-identifier hs-type">withEmbedLocationStructMember</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218375"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218376"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218375"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218376"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-755"></span><span id="withEmbedLocationStructMember"><span class="annot"><span class="annottext">withEmbedLocationStructMember :: forall (ctx :: TMap Symbol [EthRepr]) a.
Text -&gt; Embed ctx a -&gt; Embed ctx a
</span><a href="Data.SignTyped.Class.html#withEmbedLocationStructMember"><span class="hs-identifier hs-var hs-var">withEmbedLocationStructMember</span></a></span></span><span> </span><span id="local-6989586621679219101"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679219101"><span class="hs-identifier hs-var">mname</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-756"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Embed ctx a -&gt; Embed ctx a
forall (ctx :: TMap Symbol [EthRepr]) a.
String -&gt; Embed ctx a -&gt; Embed ctx a
</span><a href="Data.SignTyped.Class.html#withEmbedLocation"><span class="hs-identifier hs-var">withEmbedLocation</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Embed ctx a -&gt; Embed ctx a)
-&gt; String -&gt; Embed ctx a -&gt; Embed ctx a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">Text.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679219101"><span class="hs-identifier hs-var">mname</span></a></span><span>
</span><span id="line-757"></span><span>
</span><span id="line-758"></span><span class="annot"><span class="hs-comment">{-| Retrieve the current type context. -}</span></span><span>
</span><span id="line-759"></span><span id="local-6989586621679218523"><span class="annot"><a href="Data.SignTyped.Class.html#askTypeContext"><span class="hs-identifier hs-type">askTypeContext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218523"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Structure.html#TypeContext"><span class="hs-identifier hs-type">TypeContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218523"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-760"></span><span id="askTypeContext"><span class="annot"><span class="annottext">askTypeContext :: forall (ctx :: TMap Symbol [EthRepr]). Embed ctx (TypeContext ctx)
</span><a href="Data.SignTyped.Class.html#askTypeContext"><span class="hs-identifier hs-var hs-var">askTypeContext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall r.
 TypeContext ctx
 -&gt; (String -&gt; String)
 -&gt; (String -&gt; r)
 -&gt; (TypeContext ctx -&gt; r)
 -&gt; r)
-&gt; Embed ctx (TypeContext ctx)
forall (ctx :: TMap Symbol [EthRepr]) a.
(forall r.
 TypeContext ctx
 -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; (a -&gt; r) -&gt; r)
-&gt; Embed ctx a
</span><a href="Data.SignTyped.Class.html#Embed"><span class="hs-identifier hs-var">Embed</span></a></span><span> </span><span class="annot"><span class="annottext">((forall r.
  TypeContext ctx
  -&gt; (String -&gt; String)
  -&gt; (String -&gt; r)
  -&gt; (TypeContext ctx -&gt; r)
  -&gt; r)
 -&gt; Embed ctx (TypeContext ctx))
-&gt; (forall r.
    TypeContext ctx
    -&gt; (String -&gt; String)
    -&gt; (String -&gt; r)
    -&gt; (TypeContext ctx -&gt; r)
    -&gt; r)
-&gt; Embed ctx (TypeContext ctx)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679219103"><span class="annot"><span class="annottext">TypeContext ctx
</span><a href="#local-6989586621679219103"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; r
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679219104"><span class="annot"><span class="annottext">TypeContext ctx -&gt; r
</span><a href="#local-6989586621679219104"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-761"></span><span>    </span><span class="annot"><span class="annottext">TypeContext ctx -&gt; r
</span><a href="#local-6989586621679219104"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">TypeContext ctx
</span><a href="#local-6989586621679219103"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-762"></span><span>
</span><span id="line-763"></span><span class="annot"><span class="hs-comment">{-| Lookup a struct definition by its name in the current type context. -}</span></span><span>
</span><span id="line-764"></span><span id="local-6989586621679218365"><span id="local-6989586621679218366"><span class="annot"><a href="Data.SignTyped.Class.html#getStructDef"><span class="hs-identifier hs-type">getStructDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SignTyped.Type.SName.html#SName"><span class="hs-identifier hs-type">SName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218365"><span class="hs-identifier hs-type">typename</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218366"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Structure.html#StructDef"><span class="hs-identifier hs-type">StructDef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Type.HMap.html#Lookup"><span class="hs-identifier hs-type">Lookup</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218365"><span class="hs-identifier hs-type">typename</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218366"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-765"></span><span id="getStructDef"><span class="annot"><span class="annottext">getStructDef :: forall (typename :: Symbol) (ctx :: TMap Symbol [EthRepr]).
SName typename -&gt; Embed ctx (StructDef (Lookup typename ctx))
</span><a href="Data.SignTyped.Class.html#getStructDef"><span class="hs-identifier hs-var hs-var">getStructDef</span></a></span></span><span> </span><span id="local-6989586621679219105"><span class="annot"><span class="annottext">SName typename
</span><a href="#local-6989586621679219105"><span class="hs-identifier hs-var">sname</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall r.
 TypeContext ctx
 -&gt; (String -&gt; String)
 -&gt; (String -&gt; r)
 -&gt; (StructDef (Lookup typename ctx) -&gt; r)
 -&gt; r)
-&gt; Embed ctx (StructDef (Lookup typename ctx))
forall (ctx :: TMap Symbol [EthRepr]) a.
(forall r.
 TypeContext ctx
 -&gt; (String -&gt; String) -&gt; (String -&gt; r) -&gt; (a -&gt; r) -&gt; r)
-&gt; Embed ctx a
</span><a href="Data.SignTyped.Class.html#Embed"><span class="hs-identifier hs-var">Embed</span></a></span><span> </span><span class="annot"><span class="annottext">((forall r.
  TypeContext ctx
  -&gt; (String -&gt; String)
  -&gt; (String -&gt; r)
  -&gt; (StructDef (Lookup typename ctx) -&gt; r)
  -&gt; r)
 -&gt; Embed ctx (StructDef (Lookup typename ctx)))
-&gt; (forall r.
    TypeContext ctx
    -&gt; (String -&gt; String)
    -&gt; (String -&gt; r)
    -&gt; (StructDef (Lookup typename ctx) -&gt; r)
    -&gt; r)
-&gt; Embed ctx (StructDef (Lookup typename ctx))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679219106"><span class="annot"><span class="annottext">TypeContext ctx
</span><a href="#local-6989586621679219106"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; r
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679219107"><span class="annot"><span class="annottext">StructDef (Lookup typename ctx) -&gt; r
</span><a href="#local-6989586621679219107"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-766"></span><span>    </span><span class="annot"><span class="annottext">TypeContext ctx
-&gt; SName typename -&gt; (StructDef (Lookup typename ctx) -&gt; r) -&gt; r
forall (ctx :: TMap Symbol [EthRepr]) (typename :: Symbol) r.
TypeContext ctx
-&gt; SName typename -&gt; (StructDef (Lookup typename ctx) -&gt; r) -&gt; r
</span><a href="Data.SignTyped.Structure.html#withStructDef"><span class="hs-identifier hs-var">withStructDef</span></a></span><span> </span><span class="annot"><span class="annottext">TypeContext ctx
</span><a href="#local-6989586621679219106"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">SName typename
</span><a href="#local-6989586621679219105"><span class="hs-identifier hs-var">sname</span></a></span><span> </span><span class="annot"><span class="annottext">StructDef (Lookup typename ctx) -&gt; r
</span><a href="#local-6989586621679219107"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-767"></span><span>
</span><span id="line-768"></span><span>
</span><span id="line-769"></span><span>
</span><span id="line-770"></span><span class="annot"><span class="hs-comment">{-| Helper typeclass for the generic implementation of `SignableValue`.

    The role of `GSignableRep` is to collect information about the fields of the structure. This list of fields
is then used as a parameter to `structValueHandle` to make the complete handle.

    Type parameter @s@ stands for the original Haskell type, which the handle is being built for; and @g@ is
a @GHC.Generics@-representation of a part within the original value. -}</span></span><span>
</span><span id="line-777"></span><span class="hs-keyword">class</span><span> </span><span id="GSignableRep"><span class="annot"><a href="Data.SignTyped.Class.html#GSignableRep"><span class="hs-identifier hs-var">GSignableRep</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679218262"><span class="annot"><a href="#local-6989586621679218262"><span class="hs-identifier hs-type">mods</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.SignTyped.Class.html#SigningModifier"><span class="hs-identifier hs-type">SigningModifier</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679218263"><span class="annot"><a href="#local-6989586621679218263"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679218264"><span class="annot"><a href="#local-6989586621679218264"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-778"></span><span>    </span><span id="gSignableRepMemberHandles"><span class="annot"><a href="Data.SignTyped.Class.html#gSignableRepMemberHandles"><span class="hs-identifier hs-type">gSignableRepMemberHandles</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-779"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679218263"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679218264"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-780"></span><span>        </span><span class="hs-special">[</span><span class="annot"><a href="Data.SignTyped.Class.html#SignableStructMemberHandle"><span class="hs-identifier hs-type">SignableStructMemberHandle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218263"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-781"></span><span>
</span><span id="line-782"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679218537"><span id="local-6989586621679218538"><span id="local-6989586621679218539"><span id="local-6989586621679218540"><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Class.html#GSignableRep"><span class="hs-identifier hs-type">GSignableRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218537"><span class="hs-identifier hs-type">mods</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218538"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218539"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#GSignableRep"><span class="hs-identifier hs-type">GSignableRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218537"><span class="hs-identifier hs-type">mods</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218538"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">D1</span></span><span> </span><span class="annot"><a href="#local-6989586621679218540"><span class="hs-identifier hs-type">md</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218539"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-783"></span><span>    </span><span id="local-6989586621679219115"><span class="annot"><span class="annottext">gSignableRepMemberHandles :: (s -&gt; D1 md g ()) -&gt; [SignableStructMemberHandle s]
</span><a href="Data.SignTyped.Class.html#gSignableRepMemberHandles"><span class="hs-identifier hs-var hs-var hs-var hs-var">gSignableRepMemberHandles</span></a></span></span><span> </span><span id="local-6989586621679219116"><span class="annot"><span class="annottext">s -&gt; D1 md g ()
</span><a href="#local-6989586621679219116"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-784"></span><span>        </span><span class="annot"><span class="annottext">forall (mods :: [SigningModifier]) s (g :: * -&gt; *).
GSignableRep mods s g =&gt;
(s -&gt; g ()) -&gt; [SignableStructMemberHandle s]
</span><a href="Data.SignTyped.Class.html#gSignableRepMemberHandles"><span class="hs-identifier hs-var">gSignableRepMemberHandles</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679218537"><span class="hs-identifier hs-type">mods</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679218538"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679218539"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">D1 md g () -&gt; g ()
forall k i (c :: Meta) (f :: k -&gt; *) (p :: k). M1 i c f p -&gt; f p
</span><span class="hs-identifier hs-var">unM1</span></span><span> </span><span class="annot"><span class="annottext">(D1 md g () -&gt; g ()) -&gt; (s -&gt; D1 md g ()) -&gt; s -&gt; g ()
forall b c a. Coercible b c =&gt; (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="Data.SignTyped.Class.html#%23."><span class="hs-operator hs-var">#.</span></a></span><span> </span><span class="annot"><span class="annottext">s -&gt; D1 md g ()
</span><a href="#local-6989586621679219116"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-785"></span><span>
</span><span id="line-786"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679218553"><span id="local-6989586621679218554"><span id="local-6989586621679218555"><span id="local-6989586621679218556"><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Class.html#GSignableRep"><span class="hs-identifier hs-type">GSignableRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218553"><span class="hs-identifier hs-type">mods</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218554"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218555"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#GSignableRep"><span class="hs-identifier hs-type">GSignableRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218553"><span class="hs-identifier hs-type">mods</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218554"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C1</span></span><span> </span><span class="annot"><a href="#local-6989586621679218556"><span class="hs-identifier hs-type">mc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218555"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-787"></span><span>    </span><span id="local-6989586621679219124"><span class="annot"><span class="annottext">gSignableRepMemberHandles :: (s -&gt; C1 mc g ()) -&gt; [SignableStructMemberHandle s]
</span><a href="Data.SignTyped.Class.html#gSignableRepMemberHandles"><span class="hs-identifier hs-var hs-var hs-var hs-var">gSignableRepMemberHandles</span></a></span></span><span> </span><span id="local-6989586621679219125"><span class="annot"><span class="annottext">s -&gt; C1 mc g ()
</span><a href="#local-6989586621679219125"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-788"></span><span>        </span><span class="annot"><span class="annottext">forall (mods :: [SigningModifier]) s (g :: * -&gt; *).
GSignableRep mods s g =&gt;
(s -&gt; g ()) -&gt; [SignableStructMemberHandle s]
</span><a href="Data.SignTyped.Class.html#gSignableRepMemberHandles"><span class="hs-identifier hs-var">gSignableRepMemberHandles</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679218553"><span class="hs-identifier hs-type">mods</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679218554"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679218555"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">C1 mc g () -&gt; g ()
forall k i (c :: Meta) (f :: k -&gt; *) (p :: k). M1 i c f p -&gt; f p
</span><span class="hs-identifier hs-var">unM1</span></span><span> </span><span class="annot"><span class="annottext">(C1 mc g () -&gt; g ()) -&gt; (s -&gt; C1 mc g ()) -&gt; s -&gt; g ()
forall b c a. Coercible b c =&gt; (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="Data.SignTyped.Class.html#%23."><span class="hs-operator hs-var">#.</span></a></span><span> </span><span class="annot"><span class="annottext">s -&gt; C1 mc g ()
</span><a href="#local-6989586621679219125"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-789"></span><span>
</span><span id="line-790"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679218561"><span id="local-6989586621679218562"><span id="local-6989586621679218563"><span id="local-6989586621679218564"><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Class.html#GSignableRep"><span class="hs-identifier hs-type">GSignableRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218561"><span class="hs-identifier hs-type">mods</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218562"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218563"><span class="hs-identifier hs-type">ga</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#GSignableRep"><span class="hs-identifier hs-type">GSignableRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218561"><span class="hs-identifier hs-type">mods</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218562"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218564"><span class="hs-identifier hs-type">gb</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#GSignableRep"><span class="hs-identifier hs-type">GSignableRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218561"><span class="hs-identifier hs-type">mods</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218562"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679218563"><span class="hs-identifier hs-type">ga</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*:</span></span><span> </span><span class="annot"><a href="#local-6989586621679218564"><span class="hs-identifier hs-type">gb</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-791"></span><span>    </span><span id="local-6989586621679219133"><span class="annot"><span class="annottext">gSignableRepMemberHandles :: (s -&gt; (:*:) ga gb ()) -&gt; [SignableStructMemberHandle s]
</span><a href="Data.SignTyped.Class.html#gSignableRepMemberHandles"><span class="hs-identifier hs-var hs-var hs-var hs-var">gSignableRepMemberHandles</span></a></span></span><span> </span><span id="local-6989586621679219134"><span class="annot"><span class="annottext">s -&gt; (:*:) ga gb ()
</span><a href="#local-6989586621679219134"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-792"></span><span>        </span><span class="annot"><span class="annottext">forall (mods :: [SigningModifier]) s (g :: * -&gt; *).
GSignableRep mods s g =&gt;
(s -&gt; g ()) -&gt; [SignableStructMemberHandle s]
</span><a href="Data.SignTyped.Class.html#gSignableRepMemberHandles"><span class="hs-identifier hs-var">gSignableRepMemberHandles</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679218561"><span class="hs-identifier hs-type">mods</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679218562"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679218563"><span class="hs-identifier hs-type">ga</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(:*:) ga gb () -&gt; ga ()
forall {k} {f :: k -&gt; *} {g :: k -&gt; *} {p :: k}. (:*:) f g p -&gt; f p
</span><a href="#local-6989586621679219135"><span class="hs-identifier hs-var">gfst</span></a></span><span> </span><span class="annot"><span class="annottext">((:*:) ga gb () -&gt; ga ()) -&gt; (s -&gt; (:*:) ga gb ()) -&gt; s -&gt; ga ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">s -&gt; (:*:) ga gb ()
</span><a href="#local-6989586621679219134"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-793"></span><span>      </span><span class="annot"><span class="annottext">[SignableStructMemberHandle s]
-&gt; [SignableStructMemberHandle s] -&gt; [SignableStructMemberHandle s]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span>
</span><span id="line-794"></span><span>        </span><span class="annot"><span class="annottext">forall (mods :: [SigningModifier]) s (g :: * -&gt; *).
GSignableRep mods s g =&gt;
(s -&gt; g ()) -&gt; [SignableStructMemberHandle s]
</span><a href="Data.SignTyped.Class.html#gSignableRepMemberHandles"><span class="hs-identifier hs-var">gSignableRepMemberHandles</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679218561"><span class="hs-identifier hs-type">mods</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679218562"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679218564"><span class="hs-identifier hs-type">gb</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(:*:) ga gb () -&gt; gb ()
forall {k} {f :: k -&gt; *} {g :: k -&gt; *} {p :: k}. (:*:) f g p -&gt; g p
</span><a href="#local-6989586621679219136"><span class="hs-identifier hs-var">gsnd</span></a></span><span> </span><span class="annot"><span class="annottext">((:*:) ga gb () -&gt; gb ()) -&gt; (s -&gt; (:*:) ga gb ()) -&gt; s -&gt; gb ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">s -&gt; (:*:) ga gb ()
</span><a href="#local-6989586621679219134"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-795"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-796"></span><span>        </span><span id="local-6989586621679219135"><span class="annot"><span class="annottext">gfst :: (:*:) f g p -&gt; f p
</span><a href="#local-6989586621679219135"><span class="hs-identifier hs-var hs-var">gfst</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679219137"><span class="annot"><span class="annottext">f p
</span><a href="#local-6989586621679219137"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*:</span></span><span> </span><span class="annot"><span class="annottext">g p
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f p
</span><a href="#local-6989586621679219137"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-797"></span><span>        </span><span id="local-6989586621679219136"><span class="annot"><span class="annottext">gsnd :: (:*:) f g p -&gt; g p
</span><a href="#local-6989586621679219136"><span class="hs-identifier hs-var hs-var">gsnd</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*:</span></span><span> </span><span id="local-6989586621679219139"><span class="annot"><span class="annottext">g p
</span><a href="#local-6989586621679219139"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">g p
</span><a href="#local-6989586621679219139"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-798"></span><span>
</span><span id="line-799"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-800"></span><span>    </span><span id="local-6989586621679218591"><span id="local-6989586621679218592"><span id="local-6989586621679218593"><span id="local-6989586621679218594"><span id="local-6989586621679218595"><span id="local-6989586621679218596"><span id="local-6989586621679218597"><span id="local-6989586621679218598"><span id="local-6989586621679218599"><span id="local-6989586621679218600"><span id="local-6989586621679218601"><span class="hs-special">(</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SelectedFieldName"><span class="hs-identifier hs-type">SelectedFieldName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Class.html#ModifiedFieldName"><span class="hs-identifier hs-type">ModifiedFieldName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218591"><span class="hs-identifier hs-type">hsel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218592"><span class="hs-identifier hs-type">mods</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679218591"><span class="hs-identifier hs-type">hsel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218593"><span class="hs-identifier hs-type">ethFieldName</span></a></span><span>
</span><span id="line-801"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SelectedFieldSignType"><span class="hs-identifier hs-type">SelectedFieldSignType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Class.html#ModifiedFieldType"><span class="hs-identifier hs-type">ModifiedFieldType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218591"><span class="hs-identifier hs-type">hsel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218592"><span class="hs-identifier hs-type">mods</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679218594"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218595"><span class="hs-identifier hs-type">baseType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218596"><span class="hs-identifier hs-type">signType</span></a></span><span>
</span><span id="line-802"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-803"></span><span>    </span><span class="annot"><a href="Data.SignTyped.Class.html#GSignableRep"><span class="hs-identifier hs-type">GSignableRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218592"><span class="hs-identifier hs-type">mods</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218597"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">S1</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">MetaSel</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679218591"><span class="hs-identifier hs-type">hsel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679218598"><span class="hs-identifier hs-type">mssu</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218599"><span class="hs-identifier hs-type">msss</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218600"><span class="hs-identifier hs-type">msds</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K1</span></span><span> </span><span class="annot"><a href="#local-6989586621679218601"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218594"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-804"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-805"></span><span>    </span><span id="local-6989586621679219155"><span class="annot"><span class="annottext">gSignableRepMemberHandles :: (s -&gt; S1 ('MetaSel ('Just hsel) mssu msss msds) (K1 i a) ())
-&gt; [SignableStructMemberHandle s]
</span><a href="Data.SignTyped.Class.html#gSignableRepMemberHandles"><span class="hs-identifier hs-var hs-var hs-var hs-var">gSignableRepMemberHandles</span></a></span></span><span> </span><span id="local-6989586621679219156"><span class="annot"><span class="annottext">s -&gt; S1 ('MetaSel ('Just hsel) mssu msss msds) (K1 i a) ()
</span><a href="#local-6989586621679219156"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-806"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; (s -&gt; a)
-&gt; SignableValueHandle a
-&gt; SignableStructMemberHandle s
forall s a.
Text
-&gt; (s -&gt; a)
-&gt; SignableValueHandle a
-&gt; SignableStructMemberHandle s
</span><a href="Data.SignTyped.Class.html#SignableStructMemberHandle"><span class="hs-identifier hs-var">SignableStructMemberHandle</span></a></span><span>
</span><span id="line-807"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (s :: Symbol). KnownSymbol s =&gt; Text
</span><a href="Data.SignTyped.Util.html#symbolText"><span class="hs-identifier hs-var">symbolText</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679218593"><span class="hs-identifier hs-type">ethFieldName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-808"></span><span>            </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">K1 i a () -&gt; a
forall k i c (p :: k). K1 i c p -&gt; c
</span><span class="hs-identifier hs-var">unK1</span></span><span> </span><span class="annot"><span class="annottext">(K1 i a () -&gt; a)
-&gt; (S1 ('MetaSel ('Just hsel) mssu msss msds) (K1 i a) ()
    -&gt; K1 i a ())
-&gt; S1 ('MetaSel ('Just hsel) mssu msss msds) (K1 i a) ()
-&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">S1 ('MetaSel ('Just hsel) mssu msss msds) (K1 i a) () -&gt; K1 i a ()
forall k i (c :: Meta) (f :: k -&gt; *) (p :: k). M1 i c f p -&gt; f p
</span><span class="hs-identifier hs-var">unM1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(S1 ('MetaSel ('Just hsel) mssu msss msds) (K1 i a) () -&gt; a)
-&gt; (s -&gt; S1 ('MetaSel ('Just hsel) mssu msss msds) (K1 i a) ())
-&gt; s
-&gt; a
forall b c a. Coercible b c =&gt; (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="Data.SignTyped.Class.html#%23."><span class="hs-operator hs-var">#.</span></a></span><span> </span><span class="annot"><span class="annottext">s -&gt; S1 ('MetaSel ('Just hsel) mssu msss msds) (K1 i a) ()
</span><a href="#local-6989586621679219156"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-809"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SignableValueHandle signType -&gt; SignableValueHandle a
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">(SignableValueHandle signType -&gt; SignableValueHandle a)
-&gt; SignableValueHandle signType -&gt; SignableValueHandle a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (baseType :: Symbol) a.
SignableValue baseType a =&gt;
SignableValueHandle a
</span><a href="Data.SignTyped.Class.html#signableValueHandle"><span class="hs-identifier hs-var">signableValueHandle</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679218595"><span class="hs-identifier hs-type">baseType</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679218596"><span class="hs-identifier hs-type">signType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-810"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-811"></span><span>
</span><span id="line-812"></span><span>
</span><span id="line-813"></span><span>
</span><span id="line-814"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownSymbol</span></span><span> </span><span class="annot"><a href="#local-6989586621679218606"><span class="hs-identifier hs-type">ethName</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="SelectedFieldName"><span class="annot"><a href="Data.SignTyped.Class.html#SelectedFieldName"><span class="hs-identifier hs-var">SelectedFieldName</span></a></span></span><span> </span><span id="local-6989586621679218604"><span class="annot"><a href="#local-6989586621679218604"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679218605"><span class="annot"><a href="#local-6989586621679218605"><span class="hs-identifier hs-type">hsel</span></a></span></span><span> </span><span id="local-6989586621679218606"><span class="annot"><a href="#local-6989586621679218606"><span class="hs-identifier hs-type">ethName</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621679218604"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218605"><span class="hs-identifier hs-type">hsel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679218606"><span class="hs-identifier hs-type">ethName</span></a></span><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>
</span><span id="line-815"></span><span>
</span><span id="line-816"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679218621"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownSymbol</span></span><span> </span><span class="annot"><a href="#local-6989586621679218621"><span class="hs-identifier hs-type">ethName</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SelectedFieldName"><span class="hs-identifier hs-type">SelectedFieldName</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="annot"><a href="#local-6989586621679218621"><span class="hs-identifier hs-type">ethName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218621"><span class="hs-identifier hs-type">ethName</span></a></span></span><span>
</span><span id="line-817"></span><span>
</span><span id="line-818"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679218627"><span id="local-6989586621679218628"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownSymbol</span></span><span> </span><span class="annot"><a href="#local-6989586621679218627"><span class="hs-identifier hs-type">ethName</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SelectedFieldName"><span class="hs-identifier hs-type">SelectedFieldName</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679218627"><span class="hs-identifier hs-type">ethName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679218628"><span class="hs-identifier hs-type">hsel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218627"><span class="hs-identifier hs-type">ethName</span></a></span></span></span><span>
</span><span id="line-819"></span><span>
</span><span id="line-820"></span><span>
</span><span id="line-821"></span><span>
</span><span id="line-822"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Coercible</span></span><span> </span><span class="annot"><a href="#local-6989586621679218609"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218611"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValue"><span class="hs-identifier hs-type">SignableValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218610"><span class="hs-identifier hs-type">baseType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218611"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="SelectedFieldSignType"><span class="annot"><a href="Data.SignTyped.Class.html#SelectedFieldSignType"><span class="hs-identifier hs-var">SelectedFieldSignType</span></a></span></span><span> </span><span id="local-6989586621679218608"><span class="annot"><a href="#local-6989586621679218608"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679218609"><span class="annot"><a href="#local-6989586621679218609"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679218610"><span class="annot"><a href="#local-6989586621679218610"><span class="hs-identifier hs-type">baseType</span></a></span></span><span> </span><span id="local-6989586621679218611"><span class="annot"><a href="#local-6989586621679218611"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621679218608"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218609"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679218610"><span class="hs-identifier hs-type">baseType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218611"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>
</span><span id="line-823"></span><span>
</span><span id="line-824"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679218632"><span id="local-6989586621679218633"><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueDefault"><span class="hs-identifier hs-type">SignableValueDefault</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218632"><span class="hs-identifier hs-type">baseType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218633"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SelectedFieldSignType"><span class="hs-identifier hs-type">SelectedFieldSignType</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="annot"><a href="#local-6989586621679218633"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218632"><span class="hs-identifier hs-type">baseType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218633"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-825"></span><span>
</span><span id="line-826"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679218638"><span id="local-6989586621679218639"><span id="local-6989586621679218640"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Coercible</span></span><span> </span><span class="annot"><a href="#local-6989586621679218638"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218639"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueDefault"><span class="hs-identifier hs-type">SignableValueDefault</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218640"><span class="hs-identifier hs-type">baseType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218639"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SelectedFieldSignType"><span class="hs-identifier hs-type">SelectedFieldSignType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679218639"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679218638"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218640"><span class="hs-identifier hs-type">baseType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218639"><span class="hs-identifier hs-type">s</span></a></span></span></span></span><span>
</span><span id="line-827"></span><span>
</span><span id="line-828"></span><span>
</span><span id="line-829"></span><span>
</span><span id="line-830"></span><span id="local-6989586621679218546"><span id="local-6989586621679218547"><span id="local-6989586621679218548"><span class="annot"><a href="Data.SignTyped.Class.html#%23."><span class="hs-operator hs-type">(#.)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Coercible</span></span><span> </span><span class="annot"><a href="#local-6989586621679218546"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218547"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679218546"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679218547"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679218548"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679218546"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679218548"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679218547"><span class="hs-identifier hs-type">c</span></a></span></span></span></span><span>
</span><span id="line-831"></span><span class="annot"><span class="annottext">b -&gt; c
</span><span class="hs-identifier">_</span></span><span> </span><span id="%23."><span class="annot"><span class="annottext">#. :: forall b c a. Coercible b c =&gt; (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="Data.SignTyped.Class.html#%23."><span class="hs-operator hs-var hs-var">#.</span></a></span></span><span> </span><span id="local-6989586621679219187"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679219187"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; a -&gt; c
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679219187"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-832"></span><span>
</span><span id="line-833"></span><span>
</span><span id="line-834"></span><span>
</span><span id="line-835"></span><span class="annot"><span class="hs-comment">{-| @ModifiedFieldName hsel mods@ is the Solidity field name that @mods@ assign to selector @hsel@. -}</span></span><span>
</span><span id="line-836"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="ModifiedFieldName"><span class="annot"><a href="Data.SignTyped.Class.html#ModifiedFieldName"><span class="hs-identifier hs-var">ModifiedFieldName</span></a></span></span><span> </span><span id="local-6989586621679219188"><span class="annot"><a href="#local-6989586621679219188"><span class="hs-identifier hs-type">hsel</span></a></span></span><span> </span><span id="local-6989586621679219189"><span class="annot"><a href="#local-6989586621679219189"><span class="hs-identifier hs-type">mods</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-837"></span><span>    </span><span id="ModifiedFieldName"><span class="annot"><a href="Data.SignTyped.Class.html#ModifiedFieldName"><span class="hs-identifier hs-var">ModifiedFieldName</span></a></span></span><span> </span><span id="local-6989586621679219190"><span id="local-6989586621679219191"><span id="local-6989586621679219192"><span id="local-6989586621679219193"><span class="annot"><a href="#local-6989586621679219190"><span class="hs-identifier hs-type">hsel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Data.SignTyped.Class.html#SigningFieldModifier"><span class="hs-identifier hs-type">SigningFieldModifier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219190"><span class="hs-identifier hs-type">hsel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219191"><span class="hs-identifier hs-type">mbName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219192"><span class="hs-identifier hs-type">mbType</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679219193"><span class="hs-identifier hs-type">otherMods</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-838"></span><span>        </span><span class="annot"><a href="Data.SignTyped.Class.html#SafeUnify"><span class="hs-identifier hs-type">SafeUnify</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219191"><span class="hs-identifier hs-type">mbName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Class.html#ModifiedFieldName"><span class="hs-identifier hs-type">ModifiedFieldName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219190"><span class="hs-identifier hs-type">hsel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219193"><span class="hs-identifier hs-type">otherMods</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-839"></span><span>    </span><span id="ModifiedFieldName"><span class="annot"><a href="Data.SignTyped.Class.html#ModifiedFieldName"><span class="hs-identifier hs-var">ModifiedFieldName</span></a></span></span><span> </span><span id="local-6989586621679219195"><span id="local-6989586621679219196"><span class="annot"><a href="#local-6989586621679219195"><span class="hs-identifier hs-type">hsel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679219196"><span class="hs-identifier hs-type">otherMods</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-840"></span><span>        </span><span class="annot"><a href="Data.SignTyped.Class.html#ModifiedFieldName"><span class="hs-identifier hs-type">ModifiedFieldName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219195"><span class="hs-identifier hs-type">hsel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219196"><span class="hs-identifier hs-type">otherMods</span></a></span><span>
</span><span id="line-841"></span><span>    </span><span id="ModifiedFieldName"><span class="annot"><a href="Data.SignTyped.Class.html#ModifiedFieldName"><span class="hs-identifier hs-var">ModifiedFieldName</span></a></span></span><span> </span><span id="local-6989586621679219197"><span class="annot"><a href="#local-6989586621679219197"><span class="hs-identifier hs-type">hsel</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-842"></span><span>        </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span>
</span><span id="line-843"></span><span>
</span><span id="line-844"></span><span class="annot"><span class="hs-comment">{-| @ModifiedFieldType hsel mods@ is the wrapper type that @mods@ assign to selector @hsel@. -}</span></span><span>
</span><span id="line-845"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="ModifiedFieldType"><span class="annot"><a href="Data.SignTyped.Class.html#ModifiedFieldType"><span class="hs-identifier hs-var">ModifiedFieldType</span></a></span></span><span> </span><span id="local-6989586621679219198"><span class="annot"><a href="#local-6989586621679219198"><span class="hs-identifier hs-type">hsel</span></a></span></span><span> </span><span id="local-6989586621679219199"><span class="annot"><a href="#local-6989586621679219199"><span class="hs-identifier hs-type">mods</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-846"></span><span>    </span><span id="ModifiedFieldType"><span class="annot"><a href="Data.SignTyped.Class.html#ModifiedFieldType"><span class="hs-identifier hs-var">ModifiedFieldType</span></a></span></span><span> </span><span id="local-6989586621679219200"><span id="local-6989586621679219201"><span id="local-6989586621679219202"><span id="local-6989586621679219203"><span class="annot"><a href="#local-6989586621679219200"><span class="hs-identifier hs-type">hsel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Data.SignTyped.Class.html#SigningFieldModifier"><span class="hs-identifier hs-type">SigningFieldModifier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219200"><span class="hs-identifier hs-type">hsel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219201"><span class="hs-identifier hs-type">mbName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219202"><span class="hs-identifier hs-type">mbType</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679219203"><span class="hs-identifier hs-type">otherMods</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-847"></span><span>        </span><span class="annot"><a href="Data.SignTyped.Class.html#SafeUnify"><span class="hs-identifier hs-type">SafeUnify</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219202"><span class="hs-identifier hs-type">mbType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Class.html#ModifiedFieldType"><span class="hs-identifier hs-type">ModifiedFieldType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219200"><span class="hs-identifier hs-type">hsel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219203"><span class="hs-identifier hs-type">otherMods</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-848"></span><span>    </span><span id="ModifiedFieldType"><span class="annot"><a href="Data.SignTyped.Class.html#ModifiedFieldType"><span class="hs-identifier hs-var">ModifiedFieldType</span></a></span></span><span> </span><span id="local-6989586621679219204"><span id="local-6989586621679219205"><span class="annot"><a href="#local-6989586621679219204"><span class="hs-identifier hs-type">hsel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679219205"><span class="hs-identifier hs-type">otherMods</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-849"></span><span>        </span><span class="annot"><a href="Data.SignTyped.Class.html#ModifiedFieldType"><span class="hs-identifier hs-type">ModifiedFieldType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219204"><span class="hs-identifier hs-type">hsel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219205"><span class="hs-identifier hs-type">otherMods</span></a></span><span>
</span><span id="line-850"></span><span>    </span><span id="ModifiedFieldType"><span class="annot"><a href="Data.SignTyped.Class.html#ModifiedFieldType"><span class="hs-identifier hs-var">ModifiedFieldType</span></a></span></span><span> </span><span id="local-6989586621679219206"><span class="annot"><a href="#local-6989586621679219206"><span class="hs-identifier hs-type">hsel</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-851"></span><span>        </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span>
</span><span id="line-852"></span><span>
</span><span id="line-853"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="SafeUnify"><span class="annot"><a href="Data.SignTyped.Class.html#SafeUnify"><span class="hs-identifier hs-var">SafeUnify</span></a></span></span><span> </span><span id="local-6989586621679219207"><span class="annot"><a href="#local-6989586621679219207"><span class="hs-identifier hs-type">m1</span></a></span></span><span> </span><span id="local-6989586621679219208"><span class="annot"><a href="#local-6989586621679219208"><span class="hs-identifier hs-type">m2</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-854"></span><span>    </span><span id="SafeUnify"><span class="annot"><a href="Data.SignTyped.Class.html#SafeUnify"><span class="hs-identifier hs-var">SafeUnify</span></a></span></span><span> </span><span id="local-6989586621679219209"><span class="annot"><a href="#local-6989586621679219209"><span class="hs-identifier hs-type">m1</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679219209"><span class="hs-identifier hs-type">m1</span></a></span><span>
</span><span id="line-855"></span><span>    </span><span id="SafeUnify"><span class="annot"><a href="Data.SignTyped.Class.html#SafeUnify"><span class="hs-identifier hs-var">SafeUnify</span></a></span></span><span> </span><span id="local-6989586621679219210"><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="annot"><a href="#local-6989586621679219210"><span class="hs-identifier hs-type">m2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679219210"><span class="hs-identifier hs-type">m2</span></a></span><span>
</span><span id="line-856"></span><span>    </span><span id="SafeUnify"><span class="annot"><a href="Data.SignTyped.Class.html#SafeUnify"><span class="hs-identifier hs-var">SafeUnify</span></a></span></span><span> </span><span id="local-6989586621679219211"><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679219211"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679219211"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679219211"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-857"></span><span>
</span><span id="line-858"></span><span class="annot"><span class="hs-comment">{-| @ValidateModifiers mods rep@ checks that the modifier list @mods@:

    * is internally consistent: it does not assign different names or different types to the same field, and

    * is applicable to the generic representation @rep@: it does not assign to fields that are not actually present
in the structure.

    If the checks pass, it reduces to @'Nothing@, otherwise it's @'Just@ with the description of the failure
as a type-level `ErrorMessage`. -}</span></span><span>
</span><span id="line-867"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="ValidateModifiers"><span class="annot"><a href="Data.SignTyped.Class.html#ValidateModifiers"><span class="hs-identifier hs-var">ValidateModifiers</span></a></span></span><span> </span><span id="local-6989586621679219212"><span class="annot"><a href="#local-6989586621679219212"><span class="hs-identifier hs-type">mods</span></a></span></span><span> </span><span id="local-6989586621679219213"><span class="annot"><a href="#local-6989586621679219213"><span class="hs-identifier hs-type">rep</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-868"></span><span>    </span><span id="ValidateModifiers"><span class="annot"><a href="Data.SignTyped.Class.html#ValidateModifiers"><span class="hs-identifier hs-var">ValidateModifiers</span></a></span></span><span> </span><span id="local-6989586621679219214"><span id="local-6989586621679219215"><span id="local-6989586621679219216"><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679219214"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679219215"><span class="hs-identifier hs-type">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679219216"><span class="hs-identifier hs-type">rep</span></a></span></span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-869"></span><span>        </span><span class="annot"><a href="Data.SignTyped.Class.html#ValidateModifierApplicable"><span class="hs-identifier hs-type">ValidateModifierApplicable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219214"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219216"><span class="hs-identifier hs-type">rep</span></a></span><span>
</span><span id="line-870"></span><span>      </span><span class="annot"><a href="Data.SignTyped.Class.html#%3C%7C%3E"><span class="hs-operator hs-type">&lt;|&gt;</span></a></span><span>
</span><span id="line-871"></span><span>        </span><span class="annot"><a href="Data.SignTyped.Class.html#ValidateModifierCompatible"><span class="hs-identifier hs-type">ValidateModifierCompatible</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219214"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219215"><span class="hs-identifier hs-type">rest</span></a></span><span>
</span><span id="line-872"></span><span>      </span><span class="annot"><a href="Data.SignTyped.Class.html#%3C%7C%3E"><span class="hs-operator hs-type">&lt;|&gt;</span></a></span><span>
</span><span id="line-873"></span><span>        </span><span class="annot"><a href="Data.SignTyped.Class.html#ValidateModifiers"><span class="hs-identifier hs-type">ValidateModifiers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219215"><span class="hs-identifier hs-type">rest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219216"><span class="hs-identifier hs-type">rep</span></a></span><span>
</span><span id="line-874"></span><span>    </span><span id="ValidateModifiers"><span class="annot"><a href="Data.SignTyped.Class.html#ValidateModifiers"><span class="hs-identifier hs-var">ValidateModifiers</span></a></span></span><span> </span><span id="local-6989586621679219220"><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679219220"><span class="hs-identifier hs-type">rep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-875"></span><span>        </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span>
</span><span id="line-876"></span><span>
</span><span id="line-877"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="ValidateModifierCompatible"><span class="annot"><a href="Data.SignTyped.Class.html#ValidateModifierCompatible"><span class="hs-identifier hs-var">ValidateModifierCompatible</span></a></span></span><span> </span><span id="local-6989586621679219221"><span class="annot"><a href="#local-6989586621679219221"><span class="hs-identifier hs-type">mod</span></a></span></span><span> </span><span id="local-6989586621679219222"><span class="annot"><a href="#local-6989586621679219222"><span class="hs-identifier hs-type">others</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-878"></span><span>    </span><span id="ValidateModifierCompatible"><span class="annot"><a href="Data.SignTyped.Class.html#ValidateModifierCompatible"><span class="hs-identifier hs-var">ValidateModifierCompatible</span></a></span></span><span> </span><span id="local-6989586621679219223"><span id="local-6989586621679219224"><span id="local-6989586621679219225"><span class="annot"><a href="#local-6989586621679219223"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679219224"><span class="hs-identifier hs-type">cand</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679219225"><span class="hs-identifier hs-type">rest</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-879"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">If</span></span><span>
</span><span id="line-880"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Class.html#AreFieldModifiersCompatible"><span class="hs-identifier hs-type">AreFieldModifiersCompatible</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219223"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219224"><span class="hs-identifier hs-type">cand</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-881"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Class.html#ValidateModifierCompatible"><span class="hs-identifier hs-type">ValidateModifierCompatible</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219223"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219225"><span class="hs-identifier hs-type">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-882"></span><span>            </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span>
</span><span id="line-883"></span><span>                </span><span class="hs-special">(</span><span>   </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Conflicting modifiers:&quot;</span></span><span> </span><span class="hs-special">'</span><span class="hs-operator">:$$:</span><span>
</span><span id="line-884"></span><span>                    </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="hs-string">&quot;    &quot;</span></span><span> </span><span class="hs-special">'</span><span class="hs-operator">:&lt;&gt;:</span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">ShowType</span></span><span> </span><span class="annot"><a href="#local-6989586621679219223"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-operator">:$$:</span><span>
</span><span id="line-885"></span><span>                    </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="hs-string">&quot;    &quot;</span></span><span> </span><span class="hs-special">'</span><span class="hs-operator">:&lt;&gt;:</span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">ShowType</span></span><span> </span><span class="annot"><a href="#local-6989586621679219224"><span class="hs-identifier hs-type">cand</span></a></span><span>
</span><span id="line-886"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-887"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-888"></span><span>    </span><span id="ValidateModifierCompatible"><span class="annot"><a href="Data.SignTyped.Class.html#ValidateModifierCompatible"><span class="hs-identifier hs-var">ValidateModifierCompatible</span></a></span></span><span> </span><span id="local-6989586621679219228"><span class="annot"><a href="#local-6989586621679219228"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-889"></span><span>        </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span>
</span><span id="line-890"></span><span>
</span><span id="line-891"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="AreFieldModifiersCompatible"><span class="annot"><a href="Data.SignTyped.Class.html#AreFieldModifiersCompatible"><span class="hs-identifier hs-var">AreFieldModifiersCompatible</span></a></span></span><span> </span><span id="local-6989586621679219229"><span class="annot"><a href="#local-6989586621679219229"><span class="hs-identifier hs-type">mod1</span></a></span></span><span> </span><span id="local-6989586621679219230"><span class="annot"><a href="#local-6989586621679219230"><span class="hs-identifier hs-type">mod2</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-892"></span><span>    </span><span id="AreFieldModifiersCompatible"><span class="annot"><a href="Data.SignTyped.Class.html#AreFieldModifiersCompatible"><span class="hs-identifier hs-var">AreFieldModifiersCompatible</span></a></span></span><span> </span><span id="local-6989586621679219231"><span id="local-6989586621679219232"><span id="local-6989586621679219233"><span id="local-6989586621679219234"><span id="local-6989586621679219235"><span id="local-6989586621679219236"><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Data.SignTyped.Class.html#SigningFieldModifier"><span class="hs-identifier hs-type">SigningFieldModifier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219231"><span class="hs-identifier hs-type">hsel1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219232"><span class="hs-identifier hs-type">t1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219233"><span class="hs-identifier hs-type">n1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Data.SignTyped.Class.html#SigningFieldModifier"><span class="hs-identifier hs-type">SigningFieldModifier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219234"><span class="hs-identifier hs-type">hsel2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219235"><span class="hs-identifier hs-type">t2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219236"><span class="hs-identifier hs-type">n2</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-893"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679219231"><span class="hs-identifier hs-type">hsel1</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="#local-6989586621679219234"><span class="hs-identifier hs-type">hsel2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Class.html#AreMaybesCompatible"><span class="hs-identifier hs-type">AreMaybesCompatible</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219232"><span class="hs-identifier hs-type">t1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219235"><span class="hs-identifier hs-type">t2</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#AreMaybesCompatible"><span class="hs-identifier hs-type">AreMaybesCompatible</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219233"><span class="hs-identifier hs-type">n1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219236"><span class="hs-identifier hs-type">n2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-894"></span><span>
</span><span id="line-895"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="AreMaybesCompatible"><span class="annot"><a href="Data.SignTyped.Class.html#AreMaybesCompatible"><span class="hs-identifier hs-var">AreMaybesCompatible</span></a></span></span><span> </span><span id="local-6989586621679219242"><span class="annot"><a href="#local-6989586621679219242"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679219243"><span class="annot"><a href="#local-6989586621679219243"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-896"></span><span>    </span><span id="AreMaybesCompatible"><span class="annot"><a href="Data.SignTyped.Class.html#AreMaybesCompatible"><span class="hs-identifier hs-var">AreMaybesCompatible</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span>
</span><span id="line-897"></span><span>    </span><span id="AreMaybesCompatible"><span class="annot"><a href="Data.SignTyped.Class.html#AreMaybesCompatible"><span class="hs-identifier hs-var">AreMaybesCompatible</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span>
</span><span id="line-898"></span><span>    </span><span id="AreMaybesCompatible"><span class="annot"><a href="Data.SignTyped.Class.html#AreMaybesCompatible"><span class="hs-identifier hs-var">AreMaybesCompatible</span></a></span></span><span> </span><span id="local-6989586621679219244"><span id="local-6989586621679219245"><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679219244"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679219245"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679219244"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="#local-6989586621679219245"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-899"></span><span>
</span><span id="line-900"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="ValidateModifierApplicable"><span class="annot"><a href="Data.SignTyped.Class.html#ValidateModifierApplicable"><span class="hs-identifier hs-var">ValidateModifierApplicable</span></a></span></span><span> </span><span id="local-6989586621679219246"><span class="annot"><a href="#local-6989586621679219246"><span class="hs-identifier hs-type">mod</span></a></span></span><span> </span><span id="local-6989586621679219247"><span class="annot"><a href="#local-6989586621679219247"><span class="hs-identifier hs-type">rep</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-901"></span><span>    </span><span id="ValidateModifierApplicable"><span class="annot"><a href="Data.SignTyped.Class.html#ValidateModifierApplicable"><span class="hs-identifier hs-var">ValidateModifierApplicable</span></a></span></span><span> </span><span id="local-6989586621679219248"><span id="local-6989586621679219249"><span class="annot"><a href="#local-6989586621679219248"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219249"><span class="hs-identifier hs-type">rep</span></a></span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-902"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">If</span></span><span>
</span><span id="line-903"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Class.html#IsModifierApplicable"><span class="hs-identifier hs-type">IsModifierApplicable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219248"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219249"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-904"></span><span>            </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span>
</span><span id="line-905"></span><span>            </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span>
</span><span id="line-906"></span><span>                </span><span class="hs-special">(</span><span>   </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Modifier not applicable:&quot;</span></span><span> </span><span class="hs-special">'</span><span class="hs-operator">:$$:</span><span>
</span><span id="line-907"></span><span>                    </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="hs-string">&quot;    &quot;</span></span><span> </span><span class="hs-special">'</span><span class="hs-operator">:&lt;&gt;:</span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">ShowType</span></span><span> </span><span class="annot"><a href="#local-6989586621679219248"><span class="hs-identifier hs-type">mod</span></a></span><span>
</span><span id="line-908"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-909"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-910"></span><span>
</span><span id="line-911"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="IsModifierApplicable"><span class="annot"><a href="Data.SignTyped.Class.html#IsModifierApplicable"><span class="hs-identifier hs-var">IsModifierApplicable</span></a></span></span><span> </span><span id="local-6989586621679219251"><span class="annot"><a href="#local-6989586621679219251"><span class="hs-identifier hs-type">mod</span></a></span></span><span> </span><span id="local-6989586621679219252"><span class="annot"><a href="#local-6989586621679219252"><span class="hs-identifier hs-type">rep</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-912"></span><span>    </span><span id="IsModifierApplicable"><span class="annot"><a href="Data.SignTyped.Class.html#IsModifierApplicable"><span class="hs-identifier hs-var">IsModifierApplicable</span></a></span></span><span> </span><span id="local-6989586621679219253"><span id="local-6989586621679219254"><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Data.SignTyped.Class.html#SigningFieldModifier"><span class="hs-identifier hs-type">SigningFieldModifier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219253"><span class="hs-identifier hs-type">hsel</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">S1</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">MetaSel</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679219253"><span class="hs-identifier hs-type">hsel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679219254"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-913"></span><span>        </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span>
</span><span id="line-914"></span><span>    </span><span id="IsModifierApplicable"><span class="annot"><a href="Data.SignTyped.Class.html#IsModifierApplicable"><span class="hs-identifier hs-var">IsModifierApplicable</span></a></span></span><span> </span><span id="local-6989586621679219255"><span id="local-6989586621679219256"><span id="local-6989586621679219257"><span class="annot"><a href="#local-6989586621679219255"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679219256"><span class="hs-identifier hs-type">ga</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*:</span></span><span> </span><span class="annot"><a href="#local-6989586621679219257"><span class="hs-identifier hs-type">gb</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-915"></span><span>        </span><span class="annot"><a href="Data.SignTyped.Class.html#IsModifierApplicable"><span class="hs-identifier hs-type">IsModifierApplicable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219255"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219256"><span class="hs-identifier hs-type">ga</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">||</span></span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#IsModifierApplicable"><span class="hs-identifier hs-type">IsModifierApplicable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219255"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219257"><span class="hs-identifier hs-type">gb</span></a></span><span>
</span><span id="line-916"></span><span>    </span><span id="IsModifierApplicable"><span class="annot"><a href="Data.SignTyped.Class.html#IsModifierApplicable"><span class="hs-identifier hs-var">IsModifierApplicable</span></a></span></span><span> </span><span id="local-6989586621679219258"><span id="local-6989586621679219259"><span class="annot"><a href="#local-6989586621679219258"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C1</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="#local-6989586621679219259"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-917"></span><span>        </span><span class="annot"><a href="Data.SignTyped.Class.html#IsModifierApplicable"><span class="hs-identifier hs-type">IsModifierApplicable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219258"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219259"><span class="hs-identifier hs-type">g</span></a></span><span>
</span><span id="line-918"></span><span>    </span><span id="IsModifierApplicable"><span class="annot"><a href="Data.SignTyped.Class.html#IsModifierApplicable"><span class="hs-identifier hs-var">IsModifierApplicable</span></a></span></span><span> </span><span id="local-6989586621679219260"><span id="local-6989586621679219261"><span class="annot"><a href="#local-6989586621679219260"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">D1</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="#local-6989586621679219261"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-919"></span><span>        </span><span class="annot"><a href="Data.SignTyped.Class.html#IsModifierApplicable"><span class="hs-identifier hs-type">IsModifierApplicable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219260"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219261"><span class="hs-identifier hs-type">g</span></a></span><span>
</span><span id="line-920"></span><span>    </span><span id="IsModifierApplicable"><span class="annot"><a href="Data.SignTyped.Class.html#IsModifierApplicable"><span class="hs-identifier hs-var">IsModifierApplicable</span></a></span></span><span> </span><span id="local-6989586621679219262"><span class="annot"><a href="#local-6989586621679219262"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-921"></span><span>        </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span>
</span><span id="line-922"></span><span>
</span><span id="line-923"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="local-6989586621679219263"><span class="annot"><a href="#local-6989586621679219263"><span class="hs-identifier hs-type">m1</span></a></span></span><span> </span><span id="%3C%7C%3E"><span class="annot"><a href="Data.SignTyped.Class.html#%3C%7C%3E"><span class="hs-operator hs-var">&lt;|&gt;</span></a></span></span><span> </span><span id="local-6989586621679219264"><span class="annot"><a href="#local-6989586621679219264"><span class="hs-identifier hs-type">m2</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-924"></span><span>    </span><span id="local-6989586621679219265"><span id="local-6989586621679219266"><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679219265"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span id="%3C%7C%3E"><span class="annot"><a href="Data.SignTyped.Class.html#%3C%7C%3E"><span class="hs-operator hs-var">&lt;|&gt;</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679219266"><span class="hs-identifier hs-type">m2</span></a></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679219265"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-925"></span><span>    </span><span id="local-6989586621679219267"><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span id="%3C%7C%3E"><span class="annot"><a href="Data.SignTyped.Class.html#%3C%7C%3E"><span class="hs-operator hs-var">&lt;|&gt;</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679219267"><span class="hs-identifier hs-type">m2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679219267"><span class="hs-identifier hs-type">m2</span></a></span><span>
</span><span id="line-926"></span><span>
</span><span id="line-927"></span><span class="annot"><span class="hs-comment">{-| @AssertValidation mbx r@ reduces to @r@ if @mbx ~ 'Nothing@, otherwise it's @TypeError@.

    It's intended to be used with `ValidateModifiers` type family, in the form
@AssertValidation (ValidateModifiers mods rep) r@.

    The reason it's split into a separate type family is to allow a form of validation that /does not/ throw
a type error on failure: @ValidateModifiers mods rep ~ 'Nothing@. This is sometimes used in conjunction with the
&quot;throwing&quot; version to avoid duplicate error messages. -}</span></span><span>
</span><span id="line-935"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="AssertValidation"><span class="annot"><a href="Data.SignTyped.Class.html#AssertValidation"><span class="hs-identifier hs-var">AssertValidation</span></a></span></span><span> </span><span id="local-6989586621679219268"><span class="annot"><a href="#local-6989586621679219268"><span class="hs-identifier hs-type">mbx</span></a></span></span><span> </span><span id="local-6989586621679219269"><span class="annot"><a href="#local-6989586621679219269"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-936"></span><span>    </span><span id="AssertValidation"><span class="annot"><a href="Data.SignTyped.Class.html#AssertValidation"><span class="hs-identifier hs-var">AssertValidation</span></a></span></span><span> </span><span id="local-6989586621679219270"><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="annot"><a href="#local-6989586621679219270"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679219270"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-937"></span><span>    </span><span id="AssertValidation"><span class="annot"><a href="Data.SignTyped.Class.html#AssertValidation"><span class="hs-identifier hs-var">AssertValidation</span></a></span></span><span> </span><span id="local-6989586621679219271"><span id="local-6989586621679219272"><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679219271"><span class="hs-identifier hs-type">msg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679219272"><span class="hs-identifier hs-type">r</span></a></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TypeError</span></span><span> </span><span class="annot"><a href="#local-6989586621679219271"><span class="hs-identifier hs-type">msg</span></a></span><span>
</span><span id="line-938"></span><span>
</span><span id="line-939"></span><span>
</span><span id="line-940"></span><span>
</span><span id="line-941"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679218646"><span id="local-6989586621679218647"><span id="local-6989586621679219276"><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValue"><span class="hs-identifier hs-type">SignableValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218646"><span class="hs-identifier hs-type">baseType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218647"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValue"><span class="hs-identifier hs-type">SignableValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218646"><span class="hs-identifier hs-type">baseType</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679218647"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-942"></span><span>    </span><span id="local-6989586621679219280"><span class="annot"><span class="annottext">signableValueHandle :: SignableValueHandle [a]
</span><a href="Data.SignTyped.Class.html#signableValueHandle"><span class="hs-identifier hs-var hs-var hs-var hs-var">signableValueHandle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (baseType :: Symbol) a.
SignableValue baseType a =&gt;
SignableValueHandle [a]
</span><a href="Data.SignTyped.Class.html#signableValueListHandle"><span class="hs-identifier hs-var">signableValueListHandle</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679218646"><span class="hs-identifier hs-type">baseType</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679218647"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-943"></span><span>
</span><span id="line-944"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679219283"><span class="annot"><a href="Data.SignTyped.Class.html#SignableValue"><span class="hs-identifier hs-type">SignableValue</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;bool&quot;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-945"></span><span>    </span><span id="local-6989586621679219286"><span class="annot"><span class="annottext">signableValueHandle :: SignableValueHandle Bool
</span><a href="Data.SignTyped.Class.html#signableValueHandle"><span class="hs-identifier hs-var hs-var hs-var hs-var">signableValueHandle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-946"></span><span>        </span><span class="annot"><span class="annottext">SignableValueHandle Bool
</span><a href="Data.SignTyped.Class.html#boolValueHandle"><span class="hs-identifier hs-var">boolValueHandle</span></a></span><span>
</span><span id="line-947"></span><span>
</span><span id="line-948"></span><span class="hs-special">$</span><span id="local-6989586621679219288"><span id="local-6989586621679219293"><span id="local-6989586621679219297"><span id="local-6989586621679219302"><span id="local-6989586621679219306"><span id="local-6989586621679219311"><span id="local-6989586621679219315"><span id="local-6989586621679219320"><span id="local-6989586621679219324"><span id="local-6989586621679219329"><span id="local-6989586621679219333"><span id="local-6989586621679219338"><span id="local-6989586621679219342"><span id="local-6989586621679219347"><span id="local-6989586621679219351"><span id="local-6989586621679219356"><span id="local-6989586621679219360"><span id="local-6989586621679219365"><span id="local-6989586621679219369"><span id="local-6989586621679219373"><span id="local-6989586621679219377"><span id="local-6989586621679219381"><span id="local-6989586621679219385"><span id="local-6989586621679219389"><span id="local-6989586621679219393"><span id="local-6989586621679219397"><span id="local-6989586621679219401"><span id="local-6989586621679219405"><span id="local-6989586621679219409"><span id="local-6989586621679219413"><span id="local-6989586621679219417"><span id="local-6989586621679219421"><span id="local-6989586621679219425"><span id="local-6989586621679219430"><span id="local-6989586621679219434"><span id="local-6989586621679219438"><span id="local-6989586621679219442"><span id="local-6989586621679219446"><span id="local-6989586621679219450"><span id="local-6989586621679219454"><span id="local-6989586621679219458"><span id="local-6989586621679219462"><span id="local-6989586621679219466"><span id="local-6989586621679219470"><span id="local-6989586621679219474"><span id="local-6989586621679219478"><span id="local-6989586621679219482"><span id="local-6989586621679219486"><span id="local-6989586621679219490"><span id="local-6989586621679219495"><span id="local-6989586621679219499"><span id="local-6989586621679219503"><span id="local-6989586621679219507"><span id="local-6989586621679219511"><span id="local-6989586621679219515"><span id="local-6989586621679219519"><span id="local-6989586621679219523"><span id="local-6989586621679219527"><span id="local-6989586621679219531"><span id="local-6989586621679219535"><span id="local-6989586621679219539"><span id="local-6989586621679219543"><span id="local-6989586621679219547"><span id="local-6989586621679219551"><span id="local-6989586621679219555"><span id="local-6989586621679219559"><span id="local-6989586621679219563"><span id="local-6989586621679219567"><span id="local-6989586621679219571"><span id="local-6989586621679219575"><span id="local-6989586621679219579"><span id="local-6989586621679219583"><span id="local-6989586621679219587"><span id="local-6989586621679219591"><span id="local-6989586621679219595"><span id="local-6989586621679219599"><span id="local-6989586621679219603"><span id="local-6989586621679219607"><span id="local-6989586621679219611"><span id="local-6989586621679219615"><span id="local-6989586621679219619"><span id="local-6989586621679219623"><span id="local-6989586621679219627"><span id="local-6989586621679219631"><span id="local-6989586621679219635"><span id="local-6989586621679219639"><span id="local-6989586621679219643"><span id="local-6989586621679219647"><span id="local-6989586621679219651"><span id="local-6989586621679219655"><span id="local-6989586621679219659"><span id="local-6989586621679219663"><span id="local-6989586621679219667"><span id="local-6989586621679219671"><span id="local-6989586621679219675"><span id="local-6989586621679219679"><span id="local-6989586621679219683"><span id="local-6989586621679219687"><span id="local-6989586621679219691"><span id="local-6989586621679219695"><span id="local-6989586621679219699"><span id="local-6989586621679219703"><span id="local-6989586621679219707"><span id="local-6989586621679219711"><span id="local-6989586621679219715"><span id="local-6989586621679219719"><span id="local-6989586621679219723"><span id="local-6989586621679219727"><span id="local-6989586621679219731"><span id="local-6989586621679219735"><span id="local-6989586621679219739"><span id="local-6989586621679219743"><span id="local-6989586621679219747"><span id="local-6989586621679219751"><span id="local-6989586621679219755"><span id="local-6989586621679219759"><span id="local-6989586621679219763"><span id="local-6989586621679219767"><span id="local-6989586621679219771"><span id="local-6989586621679219775"><span id="local-6989586621679219779"><span id="local-6989586621679219783"><span id="local-6989586621679219787"><span id="local-6989586621679219791"><span id="local-6989586621679219795"><span id="local-6989586621679219799"><span id="local-6989586621679219803"><span id="local-6989586621679219807"><span id="local-6989586621679219811"><span id="local-6989586621679219815"><span id="local-6989586621679219819"><span id="local-6989586621679219823"><span id="local-6989586621679219827"><span id="local-6989586621679219831"><span id="local-6989586621679219835"><span id="local-6989586621679219839"><span id="local-6989586621679219843"><span id="local-6989586621679219847"><span id="local-6989586621679219851"><span id="local-6989586621679219855"><span id="local-6989586621679219859"><span id="local-6989586621679219863"><span id="local-6989586621679219867"><span id="local-6989586621679219871"><span id="local-6989586621679219875"><span id="local-6989586621679219879"><span id="local-6989586621679219883"><span id="local-6989586621679219887"><span id="local-6989586621679219891"><span id="local-6989586621679219895"><span id="local-6989586621679219899"><span id="local-6989586621679219903"><span id="local-6989586621679219907"><span id="local-6989586621679219911"><span id="local-6989586621679219915"><span id="local-6989586621679219919"><span id="local-6989586621679219923"><span id="local-6989586621679219927"><span id="local-6989586621679219931"><span id="local-6989586621679219935"><span id="local-6989586621679219939"><span id="local-6989586621679219943"><span id="local-6989586621679219947"><span id="local-6989586621679219951"><span id="local-6989586621679219955"><span id="local-6989586621679219959"><span id="local-6989586621679219963"><span id="local-6989586621679219967"><span id="local-6989586621679219971"><span id="local-6989586621679219975"><span id="local-6989586621679219979"><span id="local-6989586621679219983"><span id="local-6989586621679219987"><span id="local-6989586621679219991"><span id="local-6989586621679219995"><span id="local-6989586621679219999"><span id="local-6989586621679220003"><span id="local-6989586621679220007"><span id="local-6989586621679220011"><span id="local-6989586621679220015"><span id="local-6989586621679220019"><span id="local-6989586621679220023"><span id="local-6989586621679220027"><span id="local-6989586621679220031"><span id="local-6989586621679220035"><span id="local-6989586621679220039"><span id="local-6989586621679220043"><span id="local-6989586621679220047"><span id="local-6989586621679220051"><span id="local-6989586621679220055"><span id="local-6989586621679220059"><span id="local-6989586621679220063"><span id="local-6989586621679220067"><span id="local-6989586621679220071"><span id="local-6989586621679220075"><span id="local-6989586621679220079"><span id="local-6989586621679220083"><span id="local-6989586621679220087"><span id="local-6989586621679220091"><span id="local-6989586621679220095"><span id="local-6989586621679220099"><span id="local-6989586621679220103"><span id="local-6989586621679220107"><span id="local-6989586621679220111"><span id="local-6989586621679220115"><span id="local-6989586621679220119"><span id="local-6989586621679220123"><span id="local-6989586621679220127"><span id="local-6989586621679220131"><span id="local-6989586621679220135"><span id="local-6989586621679220139"><span id="local-6989586621679220143"><span id="local-6989586621679220147"><span id="local-6989586621679220151"><span id="local-6989586621679220155"><span id="local-6989586621679220159"><span id="local-6989586621679220163"><span id="local-6989586621679220167"><span id="local-6989586621679220171"><span id="local-6989586621679220175"><span id="local-6989586621679220179"><span id="local-6989586621679220183"><span id="local-6989586621679220187"><span id="local-6989586621679220191"><span id="local-6989586621679220195"><span id="local-6989586621679220199"><span id="local-6989586621679220203"><span id="local-6989586621679220207"><span id="local-6989586621679220211"><span id="local-6989586621679220215"><span id="local-6989586621679220219"><span id="local-6989586621679220223"><span id="local-6989586621679220227"><span id="local-6989586621679220231"><span id="local-6989586621679220235"><span id="local-6989586621679220239"><span id="local-6989586621679220243"><span id="local-6989586621679220247"><span id="local-6989586621679220251"><span id="local-6989586621679220255"><span class="hs-special">(</span><span class="hs-keyword">do</span><span>
</span><span id="line-949"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">signedInstance</span><span> </span><span class="hs-identifier">tt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Integer</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-950"></span><span>            </span><span class="hs-special">[d|</span><span>
</span><span id="line-951"></span><span>                </span><span class="hs-keyword">instance</span><span>
</span><span id="line-952"></span><span>                    </span><span class="hs-identifier">SignableValue</span><span>
</span><span id="line-953"></span><span>                        </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="hs-identifier">pure</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">TH.LitT</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">TH.StrTyLit</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-string">&quot;int&quot;</span><span> </span><span class="hs-operator">&lt;&gt;</span><span> </span><span class="hs-identifier">show</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><span id="line-954"></span><span>                        </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="hs-identifier">pure</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">TH.ConT</span><span> </span><span class="hs-identifier">tt</span><span class="hs-special">)</span><span>
</span><span id="line-955"></span><span>                  </span><span class="hs-keyword">where</span><span>
</span><span id="line-956"></span><span>                    </span><span class="hs-identifier">signableValueHandle</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-957"></span><span>                        </span><span class="hs-identifier">contramap</span><span> </span><span class="hs-identifier">toInteger</span><span> </span><span class="hs-operator">$</span><span>
</span><span id="line-958"></span><span>                        </span><span class="hs-identifier">numberValueHandle</span><span>
</span><span id="line-959"></span><span>                            </span><span class="hs-identifier">AtomicIntegerSigned</span><span>
</span><span id="line-960"></span><span>                            </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="hs-identifier">pure</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">TH.LitE</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">TH.IntegerL</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><span id="line-961"></span><span>              </span><span class="hs-special">|]</span><span>
</span><span id="line-962"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">unsignedInstance</span><span> </span><span class="hs-identifier">tt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Integer</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-963"></span><span>            </span><span class="hs-special">[d|</span><span>
</span><span id="line-964"></span><span>                </span><span class="hs-keyword">instance</span><span>
</span><span id="line-965"></span><span>                    </span><span class="hs-identifier">SignableValue</span><span>
</span><span id="line-966"></span><span>                        </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="hs-identifier">pure</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">TH.LitT</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">TH.StrTyLit</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-string">&quot;uint&quot;</span><span> </span><span class="hs-operator">&lt;&gt;</span><span> </span><span class="hs-identifier">show</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><span id="line-967"></span><span>                        </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="hs-identifier">pure</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">TH.ConT</span><span> </span><span class="hs-identifier">tt</span><span class="hs-special">)</span><span>
</span><span id="line-968"></span><span>                  </span><span class="hs-keyword">where</span><span>
</span><span id="line-969"></span><span>                    </span><span class="hs-identifier">signableValueHandle</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-970"></span><span>                        </span><span class="hs-identifier">contramap</span><span> </span><span class="hs-identifier">toInteger</span><span> </span><span class="hs-operator">$</span><span>
</span><span id="line-971"></span><span>                        </span><span class="hs-identifier">numberValueHandle</span><span>
</span><span id="line-972"></span><span>                            </span><span class="hs-identifier">AtomicIntegerUnsigned</span><span>
</span><span id="line-973"></span><span>                            </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="hs-identifier">pure</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">TH.LitE</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">TH.IntegerL</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><span id="line-974"></span><span>              </span><span class="hs-special">|]</span><span>
</span><span id="line-975"></span><span>    </span><span class="hs-identifier">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">concat</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">concat</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">sequence</span><span>
</span><span id="line-976"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">traverse</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">signedInstance</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Integer</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">8</span><span class="hs-special">,</span><span> </span><span class="hs-number">16</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-number">256</span><span class="hs-special">]</span><span>
</span><span id="line-977"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">traverse</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unsignedInstance</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Integer</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">8</span><span class="hs-special">,</span><span> </span><span class="hs-number">16</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-number">256</span><span class="hs-special">]</span><span>
</span><span id="line-978"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">traverse</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unsignedInstance</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Natural</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">8</span><span class="hs-special">,</span><span> </span><span class="hs-number">16</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-number">256</span><span class="hs-special">]</span><span>
</span><span id="line-979"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">traverse</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">signedInstance</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Int</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">8</span><span class="hs-special">,</span><span> </span><span class="hs-number">16</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-number">64</span><span class="hs-special">]</span><span>
</span><span id="line-980"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">traverse</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unsignedInstance</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Word</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">8</span><span class="hs-special">,</span><span> </span><span class="hs-number">16</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-number">64</span><span class="hs-special">]</span><span>
</span><span id="line-981"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">traverse</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">signedInstance</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Int8</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">8</span><span class="hs-special">]</span><span>
</span><span id="line-982"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">traverse</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">signedInstance</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Int16</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">16</span><span class="hs-special">]</span><span>
</span><span id="line-983"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">traverse</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">signedInstance</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Int32</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">32</span><span class="hs-special">]</span><span>
</span><span id="line-984"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">traverse</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">signedInstance</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Int64</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">64</span><span class="hs-special">]</span><span>
</span><span id="line-985"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">traverse</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unsignedInstance</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Word8</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">8</span><span class="hs-special">]</span><span>
</span><span id="line-986"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">traverse</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unsignedInstance</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Word16</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">16</span><span class="hs-special">]</span><span>
</span><span id="line-987"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">traverse</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unsignedInstance</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Word32</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">32</span><span class="hs-special">]</span><span>
</span><span id="line-988"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">traverse</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unsignedInstance</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Word64</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">64</span><span class="hs-special">]</span><span>
</span><span id="line-989"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-990"></span><span> </span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-991"></span><span>
</span><span id="line-992"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679220262"><span class="annot"><a href="Data.SignTyped.Class.html#SignableValue"><span class="hs-identifier hs-type">SignableValue</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;address&quot;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-993"></span><span>    </span><span id="local-6989586621679220265"><span class="annot"><span class="annottext">signableValueHandle :: SignableValueHandle ByteString
</span><a href="Data.SignTyped.Class.html#signableValueHandle"><span class="hs-identifier hs-var hs-var hs-var hs-var">signableValueHandle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-994"></span><span>        </span><span class="annot"><span class="annottext">AtomicBytesSubtype -&gt; SignableValueHandle ByteString
</span><a href="Data.SignTyped.Class.html#bytesValueHandle"><span class="hs-identifier hs-var">bytesValueHandle</span></a></span><span> </span><span class="annot"><span class="annottext">AtomicBytesSubtype
</span><a href="Data.SignTyped.Structure.html#AtomicBytesSubtypeAddress"><span class="hs-identifier hs-var">AtomicBytesSubtypeAddress</span></a></span><span>
</span><span id="line-995"></span><span>
</span><span id="line-996"></span><span class="hs-special">$</span><span id="local-6989586621679220267"><span id="local-6989586621679220269"><span id="local-6989586621679220273"><span id="local-6989586621679220275"><span id="local-6989586621679220279"><span id="local-6989586621679220281"><span id="local-6989586621679220285"><span id="local-6989586621679220287"><span id="local-6989586621679220291"><span id="local-6989586621679220293"><span id="local-6989586621679220297"><span id="local-6989586621679220299"><span id="local-6989586621679220303"><span id="local-6989586621679220305"><span id="local-6989586621679220309"><span id="local-6989586621679220311"><span id="local-6989586621679220315"><span id="local-6989586621679220317"><span id="local-6989586621679220321"><span id="local-6989586621679220323"><span id="local-6989586621679220327"><span id="local-6989586621679220329"><span id="local-6989586621679220333"><span id="local-6989586621679220335"><span id="local-6989586621679220339"><span id="local-6989586621679220341"><span id="local-6989586621679220345"><span id="local-6989586621679220347"><span id="local-6989586621679220351"><span id="local-6989586621679220353"><span id="local-6989586621679220357"><span id="local-6989586621679220359"><span id="local-6989586621679220363"><span id="local-6989586621679220365"><span id="local-6989586621679220369"><span id="local-6989586621679220371"><span id="local-6989586621679220375"><span id="local-6989586621679220377"><span id="local-6989586621679220381"><span id="local-6989586621679220383"><span id="local-6989586621679220387"><span id="local-6989586621679220389"><span id="local-6989586621679220393"><span id="local-6989586621679220395"><span id="local-6989586621679220399"><span id="local-6989586621679220401"><span id="local-6989586621679220405"><span id="local-6989586621679220407"><span id="local-6989586621679220411"><span id="local-6989586621679220413"><span id="local-6989586621679220417"><span id="local-6989586621679220419"><span id="local-6989586621679220423"><span id="local-6989586621679220425"><span id="local-6989586621679220429"><span id="local-6989586621679220431"><span id="local-6989586621679220435"><span id="local-6989586621679220437"><span id="local-6989586621679220441"><span id="local-6989586621679220443"><span id="local-6989586621679220447"><span id="local-6989586621679220449"><span id="local-6989586621679220453"><span id="local-6989586621679220455"><span class="hs-special">(</span><span class="hs-keyword">do</span><span>
</span><span id="line-997"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">bytesInstance</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-998"></span><span>            </span><span class="hs-special">[d|</span><span>
</span><span id="line-999"></span><span>                </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">SignableValue</span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="hs-identifier">pure</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">TH.LitT</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">TH.StrTyLit</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-string">&quot;bytes&quot;</span><span> </span><span class="hs-operator">&lt;&gt;</span><span> </span><span class="hs-identifier">show</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">BS.ByteString</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1000"></span><span>                    </span><span class="hs-identifier">signableValueHandle</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1001"></span><span>                        </span><span class="hs-identifier">bytesValueHandle</span><span>
</span><span id="line-1002"></span><span>                            </span><span class="hs-special">(</span><span class="hs-identifier">AtomicBytesSubtypeShortBytes</span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="hs-identifier">pure</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">TH.LitE</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">TH.IntegerL</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1003"></span><span>              </span><span class="hs-special">|]</span><span>
</span><span id="line-1004"></span><span>    </span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">concat</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">traverse</span><span> </span><span class="hs-identifier">bytesInstance</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-number">32</span><span class="hs-special">]</span><span>
</span><span id="line-1005"></span><span> </span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-1006"></span><span>
</span><span id="line-1007"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679220460"><span class="annot"><a href="Data.SignTyped.Class.html#SignableValue"><span class="hs-identifier hs-type">SignableValue</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;bytes&quot;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1008"></span><span>    </span><span id="local-6989586621679220463"><span class="annot"><span class="annottext">signableValueHandle :: SignableValueHandle ByteString
</span><a href="Data.SignTyped.Class.html#signableValueHandle"><span class="hs-identifier hs-var hs-var hs-var hs-var">signableValueHandle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1009"></span><span>        </span><span class="annot"><span class="annottext">AtomicBytesSubtype -&gt; SignableValueHandle ByteString
</span><a href="Data.SignTyped.Class.html#bytesValueHandle"><span class="hs-identifier hs-var">bytesValueHandle</span></a></span><span> </span><span class="annot"><span class="annottext">AtomicBytesSubtype
</span><a href="Data.SignTyped.Structure.html#AtomicBytesSubtypeLongBytes"><span class="hs-identifier hs-var">AtomicBytesSubtypeLongBytes</span></a></span><span>
</span><span id="line-1010"></span><span>
</span><span id="line-1011"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679220466"><span class="annot"><a href="Data.SignTyped.Class.html#SignableValue"><span class="hs-identifier hs-type">SignableValue</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;string&quot;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1012"></span><span>    </span><span id="local-6989586621679220471"><span class="annot"><span class="annottext">signableValueHandle :: SignableValueHandle ByteString
</span><a href="Data.SignTyped.Class.html#signableValueHandle"><span class="hs-identifier hs-var hs-var hs-var hs-var">signableValueHandle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1013"></span><span>        </span><span class="annot"><span class="annottext">(ByteString -&gt; Either String Text)
-&gt; SignableValueHandle Text -&gt; SignableValueHandle ByteString
forall a b.
(a -&gt; Either String b)
-&gt; SignableValueHandle b -&gt; SignableValueHandle a
</span><a href="Data.SignTyped.Class.html#contramapSignableEither"><span class="hs-identifier hs-var">contramapSignableEither</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-1014"></span><span>            </span><span class="annot"><span class="annottext">(UnicodeException -&gt; Either String Text)
-&gt; (Text -&gt; Either String Text)
-&gt; Either UnicodeException Text
-&gt; Either String Text
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Either String Text
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Either String Text)
-&gt; (UnicodeException -&gt; String)
-&gt; UnicodeException
-&gt; Either String Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">UnicodeException -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either String Text
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Either UnicodeException Text -&gt; Either String Text)
-&gt; (ByteString -&gt; Either UnicodeException Text)
-&gt; ByteString
-&gt; Either String Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-1015"></span><span>            </span><span class="annot"><span class="annottext">ByteString -&gt; Either UnicodeException Text
</span><span class="hs-identifier hs-var">Text.Encoding.decodeUtf8'</span></span><span>
</span><span id="line-1016"></span><span>        </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SignableValueHandle Text -&gt; SignableValueHandle ByteString)
-&gt; SignableValueHandle Text -&gt; SignableValueHandle ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1017"></span><span>        </span><span class="annot"><span class="annottext">SignableValueHandle Text
</span><a href="Data.SignTyped.Class.html#stringValueHandle"><span class="hs-identifier hs-var">stringValueHandle</span></a></span><span>
</span><span id="line-1018"></span><span>
</span><span id="line-1019"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679220476"><span class="annot"><a href="Data.SignTyped.Class.html#SignableValue"><span class="hs-identifier hs-type">SignableValue</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;string&quot;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text.Text</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1020"></span><span>    </span><span id="local-6989586621679220479"><span class="annot"><span class="annottext">signableValueHandle :: SignableValueHandle Text
</span><a href="Data.SignTyped.Class.html#signableValueHandle"><span class="hs-identifier hs-var hs-var hs-var hs-var">signableValueHandle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1021"></span><span>        </span><span class="annot"><span class="annottext">SignableValueHandle Text
</span><a href="Data.SignTyped.Class.html#stringValueHandle"><span class="hs-identifier hs-var">stringValueHandle</span></a></span><span>
</span><span id="line-1022"></span><span>
</span><span id="line-1023"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValue"><span class="hs-identifier hs-type">SignableValue</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;string&quot;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1024"></span><span>    </span><span id="local-6989586621679220484"><span class="annot"><span class="annottext">signableValueHandle :: SignableValueHandle Char
</span><a href="Data.SignTyped.Class.html#signableValueHandle"><span class="hs-identifier hs-var hs-var hs-var hs-var">signableValueHandle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1025"></span><span>        </span><span class="annot"><span class="annottext">(Char -&gt; Text)
-&gt; SignableValueHandle Text -&gt; SignableValueHandle Char
forall a' a.
(a' -&gt; a) -&gt; SignableValueHandle a -&gt; SignableValueHandle a'
forall (f :: * -&gt; *) a' a.
Contravariant f =&gt;
(a' -&gt; a) -&gt; f a -&gt; f a'
</span><span class="hs-identifier hs-var">contramap</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Text
</span><span class="hs-identifier hs-var">Text.singleton</span></span><span> </span><span class="annot"><span class="annottext">(SignableValueHandle Text -&gt; SignableValueHandle Char)
-&gt; SignableValueHandle Text -&gt; SignableValueHandle Char
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1026"></span><span>        </span><span class="annot"><span class="annottext">SignableValueHandle Text
</span><a href="Data.SignTyped.Class.html#stringValueHandle"><span class="hs-identifier hs-var">stringValueHandle</span></a></span><span>
</span><span id="line-1027"></span><span>    </span><span id="local-6989586621679220487"><span class="annot"><span class="annottext">signableValueListHandle :: SignableValueHandle String
</span><a href="Data.SignTyped.Class.html#signableValueListHandle"><span class="hs-identifier hs-var hs-var hs-var hs-var">signableValueListHandle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1028"></span><span>        </span><span class="annot"><span class="annottext">(String -&gt; Text)
-&gt; SignableValueHandle Text -&gt; SignableValueHandle String
forall a' a.
(a' -&gt; a) -&gt; SignableValueHandle a -&gt; SignableValueHandle a'
forall (f :: * -&gt; *) a' a.
Contravariant f =&gt;
(a' -&gt; a) -&gt; f a -&gt; f a'
</span><span class="hs-identifier hs-var">contramap</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">Text.pack</span></span><span> </span><span class="annot"><span class="annottext">(SignableValueHandle Text -&gt; SignableValueHandle String)
-&gt; SignableValueHandle Text -&gt; SignableValueHandle String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1029"></span><span>        </span><span class="annot"><span class="annottext">SignableValueHandle Text
</span><a href="Data.SignTyped.Class.html#stringValueHandle"><span class="hs-identifier hs-var">stringValueHandle</span></a></span><span>
</span><span id="line-1030"></span><span>
</span><span id="line-1031"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679218655"><span id="local-6989586621679218656"><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueDefault"><span class="hs-identifier hs-type">SignableValueDefault</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218655"><span class="hs-identifier hs-type">baseType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218656"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueDefault"><span class="hs-identifier hs-type">SignableValueDefault</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679218655"><span class="hs-identifier hs-type">baseType</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679218656"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-1032"></span><span>
</span><span id="line-1033"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueDefault"><span class="hs-identifier hs-type">SignableValueDefault</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;bool&quot;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1034"></span><span>
</span><span id="line-1035"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueDefault"><span class="hs-identifier hs-type">SignableValueDefault</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;int8&quot;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int8</span></span><span>
</span><span id="line-1036"></span><span>
</span><span id="line-1037"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueDefault"><span class="hs-identifier hs-type">SignableValueDefault</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;int16&quot;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int16</span></span><span>
</span><span id="line-1038"></span><span>
</span><span id="line-1039"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueDefault"><span class="hs-identifier hs-type">SignableValueDefault</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;int32&quot;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int32</span></span><span>
</span><span id="line-1040"></span><span>
</span><span id="line-1041"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueDefault"><span class="hs-identifier hs-type">SignableValueDefault</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;int64&quot;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span>
</span><span id="line-1042"></span><span>
</span><span id="line-1043"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueDefault"><span class="hs-identifier hs-type">SignableValueDefault</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;uint8&quot;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-1044"></span><span>
</span><span id="line-1045"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueDefault"><span class="hs-identifier hs-type">SignableValueDefault</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;uint16&quot;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span>
</span><span id="line-1046"></span><span>
</span><span id="line-1047"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueDefault"><span class="hs-identifier hs-type">SignableValueDefault</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;uint32&quot;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-1048"></span><span>
</span><span id="line-1049"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueDefault"><span class="hs-identifier hs-type">SignableValueDefault</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;uint64&quot;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-1050"></span><span>
</span><span id="line-1051"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueDefault"><span class="hs-identifier hs-type">SignableValueDefault</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;string&quot;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text.Text</span></span><span>
</span><span id="line-1052"></span><span>
</span><span id="line-1053"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.SignTyped.Class.html#SignableValueDefault"><span class="hs-identifier hs-type">SignableValueDefault</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;string&quot;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span>
</span><span id="line-1054"></span></pre></body></html>