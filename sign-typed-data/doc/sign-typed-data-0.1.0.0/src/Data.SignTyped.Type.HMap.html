<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# OPTIONS_GHC -Wno-redundant-constraints #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="annot"><span class="hs-comment">{-| This module defines a singleton heterogeneous map.

    This map provides a mapping that exists on both type-level and value-level. The keys of the map are singletons,
where each distinct value has its own type marker. The values are arbitrary GADTs that use the type parameter as a
marker. For each mapping from a key object and a value object, there is a corresponding mapping from the key's
to the value's type markers inside the map's state token.

    The state token itself is not constructive, it has no direct representation in the Haskell's type system.
Instead, it is being kept as an abstract existential, which is consistently the same for the same object, but
distinct for any two non-equivalent objects. The presence of a particular mapping inside the state token is asserted
axiomatically by the `HMap`-operating functions.

    Whenever a new `HMap` object is created, it is wrapped in a `Some`. This effectively makes GHC spawn a new
existential type for each such creation. -}</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.SignTyped.Type.HMap</span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Data.SignTyped.Type.HMap.html#TMap"><span class="hs-identifier">TMap</span></a></span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Type.HMap.html#Lookup"><span class="hs-identifier">Lookup</span></a></span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Type.HMap.html#HMap"><span class="hs-identifier">HMap</span></a></span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Type.HMap.html#emptyHMap"><span class="hs-identifier">emptyHMap</span></a></span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Type.HMap.html#singletonHMap"><span class="hs-identifier">singletonHMap</span></a></span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Type.HMap.html#unionHMapWithKey"><span class="hs-identifier">unionHMapWithKey</span></a></span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Type.HMap.html#lookupHMap"><span class="hs-identifier">lookupHMap</span></a></span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Type.HMap.html#foldMapHMapWithKey"><span class="hs-identifier">foldMapHMapWithKey</span></a></span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Type.HMap.html#foldrHMapWithKey"><span class="hs-identifier">foldrHMapWithKey</span></a></span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier">Some</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">where</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.SignTyped.Type.Some.html"><span class="hs-identifier">Data.SignTyped.Type.Some</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.SignTyped.Type.TestOrdering.html"><span class="hs-identifier">Data.SignTyped.Type.TestOrdering</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Type.Equality</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Lazy</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Unsafe.Coerce</span></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="annot"><span class="hs-comment">{-| A kind for state tokens of `HMap`s. -}</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">data</span><span> </span><span id="TMap"><span class="annot"><a href="Data.SignTyped.Type.HMap.html#TMap"><span class="hs-identifier hs-var">TMap</span></a></span></span><span> </span><span id="local-6989586621679215188"><span class="annot"><a href="#local-6989586621679215188"><span class="hs-identifier hs-type">kk</span></a></span></span><span> </span><span id="local-6989586621679215189"><span class="annot"><a href="#local-6989586621679215189"><span class="hs-identifier hs-type">kv</span></a></span></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="annot"><span class="hs-comment">{-| A type family that represents a lookup result within a specific state token.

    There is no constructive definition for this type family, its instances are produced axiomatically by `HMap`'s
functions. -}</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Data.SignTyped.Type.HMap.html#Lookup"><span class="hs-identifier hs-type">Lookup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679215190"><span id="local-6989586621679215191"><span class="annot"><a href="#local-6989586621679215190"><span class="hs-identifier hs-type">kk</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SignTyped.Type.HMap.html#TMap"><span class="hs-identifier hs-type">TMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215190"><span class="hs-identifier hs-type">kk</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215191"><span class="hs-identifier hs-type">kv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679215191"><span class="hs-identifier hs-type">kv</span></a></span></span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="Lookup"><span class="annot"><a href="Data.SignTyped.Type.HMap.html#Lookup"><span class="hs-identifier hs-var">Lookup</span></a></span></span><span> </span><span id="local-6989586621679215192"><span class="annot"><a href="#local-6989586621679215192"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679215193"><span class="annot"><a href="#local-6989586621679215193"><span class="hs-identifier hs-type">ms</span></a></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="annot"><span class="hs-comment">{-| A singleton heterogeneous map.

    The last parameter is a type-level token corresponding to the map's value. -}</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Data.SignTyped.Type.HMap.html#HMap"><span class="hs-identifier hs-type">HMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679215064"><span id="local-6989586621679215065"><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679215064"><span class="hs-identifier hs-type">kk</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679215065"><span class="hs-identifier hs-type">kv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SignTyped.Type.HMap.html#TMap"><span class="hs-identifier hs-type">TMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215064"><span class="hs-identifier hs-type">kk</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215065"><span class="hs-identifier hs-type">kv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span></span></span><span>
</span><span id="line-52"></span><span class="hs-keyword">newtype</span><span> </span><span id="HMap"><span class="annot"><a href="Data.SignTyped.Type.HMap.html#HMap"><span class="hs-identifier hs-var">HMap</span></a></span></span><span> </span><span id="local-6989586621679215066"><span class="annot"><a href="#local-6989586621679215066"><span class="hs-identifier hs-type">kf</span></a></span></span><span> </span><span id="local-6989586621679215067"><span class="annot"><a href="#local-6989586621679215067"><span class="hs-identifier hs-type">vf</span></a></span></span><span> </span><span id="local-6989586621679215068"><span class="annot"><a href="#local-6989586621679215068"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="UnsafeHMap"><span class="annot"><a href="Data.SignTyped.Type.HMap.html#UnsafeHMap"><span class="hs-identifier hs-var">UnsafeHMap</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215066"><span class="hs-identifier hs-type">kf</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215067"><span class="hs-identifier hs-type">vf</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679215000"><span id="local-6989586621679215001"><span id="local-6989586621679215002"><span id="local-6989586621679215199"><span id="local-6989586621679215205"><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679214996"><span class="annot"><a href="#local-6989586621679214996"><span class="hs-identifier hs-type">kt</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679215000"><span class="hs-identifier hs-type">kf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679214996"><span class="hs-identifier hs-type">kt</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679214997"><span class="annot"><a href="#local-6989586621679214997"><span class="hs-identifier hs-type">vt</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679215001"><span class="hs-identifier hs-type">vf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679214997"><span class="hs-identifier hs-type">vt</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Type.HMap.html#HMap"><span class="hs-identifier hs-type">HMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215000"><span class="hs-identifier hs-type">kf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215001"><span class="hs-identifier hs-type">vf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215002"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-55"></span><span>    </span><span id="local-6989586621679215216"><span class="annot"><span class="annottext">showsPrec :: Int -&gt; HMap kf vf s -&gt; ShowS
</span><a href="#local-6989586621679215216"><span class="hs-identifier hs-var hs-var hs-var hs-var">showsPrec</span></a></span></span><span> </span><span id="local-6989586621679215218"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679215218"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Type.HMap.html#UnsafeHMap"><span class="hs-identifier hs-type">UnsafeHMap</span></a></span><span> </span><span id="local-6989586621679215219"><span class="annot"><span class="annottext">Map (Some kf) (Some vf)
</span><a href="#local-6989586621679215219"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Map (Some kf) (Some vf) -&gt; Bool
forall k a. Map k a -&gt; Bool
</span><span class="hs-identifier hs-var">Map.null</span></span><span> </span><span class="annot"><span class="annottext">Map (Some kf) (Some vf)
</span><a href="#local-6989586621679215219"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-57"></span><span>            </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;emptyHMap&quot;</span></span><span>
</span><span id="line-58"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-59"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; ShowS -&gt; ShowS
</span><span class="hs-identifier hs-var">showParen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679215218"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ShowS -&gt; ShowS) -&gt; ShowS -&gt; ShowS
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-60"></span><span>                </span><span class="annot"><span class="annottext">(ShowS -&gt; ShowS -&gt; ShowS) -&gt; ShowS -&gt; [ShowS] -&gt; ShowS
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">(.)</span></span><span> </span><span class="annot"><span class="annottext">ShowS
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">[ShowS]
</span><a href="#local-6989586621679215227"><span class="hs-identifier hs-var">elemStrings</span></a></span><span>
</span><span id="line-61"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-62"></span><span>        </span><span class="annot"><a href="#local-6989586621679215227"><span class="hs-identifier hs-type">elemStrings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ShowS</span></span><span class="hs-special">]</span><span>
</span><span id="line-63"></span><span>        </span><span id="local-6989586621679215227"><span class="annot"><span class="annottext">elemStrings :: [ShowS]
</span><a href="#local-6989586621679215227"><span class="hs-identifier hs-var hs-var">elemStrings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-64"></span><span>            </span><span class="annot"><span class="annottext">(ShowS -&gt; ShowS) -&gt; [ShowS] -&gt; [ShowS]
forall a. (a -&gt; a) -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679215228"><span class="hs-identifier hs-var">mapExceptLast</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &lt;&gt; &quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([ShowS] -&gt; [ShowS]) -&gt; [ShowS] -&gt; [ShowS]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-65"></span><span>            </span><span class="annot"><span class="annottext">((Some kf, Some vf) -&gt; ShowS) -&gt; [(Some kf, Some vf)] -&gt; [ShowS]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span id="local-6989586621679215229"><span class="annot"><span class="annottext">kf t
</span><a href="#local-6989586621679215229"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span id="local-6989586621679215232"><span class="annot"><span class="annottext">vf t
</span><a href="#local-6989586621679215232"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-66"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;singletonHMap &quot;</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-67"></span><span>                </span><span class="annot"><span class="annottext">Int -&gt; kf t -&gt; ShowS
forall a. Show a =&gt; Int -&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">showsPrec</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">11</span></span><span> </span><span class="annot"><span class="annottext">kf t
</span><a href="#local-6989586621679215229"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-68"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-69"></span><span>                </span><span class="annot"><span class="annottext">Int -&gt; vf t -&gt; ShowS
forall a. Show a =&gt; Int -&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">showsPrec</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">11</span></span><span> </span><span class="annot"><span class="annottext">vf t
</span><a href="#local-6989586621679215232"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-70"></span><span>            </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Some kf, Some vf)] -&gt; [ShowS])
-&gt; [(Some kf, Some vf)] -&gt; [ShowS]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-71"></span><span>            </span><span class="annot"><span class="annottext">Map (Some kf) (Some vf) -&gt; [(Some kf, Some vf)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="annot"><span class="annottext">Map (Some kf) (Some vf)
</span><a href="#local-6989586621679215219"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-72"></span><span>        </span><span id="local-6989586621679215018"><span class="annot"><a href="#local-6989586621679215228"><span class="hs-identifier hs-type">mapExceptLast</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679215018"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679215018"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679215018"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679215018"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-73"></span><span>        </span><span id="local-6989586621679215228"><span class="annot"><span class="annottext">mapExceptLast :: forall a. (a -&gt; a) -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679215228"><span class="hs-identifier hs-var hs-var">mapExceptLast</span></a></span></span><span> </span><span id="local-6989586621679215234"><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679215234"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679215235"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679215235"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679215236"><span class="annot"><span class="annottext">rest :: [a]
</span><a href="#local-6989586621679215236"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-74"></span><span>            </span><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679215234"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679215235"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; [a] -&gt; [a]
forall a. (a -&gt; a) -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679215228"><span class="hs-identifier hs-var">mapExceptLast</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679215234"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679215236"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-75"></span><span>        </span><span class="annot"><a href="#local-6989586621679215228"><span class="hs-identifier hs-var">mapExceptLast</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679215237"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679215237"><span class="hs-identifier hs-var">lastOrNull</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-76"></span><span>            </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679215237"><span class="hs-identifier hs-var">lastOrNull</span></a></span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679215039"><span id="local-6989586621679215040"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TestEquality</span></span><span> </span><span class="annot"><a href="#local-6989586621679215039"><span class="hs-identifier hs-type">kf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TestEquality</span></span><span> </span><span class="annot"><a href="#local-6989586621679215040"><span class="hs-identifier hs-type">vf</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TestEquality</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Type.HMap.html#HMap"><span class="hs-identifier hs-type">HMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215039"><span class="hs-identifier hs-type">kf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215040"><span class="hs-identifier hs-type">vf</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-79"></span><span>    </span><span id="local-6989586621679215248"><span class="annot"><span class="annottext">testEquality :: forall (a :: TMap kk kv) (b :: TMap kk kv).
HMap kf vf a -&gt; HMap kf vf b -&gt; Maybe (a :~: b)
</span><a href="#local-6989586621679215248"><span class="hs-identifier hs-var hs-var hs-var hs-var">testEquality</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679215250"><span class="annot"><a href="Data.SignTyped.Type.HMap.html#UnsafeHMap"><span class="hs-identifier hs-type">UnsafeHMap</span></a></span><span> </span><span id="local-6989586621679215251"><span class="annot"><span class="annottext">Map (Some kf) (Some vf)
</span><a href="#local-6989586621679215251"><span class="hs-identifier hs-var">m1</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SignTyped.Type.HMap.html#HMap"><span class="hs-identifier hs-type">HMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215039"><span class="hs-identifier hs-type">kf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215040"><span class="hs-identifier hs-type">vf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215250"><span class="hs-identifier hs-type">s1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679215252"><span class="annot"><a href="Data.SignTyped.Type.HMap.html#UnsafeHMap"><span class="hs-identifier hs-type">UnsafeHMap</span></a></span><span> </span><span id="local-6989586621679215253"><span class="annot"><span class="annottext">Map (Some kf) (Some vf)
</span><a href="#local-6989586621679215253"><span class="hs-identifier hs-var">m2</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SignTyped.Type.HMap.html#HMap"><span class="hs-identifier hs-type">HMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215039"><span class="hs-identifier hs-type">kf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215040"><span class="hs-identifier hs-type">vf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215252"><span class="hs-identifier hs-type">s2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-80"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Map (Some kf) (Some vf)
</span><a href="#local-6989586621679215251"><span class="hs-identifier hs-var">m1</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Some kf) (Some vf) -&gt; Map (Some kf) (Some vf) -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Map (Some kf) (Some vf)
</span><a href="#local-6989586621679215253"><span class="hs-identifier hs-var">m2</span></a></span><span>
</span><span id="line-81"></span><span>            </span><span class="hs-keyword">then</span><span>
</span><span id="line-82"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall {k} (a :: k) (b :: k). UnsafeEquality a b
forall (a :: TMap kk kv) (b :: TMap kk kv). UnsafeEquality a b
</span><span class="hs-identifier hs-var">Unsafe.Coerce.unsafeEqualityProof</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679215250"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679215252"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-83"></span><span>                    </span><span class="annot"><span class="annottext">UnsafeEquality a b
</span><span class="hs-identifier hs-var">Unsafe.Coerce.UnsafeRefl</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-84"></span><span>                        </span><span class="annot"><span class="annottext">(a :~: b) -&gt; Maybe (a :~: b)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a :~: a
a :~: b
forall {k} (a :: k). a :~: a
</span><span class="hs-identifier hs-var">Refl</span></span><span>
</span><span id="line-85"></span><span>            </span><span class="hs-keyword">else</span><span>
</span><span id="line-86"></span><span>                </span><span class="annot"><span class="annottext">Maybe (a :~: b)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span id="local-6989586621679215055"><span id="local-6989586621679215056"><span class="annot"><a href="Data.SignTyped.Type.HMap.html#emptyHMap"><span class="hs-identifier hs-type">emptyHMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Type.HMap.html#HMap"><span class="hs-identifier hs-type">HMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215055"><span class="hs-identifier hs-type">kf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215056"><span class="hs-identifier hs-type">vf</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-89"></span><span id="emptyHMap"><span class="annot"><span class="annottext">emptyHMap :: forall {kk} {kv} (kf :: kk -&gt; *) (vf :: kv -&gt; *). Some (HMap kf vf)
</span><a href="Data.SignTyped.Type.HMap.html#emptyHMap"><span class="hs-identifier hs-var hs-var">emptyHMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HMap kf vf Any -&gt; Some (HMap kf vf)
forall {k} (f :: k -&gt; *) (t :: k). f t -&gt; Some f
</span><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-var">Some</span></a></span><span> </span><span class="annot"><span class="annottext">(HMap kf vf Any -&gt; Some (HMap kf vf))
-&gt; HMap kf vf Any -&gt; Some (HMap kf vf)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map (Some kf) (Some vf) -&gt; HMap kf vf Any
forall kk kv (kf :: kk -&gt; *) (vf :: kv -&gt; *) (s :: TMap kk kv).
Map (Some kf) (Some vf) -&gt; HMap kf vf s
</span><a href="Data.SignTyped.Type.HMap.html#UnsafeHMap"><span class="hs-identifier hs-var">UnsafeHMap</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Some kf) (Some vf)
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span id="local-6989586621679215073"><span id="local-6989586621679215075"><span id="local-6989586621679215076"><span id="local-6989586621679215077"><span class="annot"><a href="Data.SignTyped.Type.HMap.html#singletonHMap"><span class="hs-identifier hs-type">singletonHMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Type.TestOrdering.html#SingletonConstructor"><span class="hs-identifier hs-type">SingletonConstructor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215073"><span class="hs-identifier hs-type">kf</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679215073"><span class="hs-identifier hs-type">kf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215075"><span class="hs-identifier hs-type">kt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679215076"><span class="hs-identifier hs-type">vf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215077"><span class="hs-identifier hs-type">vt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Type.HMap.html#HMap"><span class="hs-identifier hs-type">HMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215073"><span class="hs-identifier hs-type">kf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215076"><span class="hs-identifier hs-type">vf</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-92"></span><span id="singletonHMap"><span class="annot"><span class="annottext">singletonHMap :: forall {kk} {kv} (kf :: kk -&gt; *) (kt :: kk) (vf :: kv -&gt; *)
       (vt :: kv).
SingletonConstructor kf =&gt;
kf kt -&gt; vf vt -&gt; Some (HMap kf vf)
</span><a href="Data.SignTyped.Type.HMap.html#singletonHMap"><span class="hs-identifier hs-var hs-var">singletonHMap</span></a></span></span><span> </span><span id="local-6989586621679215258"><span class="annot"><span class="annottext">kf kt
</span><a href="#local-6989586621679215258"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679215259"><span class="annot"><span class="annottext">vf vt
</span><a href="#local-6989586621679215259"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HMap kf vf Any -&gt; Some (HMap kf vf)
forall {k} (f :: k -&gt; *) (t :: k). f t -&gt; Some f
</span><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-var">Some</span></a></span><span> </span><span class="annot"><span class="annottext">(HMap kf vf Any -&gt; Some (HMap kf vf))
-&gt; HMap kf vf Any -&gt; Some (HMap kf vf)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map (Some kf) (Some vf) -&gt; HMap kf vf Any
forall kk kv (kf :: kk -&gt; *) (vf :: kv -&gt; *) (s :: TMap kk kv).
Map (Some kf) (Some vf) -&gt; HMap kf vf s
</span><a href="Data.SignTyped.Type.HMap.html#UnsafeHMap"><span class="hs-identifier hs-var">UnsafeHMap</span></a></span><span> </span><span class="annot"><span class="annottext">(Map (Some kf) (Some vf) -&gt; HMap kf vf Any)
-&gt; Map (Some kf) (Some vf) -&gt; HMap kf vf Any
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Some kf -&gt; Some vf -&gt; Map (Some kf) (Some vf)
forall k a. k -&gt; a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.singleton</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">kf kt -&gt; Some kf
forall {k} (f :: k -&gt; *) (t :: k). f t -&gt; Some f
</span><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-var">Some</span></a></span><span> </span><span class="annot"><span class="annottext">kf kt
</span><a href="#local-6989586621679215258"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vf vt -&gt; Some vf
forall {k} (f :: k -&gt; *) (t :: k). f t -&gt; Some f
</span><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-var">Some</span></a></span><span> </span><span class="annot"><span class="annottext">vf vt
</span><a href="#local-6989586621679215259"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span id="local-6989586621679215088"><span id="local-6989586621679215089"><span class="annot"><a href="Data.SignTyped.Type.HMap.html#unionHMapWithKey"><span class="hs-identifier hs-type">unionHMapWithKey</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Type.TestOrdering.html#SingletonConstructor"><span class="hs-identifier hs-type">SingletonConstructor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215088"><span class="hs-identifier hs-type">kf</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215088"><span class="hs-identifier hs-type">kf</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215089"><span class="hs-identifier hs-type">vf</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215089"><span class="hs-identifier hs-type">vf</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215089"><span class="hs-identifier hs-type">vf</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-97"></span><span>    </span><span class="annot"><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Type.HMap.html#HMap"><span class="hs-identifier hs-type">HMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215088"><span class="hs-identifier hs-type">kf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215089"><span class="hs-identifier hs-type">vf</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-98"></span><span>    </span><span class="annot"><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Type.HMap.html#HMap"><span class="hs-identifier hs-type">HMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215088"><span class="hs-identifier hs-type">kf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215089"><span class="hs-identifier hs-type">vf</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-99"></span><span>    </span><span class="annot"><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Type.HMap.html#HMap"><span class="hs-identifier hs-type">HMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215088"><span class="hs-identifier hs-type">kf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215089"><span class="hs-identifier hs-type">vf</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-100"></span><span id="unionHMapWithKey"><span class="annot"><span class="annottext">unionHMapWithKey :: forall {kk} {kv} (kf :: kk -&gt; *) (vf :: kv -&gt; *).
SingletonConstructor kf =&gt;
(Some kf -&gt; Some vf -&gt; Some vf -&gt; Some vf)
-&gt; Some (HMap kf vf) -&gt; Some (HMap kf vf) -&gt; Some (HMap kf vf)
</span><a href="Data.SignTyped.Type.HMap.html#unionHMapWithKey"><span class="hs-identifier hs-var hs-var">unionHMapWithKey</span></a></span></span><span> </span><span id="local-6989586621679215264"><span class="annot"><span class="annottext">Some kf -&gt; Some vf -&gt; Some vf -&gt; Some vf
</span><a href="#local-6989586621679215264"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Type.HMap.html#UnsafeHMap"><span class="hs-identifier hs-type">UnsafeHMap</span></a></span><span> </span><span id="local-6989586621679215265"><span class="annot"><span class="annottext">Map (Some kf) (Some vf)
</span><a href="#local-6989586621679215265"><span class="hs-identifier hs-var">m1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Type.HMap.html#UnsafeHMap"><span class="hs-identifier hs-type">UnsafeHMap</span></a></span><span> </span><span id="local-6989586621679215268"><span class="annot"><span class="annottext">Map (Some kf) (Some vf)
</span><a href="#local-6989586621679215268"><span class="hs-identifier hs-var">m2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-101"></span><span>    </span><span class="annot"><span class="annottext">HMap kf vf Any -&gt; Some (HMap kf vf)
forall {k} (f :: k -&gt; *) (t :: k). f t -&gt; Some f
</span><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-var">Some</span></a></span><span> </span><span class="annot"><span class="annottext">(HMap kf vf Any -&gt; Some (HMap kf vf))
-&gt; HMap kf vf Any -&gt; Some (HMap kf vf)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map (Some kf) (Some vf) -&gt; HMap kf vf Any
forall kk kv (kf :: kk -&gt; *) (vf :: kv -&gt; *) (s :: TMap kk kv).
Map (Some kf) (Some vf) -&gt; HMap kf vf s
</span><a href="Data.SignTyped.Type.HMap.html#UnsafeHMap"><span class="hs-identifier hs-var">UnsafeHMap</span></a></span><span> </span><span class="annot"><span class="annottext">(Map (Some kf) (Some vf) -&gt; HMap kf vf Any)
-&gt; Map (Some kf) (Some vf) -&gt; HMap kf vf Any
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-102"></span><span>        </span><span class="annot"><span class="annottext">(Some kf -&gt; Some vf -&gt; Some vf -&gt; Some vf)
-&gt; Map (Some kf) (Some vf)
-&gt; Map (Some kf) (Some vf)
-&gt; Map (Some kf) (Some vf)
forall k a.
Ord k =&gt;
(k -&gt; a -&gt; a -&gt; a) -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.unionWithKey</span></span><span>
</span><span id="line-103"></span><span>            </span><span class="annot"><span class="annottext">Some kf -&gt; Some vf -&gt; Some vf -&gt; Some vf
</span><a href="#local-6989586621679215264"><span class="hs-identifier hs-var">fn</span></a></span><span>
</span><span id="line-104"></span><span>            </span><span class="annot"><span class="annottext">Map (Some kf) (Some vf)
</span><a href="#local-6989586621679215265"><span class="hs-identifier hs-var">m1</span></a></span><span>
</span><span id="line-105"></span><span>            </span><span class="annot"><span class="annottext">Map (Some kf) (Some vf)
</span><a href="#local-6989586621679215268"><span class="hs-identifier hs-var">m2</span></a></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="annot"><span class="hs-comment">{-| If the same key is present in both `HMap`s, `(Data.Semigroup.&lt;&gt;)` will throw an error. -}</span></span><span>
</span><span id="line-108"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679215113"><span id="local-6989586621679215114"><span id="local-6989586621679215274"><span id="local-6989586621679215279"><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Type.TestOrdering.html#SingletonConstructor"><span class="hs-identifier hs-type">SingletonConstructor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215113"><span class="hs-identifier hs-type">kf</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679215109"><span class="annot"><a href="#local-6989586621679215109"><span class="hs-identifier hs-type">kt</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679215113"><span class="hs-identifier hs-type">kf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215109"><span class="hs-identifier hs-type">kt</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Type.HMap.html#HMap"><span class="hs-identifier hs-type">HMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215113"><span class="hs-identifier hs-type">kf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215114"><span class="hs-identifier hs-type">vf</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-109"></span><span>    </span><span id="local-6989586621679215286"><span class="annot"><span class="annottext">&lt;&gt; :: Some (HMap kf vf) -&gt; Some (HMap kf vf) -&gt; Some (HMap kf vf)
</span><span class="hs-operator hs-var hs-var hs-var hs-var">(&lt;&gt;)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Some kf -&gt; Some vf -&gt; Some vf -&gt; Some vf)
-&gt; Some (HMap kf vf) -&gt; Some (HMap kf vf) -&gt; Some (HMap kf vf)
forall {kk} {kv} (kf :: kk -&gt; *) (vf :: kv -&gt; *).
SingletonConstructor kf =&gt;
(Some kf -&gt; Some vf -&gt; Some vf -&gt; Some vf)
-&gt; Some (HMap kf vf) -&gt; Some (HMap kf vf) -&gt; Some (HMap kf vf)
</span><a href="Data.SignTyped.Type.HMap.html#unionHMapWithKey"><span class="hs-identifier hs-var">unionHMapWithKey</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span id="local-6989586621679215293"><span class="annot"><span class="annottext">kf t
</span><a href="#local-6989586621679215293"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Some vf
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Some vf
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Some vf
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Some vf) -&gt; String -&gt; Some vf
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;duplicate key: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">kf t -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">kf t
</span><a href="#local-6989586621679215293"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679215129"><span id="local-6989586621679215130"><span id="local-6989586621679215303"><span id="local-6989586621679215308"><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Type.TestOrdering.html#SingletonConstructor"><span class="hs-identifier hs-type">SingletonConstructor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215129"><span class="hs-identifier hs-type">kf</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679215126"><span class="annot"><a href="#local-6989586621679215126"><span class="hs-identifier hs-type">kt</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679215129"><span class="hs-identifier hs-type">kf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215126"><span class="hs-identifier hs-type">kt</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Type.HMap.html#HMap"><span class="hs-identifier hs-type">HMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215129"><span class="hs-identifier hs-type">kf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215130"><span class="hs-identifier hs-type">vf</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-112"></span><span>    </span><span id="local-6989586621679215312"><span class="annot"><span class="annottext">mempty :: Some (HMap kf vf)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Some (HMap kf vf)
forall {kk} {kv} (kf :: kk -&gt; *) (vf :: kv -&gt; *). Some (HMap kf vf)
</span><a href="Data.SignTyped.Type.HMap.html#emptyHMap"><span class="hs-identifier hs-var">emptyHMap</span></a></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="annot"><a href="Data.SignTyped.Type.HMap.html#lookupHMap"><span class="hs-identifier hs-type">lookupHMap</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679215133"><span class="annot"><a href="#local-6989586621679215133"><span class="hs-identifier hs-type">kf</span></a></span></span><span> </span><span id="local-6989586621679215134"><span class="annot"><a href="#local-6989586621679215134"><span class="hs-identifier hs-type">kt</span></a></span></span><span> </span><span id="local-6989586621679215135"><span class="annot"><a href="#local-6989586621679215135"><span class="hs-identifier hs-type">vf</span></a></span></span><span> </span><span id="local-6989586621679215136"><span class="annot"><a href="#local-6989586621679215136"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Type.TestOrdering.html#SingletonConstructor"><span class="hs-identifier hs-type">SingletonConstructor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215133"><span class="hs-identifier hs-type">kf</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-117"></span><span>    </span><span class="annot"><a href="#local-6989586621679215133"><span class="hs-identifier hs-type">kf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215134"><span class="hs-identifier hs-type">kt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-118"></span><span>    </span><span class="annot"><a href="Data.SignTyped.Type.HMap.html#HMap"><span class="hs-identifier hs-type">HMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215133"><span class="hs-identifier hs-type">kf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215135"><span class="hs-identifier hs-type">vf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215136"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-119"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679215135"><span class="hs-identifier hs-type">vf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Type.HMap.html#Lookup"><span class="hs-identifier hs-type">Lookup</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215134"><span class="hs-identifier hs-type">kt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215136"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span id="lookupHMap"><span class="annot"><span class="annottext">lookupHMap :: forall {kk} {kv} (kf :: kk -&gt; *) (kt :: kk) (vf :: kv -&gt; *)
       (s :: TMap kk kv).
SingletonConstructor kf =&gt;
kf kt -&gt; HMap kf vf s -&gt; Maybe (vf (Lookup kt s))
</span><a href="Data.SignTyped.Type.HMap.html#lookupHMap"><span class="hs-identifier hs-var hs-var">lookupHMap</span></a></span></span><span> </span><span id="local-6989586621679215316"><span class="annot"><span class="annottext">kf kt
</span><a href="#local-6989586621679215316"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Type.HMap.html#UnsafeHMap"><span class="hs-identifier hs-type">UnsafeHMap</span></a></span><span> </span><span id="local-6989586621679215317"><span class="annot"><span class="annottext">Map (Some kf) (Some vf)
</span><a href="#local-6989586621679215317"><span class="hs-identifier hs-var">hm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Some kf -&gt; Map (Some kf) (Some vf) -&gt; Maybe (Some vf)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">kf kt -&gt; Some kf
forall {k} (f :: k -&gt; *) (t :: k). f t -&gt; Some f
</span><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-var">Some</span></a></span><span> </span><span class="annot"><span class="annottext">kf kt
</span><a href="#local-6989586621679215316"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (Some kf) (Some vf)
</span><a href="#local-6989586621679215317"><span class="hs-identifier hs-var">hm</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-122"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Some vf)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (vf (Lookup kt s))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-123"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Type.Some.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679215319"><span id="local-6989586621679215320"><span class="annot"><span class="annottext">vf t
</span><a href="#local-6989586621679215320"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679215135"><span class="hs-identifier hs-type">vf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215319"><span class="hs-identifier hs-type">vt</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-124"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall (a :: kv) (b :: kv). UnsafeEquality a b
forall {k} (a :: k) (b :: k). UnsafeEquality a b
</span><span class="hs-identifier hs-var">Unsafe.Coerce.unsafeEqualityProof</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Type.HMap.html#Lookup"><span class="hs-identifier hs-type">Lookup</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215134"><span class="hs-identifier hs-type">kt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215136"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679215319"><span class="hs-identifier hs-type">vt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-125"></span><span>                </span><span class="annot"><span class="annottext">UnsafeEquality (Lookup kt s) t
</span><span class="hs-identifier hs-var">Unsafe.Coerce.UnsafeRefl</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-126"></span><span>                    </span><span class="annot"><span class="annottext">vf t -&gt; Maybe (vf t)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">vf t
</span><a href="#local-6989586621679215320"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span id="local-6989586621679215149"><span id="local-6989586621679215150"><span id="local-6989586621679215152"><span id="local-6989586621679215153"><span class="annot"><a href="Data.SignTyped.Type.HMap.html#foldMapHMapWithKey"><span class="hs-identifier hs-type">foldMapHMapWithKey</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-129"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679215149"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679215151"><span class="annot"><a href="#local-6989586621679215151"><span class="hs-identifier hs-type">kt</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679215150"><span class="hs-identifier hs-type">kf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215151"><span class="hs-identifier hs-type">kt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679215152"><span class="hs-identifier hs-type">vf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Type.HMap.html#Lookup"><span class="hs-identifier hs-type">Lookup</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215151"><span class="hs-identifier hs-type">kt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215153"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679215149"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-131"></span><span>    </span><span class="annot"><a href="Data.SignTyped.Type.HMap.html#HMap"><span class="hs-identifier hs-type">HMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215150"><span class="hs-identifier hs-type">kf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215152"><span class="hs-identifier hs-type">vf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215153"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-132"></span><span>    </span><span class="annot"><a href="#local-6989586621679215149"><span class="hs-identifier hs-type">m</span></a></span></span></span></span></span><span>
</span><span id="line-133"></span><span id="foldMapHMapWithKey"><span class="annot"><span class="annottext">foldMapHMapWithKey :: forall {kk} {kv} m (kf :: kk -&gt; *) (vf :: kv -&gt; *)
       (s :: TMap kk kv).
Monoid m =&gt;
(forall (kt :: kk). kf kt -&gt; vf (Lookup kt s) -&gt; m)
-&gt; HMap kf vf s -&gt; m
</span><a href="Data.SignTyped.Type.HMap.html#foldMapHMapWithKey"><span class="hs-identifier hs-var hs-var">foldMapHMapWithKey</span></a></span></span><span> </span><span id="local-6989586621679215325"><span class="annot"><span class="annottext">forall (kt :: kk). kf kt -&gt; vf (Lookup kt s) -&gt; m
</span><a href="#local-6989586621679215325"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Type.HMap.html#UnsafeHMap"><span class="hs-identifier hs-type">UnsafeHMap</span></a></span><span> </span><span id="local-6989586621679215326"><span class="annot"><span class="annottext">Map (Some kf) (Some vf)
</span><a href="#local-6989586621679215326"><span class="hs-identifier hs-var">nm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-134"></span><span>    </span><span class="annot"><span class="annottext">(Some kf -&gt; Some vf -&gt; m) -&gt; Map (Some kf) (Some vf) -&gt; m
forall m k a. Monoid m =&gt; (k -&gt; a -&gt; m) -&gt; Map k a -&gt; m
</span><span class="hs-identifier hs-var">Map.foldMapWithKey</span></span><span>
</span><span id="line-135"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(kf Any -&gt; vf (Lookup Any s) -&gt; m) -&gt; Some kf -&gt; Some vf -&gt; m
forall a b. a -&gt; b
</span><span class="hs-identifier hs-var">Unsafe.Coerce.unsafeCoerce</span></span><span> </span><span class="annot"><span class="annottext">kf Any -&gt; vf (Lookup Any s) -&gt; m
forall (kt :: kk). kf kt -&gt; vf (Lookup kt s) -&gt; m
</span><a href="#local-6989586621679215325"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>        </span><span class="annot"><span class="annottext">Map (Some kf) (Some vf)
</span><a href="#local-6989586621679215326"><span class="hs-identifier hs-var">nm</span></a></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span id="local-6989586621679215167"><span id="local-6989586621679215169"><span id="local-6989586621679215170"><span id="local-6989586621679215171"><span class="annot"><a href="Data.SignTyped.Type.HMap.html#foldrHMapWithKey"><span class="hs-identifier hs-type">foldrHMapWithKey</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-139"></span><span>    </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679215168"><span class="annot"><a href="#local-6989586621679215168"><span class="hs-identifier hs-type">kt</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679215167"><span class="hs-identifier hs-type">kf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215168"><span class="hs-identifier hs-type">kt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679215169"><span class="hs-identifier hs-type">vf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Type.HMap.html#Lookup"><span class="hs-identifier hs-type">Lookup</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215168"><span class="hs-identifier hs-type">kt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215170"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679215171"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679215171"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-140"></span><span>    </span><span class="annot"><a href="#local-6989586621679215171"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-141"></span><span>    </span><span class="annot"><a href="Data.SignTyped.Type.HMap.html#HMap"><span class="hs-identifier hs-type">HMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215167"><span class="hs-identifier hs-type">kf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215169"><span class="hs-identifier hs-type">vf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679215170"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-142"></span><span>    </span><span class="annot"><a href="#local-6989586621679215171"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span><span>
</span><span id="line-143"></span><span id="foldrHMapWithKey"><span class="annot"><span class="annottext">foldrHMapWithKey :: forall {kk} {kv} (kf :: kk -&gt; *) (vf :: kv -&gt; *) (s :: TMap kk kv)
       r.
(forall (kt :: kk). kf kt -&gt; vf (Lookup kt s) -&gt; r -&gt; r)
-&gt; r -&gt; HMap kf vf s -&gt; r
</span><a href="Data.SignTyped.Type.HMap.html#foldrHMapWithKey"><span class="hs-identifier hs-var hs-var">foldrHMapWithKey</span></a></span></span><span> </span><span id="local-6989586621679215329"><span class="annot"><span class="annottext">forall (kt :: kk). kf kt -&gt; vf (Lookup kt s) -&gt; r -&gt; r
</span><a href="#local-6989586621679215329"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621679215330"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679215330"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SignTyped.Type.HMap.html#UnsafeHMap"><span class="hs-identifier hs-type">UnsafeHMap</span></a></span><span> </span><span id="local-6989586621679215331"><span class="annot"><span class="annottext">Map (Some kf) (Some vf)
</span><a href="#local-6989586621679215331"><span class="hs-identifier hs-var">nm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-144"></span><span>    </span><span class="annot"><span class="annottext">(Some kf -&gt; Some vf -&gt; r -&gt; r) -&gt; r -&gt; Map (Some kf) (Some vf) -&gt; r
forall k a b. (k -&gt; a -&gt; b -&gt; b) -&gt; b -&gt; Map k a -&gt; b
</span><span class="hs-identifier hs-var">Map.foldrWithKey</span></span><span>
</span><span id="line-145"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(kf Any -&gt; vf (Lookup Any s) -&gt; r -&gt; r)
-&gt; Some kf -&gt; Some vf -&gt; r -&gt; r
forall a b. a -&gt; b
</span><span class="hs-identifier hs-var">Unsafe.Coerce.unsafeCoerce</span></span><span> </span><span class="annot"><span class="annottext">kf Any -&gt; vf (Lookup Any s) -&gt; r -&gt; r
forall (kt :: kk). kf kt -&gt; vf (Lookup kt s) -&gt; r -&gt; r
</span><a href="#local-6989586621679215329"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span>        </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679215330"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-147"></span><span>        </span><span class="annot"><span class="annottext">Map (Some kf) (Some vf)
</span><a href="#local-6989586621679215331"><span class="hs-identifier hs-var">nm</span></a></span><span>
</span><span id="line-148"></span></pre></body></html>